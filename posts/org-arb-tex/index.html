<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[Rohit Goswami]"><meta name=description content="A post on working with transient TeX templates in orgmode without modifying global configurations. This will also serve as a rudimentary introduction to TeX in orgmode.
Background The sad reality of working in a field dominated by institutional actors which do not care for recognizing software development as a skill is that there are often a lot of ugly LaTeX templates1. In particular, often Universities have arbitrary LaTeX templates from the the dark days of 2010 something, which include gratuitous usage of say, natbib instead of biblatex."><meta name=keywords content=",tools,emacs,workflow,orgmode"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=/posts/org-arb-tex/><title>Temporary LaTeX Documents with Orgmode :: Rohit Goswami — Reflections</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.352b37d2935988a5dd34d9e1cb93285987fa9dcf14395a2044353dd61ee8b929.css><meta itemprop=name content="Temporary LaTeX Documents with Orgmode"><meta itemprop=description content="A post on working with transient TeX templates in orgmode without modifying global configurations. This will also serve as a rudimentary introduction to TeX in orgmode.
Background The sad reality of working in a field dominated by institutional actors which do not care for recognizing software development as a skill is that there are often a lot of ugly LaTeX templates1. In particular, often Universities have arbitrary LaTeX templates from the the dark days of 2010 something, which include gratuitous usage of say, natbib instead of biblatex."><meta itemprop=datePublished content="2020-06-19T05:07:00+00:00"><meta itemprop=dateModified content="2020-06-19T05:07:00+00:00"><meta itemprop=wordCount content="1108"><meta itemprop=image content="/images/RG.png"><meta itemprop=keywords content="tools,emacs,workflow,orgmode,"><meta property="og:title" content="Temporary LaTeX Documents with Orgmode"><meta property="og:description" content="A post on working with transient TeX templates in orgmode without modifying global configurations. This will also serve as a rudimentary introduction to TeX in orgmode.
Background The sad reality of working in a field dominated by institutional actors which do not care for recognizing software development as a skill is that there are often a lot of ugly LaTeX templates1. In particular, often Universities have arbitrary LaTeX templates from the the dark days of 2010 something, which include gratuitous usage of say, natbib instead of biblatex."><meta property="og:type" content="article"><meta property="og:url" content="/posts/org-arb-tex/"><meta property="og:image" content="/images/RG.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-19T05:07:00+00:00"><meta property="article:modified_time" content="2020-06-19T05:07:00+00:00"><meta property="og:site_name" content="Rohit Goswami"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/images/RG.png"><meta name=twitter:title content="Temporary LaTeX Documents with Orgmode"><meta name=twitter:description content="A post on working with transient TeX templates in orgmode without modifying global configurations. This will also serve as a rudimentary introduction to TeX in orgmode.
Background The sad reality of working in a field dominated by institutional actors which do not care for recognizing software development as a skill is that there are often a lot of ugly LaTeX templates1. In particular, often Universities have arbitrary LaTeX templates from the the dark days of 2010 something, which include gratuitous usage of say, natbib instead of biblatex."><meta property="article:section" content="programming"><meta property="article:published_time" content="2020-06-19 05:07:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><div class=header__inner><div class=header__left><div class=logo><a href=/ style=text-decoration:none><img src=/images/home.png alt></a></div></div><div class=header__mid><button class=button><div class=button__text><a href=/search>Search</a></div></button></div><div class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>Blog</a></li></ul><ul class=menu__inner><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li></ul></nav><button id=toggleMenu><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></div></button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></button></div></div></header><script src=/js/mathjax-config.js></script>
<script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script><aside class=sidebar><div class=hideTOC><button id=tocTog>TOC</button><div class="sideTOC m-fadeOut"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#standard-methods>Standard methods</a><ul><li><a href=#in-body-tex>In-Body TeX</a></li><li><a href=#preamble>Preamble</a></li><li><a href=#latex-classes>LaTeX classes</a></li></ul></li><li><a href=#elisp-to-the-rescue>Elisp to the rescue</a><ul><li><a href=#adding-document-classes>Adding Document Classes</a></li><li><a href=#ensuring-purity>Ensuring Purity</a></li><li><a href=#pretty-packages>Pretty Packages</a></li><li><a href=#automating-with-hooks>Automating With Hooks</a></li></ul></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></div></aside><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>6 minutes<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Written: 2020-06-19 05:07 +0000</p></p></div><article class=h-entry><h1 class="post-title p-name"><a class=u-url href=/posts/org-arb-tex/>Temporary LaTeX Documents with Orgmode</a></h1><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pen-tool"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg><span class="author u-author p-author"><a href=/author/rohit-goswami>Rohit Goswami</a></span></div><hr><aside id=toc class=sidebar><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#standard-methods>Standard methods</a><ul><li><a href=#in-body-tex>In-Body TeX</a></li><li><a href=#preamble>Preamble</a></li><li><a href=#latex-classes>LaTeX classes</a></li></ul></li><li><a href=#elisp-to-the-rescue>Elisp to the rescue</a><ul><li><a href=#adding-document-classes>Adding Document Classes</a></li><li><a href=#ensuring-purity>Ensuring Purity</a></li><li><a href=#pretty-packages>Pretty Packages</a></li><li><a href=#automating-with-hooks>Automating With Hooks</a></li></ul></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></aside><hr><div class="post-content e-content"><blockquote><p>A post on working with transient TeX templates in <code>orgmode</code> without modifying global configurations. This will also serve as a rudimentary introduction to TeX in <code>orgmode</code>.</p></blockquote><h2 id=background>Background</h2><p>The sad reality of working in a field dominated by institutional actors which do not care for recognizing software development as a skill is that there are often a lot of ugly LaTeX templates<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. In particular, often Universities have arbitrary LaTeX templates from the the dark days of 2010 something, which include gratuitous usage of say, <code>natbib</code> instead of <code>biblatex</code>. In other situations, <code>.cls</code> files define separate document classes which are not covered by the <code>orgmode</code> defaults and need to be accounted for.</p><h2 id=standard-methods>Standard methods</h2><p>Essentially for the exporter, the document is broken into<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>:</p><dl><dt><strong>document_class</strong></dt><dd>This cannot be changed arbitrarily and <a href=https://orgmode.org/manual/LaTeX-specific-export-settings.html#LaTeX-specific-export-settings>has to be</a> a valid element of <code>org-latex-classes</code></dd><dt><strong>preamble</strong></dt><dd>This section of the document is essentially everything before <code>\begin{document}</code> and after <code>\documentclass{...}</code></dd><dt><strong>body</strong></dt><dd>The rest of the document</dd></dl><p>We will briefly cover the standard methods of entering TeX in each of these sections, in reverse order since that is the direction in which the intuitive aspect decreases.</p><h3 id=in-body-tex>In-Body TeX</h3><p>The method of writing TeX in <code>orgmode</code> for the document involves simply writing TeX directly, or wrapping the TeX markup in an export TeX block for font locking<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. Essentially, for a document snippet:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-latex data-lang=latex><span class=line><span class=ln>1</span><span class=cl><span class=c>% #+BEGIN_SRC latex :exports code
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=c></span><span class=k>\begin</span><span class=nb>{</span>align<span class=nb>}</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=k>\pi</span>(x) <span class=nb>&amp;</span>= <span class=k>\sum</span><span class=nb>_{</span>n=1<span class=nb>}^{</span><span class=k>\infty</span><span class=nb>}</span><span class=k>\frac</span><span class=nb>{</span><span class=k>\mu</span>(n)<span class=nb>}{</span>n<span class=nb>}</span><span class=k>\Pi</span>(x<span class=nb>^{</span><span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>n<span class=nb>}}</span>) <span class=k>\\</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>       <span class=nb>&amp;</span>= <span class=k>\Pi</span>(x) -<span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>2<span class=nb>}</span><span class=k>\Pi</span>(x<span class=nb>^{</span><span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>2<span class=nb>}}</span>) - <span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>3<span class=nb>}</span><span class=k>\Pi</span>(x<span class=nb>^{</span><span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>3<span class=nb>}}</span>) - <span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>5<span class=nb>}</span><span class=k>\Pi</span>(x<span class=nb>^{</span><span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>5<span class=nb>}}</span>) + <span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>6<span class=nb>}</span> <span class=k>\Pi</span>(x<span class=nb>^{</span><span class=k>\frac</span><span class=nb>{</span>1<span class=nb>}{</span>6<span class=nb>}}</span>) -<span class=k>\cdots</span>,
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=k>\end</span><span class=nb>{</span>align<span class=nb>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=c>% #+END_SRC
</span></span></span></code></pre></div><p>Which will actually be rendered in a real document of course<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>:</p><p>\begin{align}
\pi(x) &= \sum_{n=1}^{\infty}\frac{\mu(n)}{n}\Pi(x^{\frac{1}{n}}) \\
&= \Pi(x) -\frac{1}{2}\Pi(x^{\frac{1}{2}}) - \frac{1}{3}\Pi(x^{\frac{1}{3}}) - \frac{1}{5}\Pi(x^{\frac{1}{5}}) + \frac{1}{6} \Pi(x^{\frac{1}{6}}) -\cdots,
\end{align}</p><p>There is also the inline form of writing LaTeX with <code>@@\sin{x}@@</code> which is essentially \(\sin{x}\).</p><h3 id=preamble>Preamble</h3><p>The main use of the preamble is to either add classes or modify class options for loaded packages like <code>geometry</code>. Essentially, for <code>orgmode</code>, anything prefixed with <code>#+LATEX_HEADER:</code> gets inserted in the preamble.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=ln>1</span><span class=cl><span class=cs>#+LATEX_HEADER</span><span class=c>: \usepackage{amssymb,amsmath,MnSymbol}</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=cs>#+LATEX_HEADER</span><span class=c>: \usepackage{unicode-math}</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=cs>#+LATEX_HEADER</span><span class=c>: \usepackage{mathtools}</span>
</span></span></code></pre></div><p>For larger documents, this gets quite annoying for loading packages. We will demonstrate a more aesthetically pleasant form later in this post.</p><h3 id=latex-classes>LaTeX classes</h3><p>Working with document classes is the least intuitive of all TeX manipulations, because for some reason, <code>#+LATEX_CLASS:</code> only accepts values defined in <code>org-latex-classes</code>.</p><p>The standard approach to extending the <code>orgmode</code> TeX backend is to add lines like the following in <code>init.el</code> or, in my case<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>, <code>config.org</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=ln>1</span><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>             <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;koma-article&#34;</span> <span class=s>&#34;\\documentclass{scrartcl}&#34;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><p>This is alright for often used classes like the <code>koma-⋆</code> family of LaTeX document-classes, but it is hardly ideal for one-off TeX templates which are meant for say, grant proposals<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>.</p><h2 id=elisp-to-the-rescue>Elisp to the rescue</h2><p>The core idea is quite simple.</p><blockquote><p>Since <code>orgmode</code> files are literate documents, and <code>emacs</code> is self-documenting and completely programmable, it should be possible to execute code to deterministically set the state of <code>emacs</code> before exporting the document to TeX.</p></blockquote><p>Practically this has a few moving parts. In the following sections, assume that we have a <code>.cls</code> file which defines a document-class <code>foo</code> with a bunch of packages which conflict with our global configuration.</p><h3 id=adding-document-classes>Adding Document Classes</h3><p>Instead of adding the code snippet to our global configuration, we will now add it to the document directly with the comments indicating the appropriate environment.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=ln>1</span><span class=cl><span class=c1>;; #+BEGIN_SRC emacs-lisp :exports none  :results none :eval always</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>             <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;foo&#34;</span> <span class=s>&#34;\\documentclass{foo}&#34;</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=ln>9</span><span class=cl><span class=c1>;; #+END_SRC</span>
</span></span></code></pre></div><p>Where the header arguments simply ensure that the code and result do not show up in the document, and that the chunk is always evaluated by <code>org-babel</code>.</p><h3 id=ensuring-purity>Ensuring Purity</h3><p>Since we want to stick to an external template defined in <code>foo</code> <strong>and no other packages</strong> we will need to clear the defaults we lovingly set globally for our convenience.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=ln>1</span><span class=cl><span class=c1>;; #+BEGIN_SRC emacs-lisp :exports none  :results none :eval always</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-packages-alist</span> <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-minted-options</span> <span class=ss>&#39;nil</span><span class=p>)</span> <span class=c1>;; Separately nullify minted</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1>;; #+END_SRC</span>
</span></span></code></pre></div><h3 id=pretty-packages>Pretty Packages</h3><p>For packages we really would like to add, we can now leverage the <code>elisp</code> code instead of the ugly <code>#+LATEX_HEADER:</code> lines.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=ln>1</span><span class=cl><span class=c1>;; #+BEGIN_SRC emacs-lisp :exports none  :results none :eval always</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-default-packages-alist</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;utf8&#34;</span> <span class=s>&#34;inputenc&#34;</span>  <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=p>(</span><span class=s>&#34;normalem&#34;</span> <span class=s>&#34;ulem&#34;</span>  <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=p>(</span><span class=s>&#34;&#34;</span>     <span class=s>&#34;mathtools&#34;</span>   <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=c1>;; #+END_SRC</span>
</span></span></code></pre></div><p>Note that for setting options, we will still need to use the <code>#+LATEX_HEADER:</code> syntax.</p><h3 id=automating-with-hooks>Automating With Hooks</h3><p>At this stage, we have a chunk of <code>elisp</code> we can manually evaluate with <code>org-babel</code> before exporting with <code>org-latex-export-to-pdf</code> or <code>org-latex-export-to-latex</code>. However, this can get old quickly, so we will instead have a <code>before-save-hook</code> to do this for us.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=ln>1</span><span class=cl><span class=c># Local Variables:</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=c># before-save-hook: org-babel-execute-buffer</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=c># End:</span>
</span></span></code></pre></div><h4 id=bonus-hook>Bonus Hook</h4><p>In <a href=https://dotdoom.rgoswami.me/config.html#org13eed8a>my own configuration</a>, I have a function defined for an <code>after-save-hook</code> which generates the TeX file without having me deal with it. For a per-file configuration of this, or globally, the <code>elisp</code> is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=ln>1</span><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>haozeke/org-save-and-export-latex</span> <span class=p>()</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-mode</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=p>(</span><span class=nv>org-latex-export-to-latex</span> <span class=no>t</span><span class=p>)))</span>
</span></span></code></pre></div><p>This indirection is required to call the function as a <code>hook</code>. The additional <code>t</code> allows for asynchronous non blocking exports. Now this can be used as:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=ln>1</span><span class=cl><span class=c># Local Variables:</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=c># after-save-hook: haozeke/org-save-and-export-latex</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=c># End:</span>
</span></span></code></pre></div><h2 id=conclusions>Conclusions</h2><p>The entire file would look something like this (the <code>elisp</code> can be anywhere in the <code>orgmode</code> file):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=ln> 1</span><span class=cl><span class=c1>;; #+BEGIN_SRC emacs-lisp :exports none  :results none :eval always</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>             <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;foo&#34;</span> <span class=s>&#34;\\documentclass{foo}&#34;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>               <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-packages-alist</span> <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-default-packages-alist</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;utf8&#34;</span> <span class=s>&#34;inputenc&#34;</span>  <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=p>(</span><span class=s>&#34;&#34;</span>     <span class=s>&#34;minted&#34;</span>   <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=p>(</span><span class=s>&#34;&#34;</span>     <span class=s>&#34;rotating&#34;</span>  <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>    <span class=p>(</span><span class=s>&#34;normalem&#34;</span> <span class=s>&#34;ulem&#34;</span>  <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>    <span class=p>(</span><span class=s>&#34;&#34;</span>     <span class=s>&#34;mathtools&#34;</span>   <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=c1>;; #+END_SRC</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=ln> 1</span><span class=cl><span class=cs>#+TITLE</span><span class=c>: Something</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=cs>#+AUTHOR</span><span class=c>: Rohit Goswami</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=cs>#+OPTIONS</span><span class=c>: toc:nil \n:nil</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=cs>#+STARTUP</span><span class=c>: fninline</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=cs>#+LATEX_COMPILER</span><span class=c>: xelatex</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=cs>#+LATEX_CLASS</span><span class=c>: foo</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=cs>#+LATEX_HEADER</span><span class=c>: \setlength\parindent{0pt}</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=cs>#+LATEX_HEADER</span><span class=c>: \addbibresource{./biblio/refs.bib}</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>
</span></span><span class=line><span class=ln>10</span><span class=cl>Blah blah document $\sin{x}$ stuff
</span></span><span class=line><span class=ln>11</span><span class=cl>
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=c># Local Variables:</span>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=c># before-save-hook: org-babel-execute-buffer</span>
</span></span><span class=line><span class=ln>14</span><span class=cl><span class=c># after-save-hook: haozeke/org-save-and-export-latex</span>
</span></span><span class=line><span class=ln>15</span><span class=cl><span class=c># End:</span>
</span></span></code></pre></div><p>This method could be extended to essentially resetting all <code>emacs</code> variables on a per-file basis (without <code>file-local-variables</code> and <code>dir-local-variables</code>) or to potentially execute any <code>elisp</code> to make <code>emacs</code> do things, though I cannot really think of another realistic use-case. The method presented here is really general enough to work with any arbitrary LaTeX <code>.cls</code> file or other draconian measures.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Of course there are more issues stemming from this toxic practice, but that&rsquo;s for another rant&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>For more on document structure in TeX <a href=https://en.wikibooks.org/wiki/LaTeX/Document_Structure>read the wikibook</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Or syntax highlighting for most people&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Props to anyone who recognizes that formula&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>I use <a href=https://github.com/hlissner/doom-emacs/>doom-emacs</a> with my own <a href=https://dotdoom.rgoswami.me>literate configuration</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>I haven&rsquo;t seen a grant proposal template I&rsquo;d like to store for later, <strong>ever</strong>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/tools>tools</a></span><span class=tag><a href=/tags/emacs>emacs</a></span><span class=tag><a href=/tags/workflow>workflow</a></span><span class=tag><a href=/tags/orgmode>orgmode</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1108 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Posted: <time class=dt-published>2020-06-19 05:07 +0000</time></p><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=%2fposts%2forg-arb-tex%2f" target=_blank rel=noopener aria-label=Facebook><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15.84 9.5H13.5V8.48c0-.53.35-.65.6-.65h1.4v-2.3h-2.35c-2.3.0-2.65 1.7-2.65 2.8V9.5h-2v2h2v7h3v-7h2.1l.24-2z"/></svg></div>Facebook</div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=%22Temporary%20LaTeX%20Documents%20with%20Orgmode%22%20seems%20like%20an%20interesting%20read%20from%20%40rg0swami&amp;url=%2fposts%2forg-arb-tex%2f" target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3.0 1 .4 1.7 1.2 2.2-.5.0-1 0-1.2-.3.0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8.0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="12" cy="12" r="11.5"/></svg></div>Twitter</div></a><a class=resp-sharing-button__link href="mailto:?subject=%22Temporary%20LaTeX%20Documents%20with%20Orgmode%22%20seems%20interesting...&amp;body=%2fposts%2forg-arb-tex%2f" target=_self rel=noopener aria-label=E-Mail><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 16c0 .8-.7 1.5-1.5 1.5H6c-.8.0-1.5-.7-1.5-1.5V8c0-.8.7-1.5 1.5-1.5h12c.8.0 1.5.7 1.5 1.5v8zm-2-7.5L12 13 6.5 8.5m11 6-4-2.5m-7 2.5 4-2.5"/><circle cx="12" cy="12" r="11.5"/></svg></div>E-Mail</div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fposts%2forg-arb-tex%2f&amp;title=%22Temporary%20LaTeX%20Documents%20with%20Orgmode%22%20seems%20interesting...&amp;summary=%22Temporary%20LaTeX%20Documents%20with%20Orgmode%22%20seems%20interesting...&amp;source=%2fposts%2forg-arb-tex%2f" target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15 12.5c-.28.0-.5.22-.5.5v3.5h-3s.03-6.48.0-7h3v.83s.46-.75 1.7-.75c1.56.0 2.3 1.12 2.3 3.3v3.62h-3V13c0-.28-.23-.5-.5-.5zm-7.5-3h2v7h-2z"/><circle cx="8.5" cy="6.5" r="1"/></svg></div>LinkedIn</div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=%2fposts%2forg-arb-tex%2f&amp;resubmit=true&amp;title=%22Temporary%20LaTeX%20Documents%20with%20Orgmode%22%20seems%20interesting..." target=_blank rel=noopener aria-label=Reddit><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><ellipse cx="12" cy="14.37" rx="6.2" ry="4.24"/><path d="M14.3 16.25c-.62.36-1.42.57-2.3.57s-1.7-.2-2.32-.58"/><circle cx="14.61" cy="13.39" r=".98"/><circle cx="9.39" cy="13.39" r=".98"/><path d="M16.4 11.38c.26-.55.82-.92 1.47-.92.9.0 1.63.73 1.63 1.63.0.8-.6 1.47-1.38 1.6"/><circle cx="17.22" cy="7.52" r="1.63"/><path d="M7.6 11.38c-.26-.54-.82-.92-1.47-.92-.9.0-1.63.73-1.63 1.63.0.8.6 1.47 1.38 1.6M12 10.12s-.08-4.82 3.6-2.6"/></svg></div>Reddit</div></a><a class=resp-sharing-button__link href="whatsapp://send?text=%22Temporary%20LaTeX%20Documents%20with%20Orgmode%22%20seems%20interesting...%20%2fposts%2forg-arb-tex%2f" target=_blank rel=noopener aria-label=WhatsApp><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle xmlns="http://www.w3.org/2000/svg" cx="12" cy="12" r="11.5"/><path stroke-width="1" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3.0-7.8 3.5-7.8 7.8.0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4.9 3.7.9 4.3.0 7.8-3.5 7.8-7.8.1-2-.7-3.9-2.2-5.4zm-5.5 11.9c-1.2.0-2.3-.3-3.3-.9l-.2-.1-2.4.6.7-2.4-.2-.2c-.6-1-1-2.2-1-3.4.0-3.6 2.9-6.5 6.5-6.5 1.7.0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.4-6.6 6.4zm3.5-4.8c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1s-.5.6-.6.8c-.1.1-.2.1-.4.0s-.8-.3-1.6-1c-.6-.5-1-1.2-1.1-1.3-.1-.2.0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.0-.2.0-.3s-.4-1.1-.6-1.4c-.2-.4-.3-.3-.4-.3h-.4s-.3.0-.5.2-.7.7-.7 1.6c0 1 .7 1.9.8 2s1.4 2.1 3.3 2.9c.5.2.8.3 1.1.4.5.1.9.1 1.2.1.4-.1 1.1-.5 1.3-.9.2-.5.2-.8.1-.9.0-.2-.2-.3-.4-.4z"/></svg></div>WhatsApp</div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/sr2-ch9-ch11-ch12/><span class=button__icon>←</span>
<span class=button__text>"SR2 :: Solutions for Chapters {9,11,12}"</span></a></span>
<span class="button next"><a href=/posts/sr2-ch5-ch6-ch7/><span class=button__text>"SR2 :: Solutions for Chapters {5,6,7}"</span>
<span class=button__icon>→</span></a></span></div></div><div id=comments class=thin><div class=pagination__title><span class=pagination__title-h>Comments</span><hr></div><script src=https://utteranc.es/client.js repo=haozeke/haozeke.github.io issue-term=pathname theme=photon-dark label="Utterance 💬" crossorigin=anonymous async></script></div></main><footer class=footer><p>&copy; 2023
<span><a href>Rohit Goswami (HaoZeke)</a></span>
<a href=/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a><br><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br><script src=https://liberapay.com/rohit/widgets/button.js></script><noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript></p></footer></div><script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script>
<script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-109503488-16","auto"),ga("send","pageview")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","3z2xvwqu4u")</script><script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script><script async src=https://static.getclicky.com/js></script>
<script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script>
<script src=/js/codefold.min.f0790269b87613b3bcff64022840fe1991eee3ea384e874c78a24022c9936bd888a3c14a05a10955881eebb1558e4fcf37576dac120cd0bf4ebaf7aca27b35b1.js></script></body></html>