<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[Rohit Goswami]"><meta name=description content="This post discusses briefly, the nix-shell environment for reproducible programming. In particular, there is an emphasis on extensions for installing and working with packages not in CRAN, i.e. packages off Github which are normally installed with devtools.
Background The entire nix ecosystem is fantastic, and is the main packaging system used by d-SEAMS as well. Recently I began working through the excellent second edition of &amp;ldquo;Statistical Rethinking&amp;rdquo; by Richard McElreath1."><meta name=keywords content="personal,tools,nix,workflow,R"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rgoswami.me/posts/nix-r-devtools/><meta name=generator content="Wooframework"><title>Nix with R and devtools :: Rohit Goswami — Reflections</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.054e30538b054b321af6575a7659f551cec63e1cef6bbd674acccadf856d3aff.css><meta itemprop=name content="Nix with R and devtools"><meta itemprop=description content="This post discusses briefly, the nix-shell environment for reproducible programming. In particular, there is an emphasis on extensions for installing and working with packages not in CRAN, i.e. packages off Github which are normally installed with devtools.
Background The entire nix ecosystem is fantastic, and is the main packaging system used by d-SEAMS as well. Recently I began working through the excellent second edition of &ldquo;Statistical Rethinking&rdquo; by Richard McElreath1."><meta itemprop=datePublished content="2020-06-06T05:49:00+00:00"><meta itemprop=dateModified content="2020-06-06T05:49:00+00:00"><meta itemprop=wordCount content="1315"><meta itemprop=image content="https://rgoswami.me/images/RG.png"><meta itemprop=keywords content="tools,nix,workflow,R,"><meta property="og:title" content="Nix with R and devtools"><meta property="og:description" content="This post discusses briefly, the nix-shell environment for reproducible programming. In particular, there is an emphasis on extensions for installing and working with packages not in CRAN, i.e. packages off Github which are normally installed with devtools.
Background The entire nix ecosystem is fantastic, and is the main packaging system used by d-SEAMS as well. Recently I began working through the excellent second edition of &ldquo;Statistical Rethinking&rdquo; by Richard McElreath1."><meta property="og:type" content="article"><meta property="og:url" content="https://rgoswami.me/posts/nix-r-devtools/"><meta property="og:image" content="https://rgoswami.me/images/RG.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-06T05:49:00+00:00"><meta property="article:modified_time" content="2020-06-06T05:49:00+00:00"><meta property="og:see_also" content="https://rgoswami.me/posts/emacs-nix-r/"><meta property="og:see_also" content="https://rgoswami.me/posts/rethinking-r-nix/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rgoswami.me/images/RG.png"><meta name=twitter:title content="Nix with R and devtools"><meta name=twitter:description content="This post discusses briefly, the nix-shell environment for reproducible programming. In particular, there is an emphasis on extensions for installing and working with packages not in CRAN, i.e. packages off Github which are normally installed with devtools.
Background The entire nix ecosystem is fantastic, and is the main packaging system used by d-SEAMS as well. Recently I began working through the excellent second edition of &ldquo;Statistical Rethinking&rdquo; by Richard McElreath1."><meta property="article:section" content="programming"><meta property="article:published_time" content="2020-06-06 05:49:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><div class=header__inner><div class=header__left><div class=logo><a href=/ style=text-decoration:none><img src=/images/home.png alt></a></div></div><div class=header__mid><button class=button><div class=button__text><a href=https://rgoswami.me//search>Search</a></div></button></div><div class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>Blog</a></li><li><a href=/series>Series</a></li></ul><ul class=menu__inner><li><a href=/categories>Categories</a></li><li><a href=/snippets>Snippets</a></li><li><a href=/tags>Tags</a></li></ul></nav><button id=toggleMenu><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></div></button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></button></div></div></header><script src=/js/mathjax-config.js></script>
<script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script><aside class=sidebar><div class=hideTOC><button id=tocTog>TOC</button><div class="sideTOC m-fadeOut"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#nix-and-r>Nix and R</a></li><li><a href=#nix-r-and-devtools>Nix-R and Devtools</a><ul><li><a href=#naive-approach>Naive Approach</a></li><li><a href=#native-approach>Native Approach</a></li></ul></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></div></aside><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>7 minutes<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Written: 2020-06-06 05:49 +0000</p></p></div><article class=h-entry><h1 class="post-title p-name"><a class=u-url href=https://rgoswami.me/posts/nix-r-devtools/>Nix with R and devtools</a></h1><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pen-tool"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg><span class="author u-author p-author"><a href=/author/rohit-goswami>Rohit Goswami</a></span></div><hr><aside id=toc class=sidebar><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#nix-and-r>Nix and R</a></li><li><a href=#nix-r-and-devtools>Nix-R and Devtools</a><ul><li><a href=#naive-approach>Naive Approach</a></li><li><a href=#native-approach>Native Approach</a></li></ul></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></aside><hr><div class="post-content e-content"><div class="notice--info post-series-top"><p>This post is part of the <a href=https://rgoswami.me/series/r-x-nix-nexus-crafting-cohesive-environments/>R x Nix Nexus: Crafting Cohesive Environments</a> series.</p></div><blockquote><p>This post discusses briefly, the <code>nix-shell</code> environment for reproducible
programming. In particular, there is an emphasis on extensions for installing
and working with packages not in <a href=https://cran.r-project.org/web/packages/>CRAN</a>, i.e. packages off Github which are
normally installed with <code>devtools</code>.</p></blockquote><h2 id=background>Background</h2><p>The entire <a href=https://nixos.org/>nix ecosystem</a> is fantastic, and is the main packaging
system used by <a href=https://dseams.info>d-SEAMS</a> as well.
Recently I began working through the <a href=https://xcelab.net/rm/statistical-rethinking/>excellent second edition</a> of &ldquo;Statistical
Rethinking&rdquo; by <a href=https://twitter.com/rlmcelreath>Richard McElreath</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><p>Unfortunately, the <code>rethinking</code> package which is a major component of the book
itself depends on the V8 engine for some reason. The reigning AUR<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
package (<a href=https://aur.archlinux.org/packages/v8-r/>V8-r</a>) broke with a <a href=https://aur.archlinux.org/packages/v8-r/#comment-749561>fun error message</a> I couldn&rsquo;t be bothered to deal
with. Ominously, the <a href=https://pastebin.com/CbdCMZ8d>rest of the logs</a> prominently featured <code>Warning: Running gclient on Python 3.</code>. Given that older <code>python</code> versions have been permanently
retired, this seemed like a bad thing to deal with<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. In any case,
having weaned off non-nix dependency tools for <code>python</code> and friends, it seemed
strange to not do the same for R.</p><p>The standard installation for the package entails obtaining <code>rstan</code> (which is trivial with <code>nixpkgs</code>) and then using:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>install.packages</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;coda&#34;</span><span class=p>,</span><span class=s>&#34;mvtnorm&#34;</span><span class=p>,</span><span class=s>&#34;devtools&#34;</span><span class=p>,</span><span class=s>&#34;loo&#34;</span><span class=p>,</span><span class=s>&#34;dagitty&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>devtools</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>devtools</span><span class=o>::</span><span class=nf>install_github</span><span class=p>(</span><span class=s>&#34;rmcelreath/rethinking&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>We will break this down and work through this installation in Nix space.</p><h2 id=nix-and-r>Nix and R</h2><p>The standard approach to setting up a project <code>shell.nix</code> is simply by using the
<code>mkshell</code> function. There are some common aspects to this workflow, with more
language specific details documented here. A simple first version might be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=ln> 1</span><span class=cl><span class=k>let</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=n>pkgs</span> <span class=o>=</span> <span class=kn>import</span> <span class=sr>&lt;nixpkgs&gt;</span> <span class=p>{</span> <span class=p>};</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=k>in</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>mkShell</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=n>buildInputs</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>        <span class=n>zsh</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>        <span class=n>R</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>        <span class=n>rPackages</span><span class=o>.</span><span class=n>ggplot</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=n>rPackages</span><span class=o>.</span><span class=n>data_table</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>    <span class=n>shellHook</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=s1>    echo &#34;hello&#34;
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=s1>    &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>  <span class=n>LOCALE_ARCHIVE</span> <span class=o>=</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>optionalString</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>isLinux</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=n>glibcLocales</span><span class=si>}</span><span class=s2>/lib/locale/locale-archive&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Where we note that we can install CRAN packages as easily as regular packages
(like R), except for the fact that they are kept in a <code>pkgs.rPackages</code>
environment, as opposed to <code>pkgs</code>. This is actually a common convention most
languages with central repos. The most interesting thing to note is that,
similar to the convention for <code>nix-python</code> setups, packages with a dot in the
name will be converted to having an underscore, i.e. <code>data.table</code> ->
<code>data_table</code>.</p><p>However, for the rethinking package, and many others, there is no current CRAN
package, and so the <code>rPackages</code> approach fails.</p><p>The <code>LOCALE_ARCHIVE</code> needs to be set for Linux machines, and is required for
working with other packages.</p><h2 id=nix-r-and-devtools>Nix-R and Devtools</h2><p>To work with non-CRAN packages, we need to modify our package setup a little. We
will also simplify our file to split the <code>pkgs</code> and the <code>r-pkgs</code>.</p><h3 id=naive-approach>Naive Approach</h3><p>The naive approach works by using the <code>shellHook</code> to set <code>R_LIBS_USER</code> to save
user packages per-project.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=ln> 1</span><span class=cl><span class=p>{</span> <span class=n>pkgs</span> <span class=o>?</span> <span class=kn>import</span> <span class=sr>&lt;nixpkgs&gt;</span> <span class=p>{</span> <span class=p>}</span> <span class=p>}:</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=k>let</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=n>my-r-pkgs</span> <span class=o>=</span> <span class=n>rWrapper</span><span class=o>.</span><span class=n>override</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>rPackages</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>      <span class=n>ggplot2</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>      <span class=n>knitr</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>      <span class=n>rstan</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>      <span class=n>tidyverse</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>      <span class=n>V8</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>      <span class=n>dagitty</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>      <span class=n>coda</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>      <span class=n>mvtnorm</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>      <span class=n>shape</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>      <span class=n>Rcpp</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>      <span class=n>tidybayes</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=k>in</span> <span class=n>mkShell</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>  <span class=n>buildInputs</span> <span class=o>=</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;[</span> <span class=n>git</span> <span class=n>glibcLocales</span> <span class=n>openssl</span> <span class=n>openssh</span> <span class=n>curl</span> <span class=n>wget</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>  <span class=n>inputsFrom</span> <span class=o>=</span> <span class=p>[</span> <span class=n>my-r-pkgs</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>  <span class=n>shellHook</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=s1>    mkdir -p &#34;$(pwd)/_libs&#34;
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=s1>    export R_LIBS_USER=&#34;$(pwd)/_libs&#34;
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=s1>  &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>  <span class=n>GIT_SSL_CAINFO</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>${</span><span class=n>cacert</span><span class=si>}</span><span class=s2>/etc/ssl/certs/ca-bundle.crt&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>  <span class=n>LOCALE_ARCHIVE</span> <span class=o>=</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>optionalString</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>isLinux</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=n>glibcLocales</span><span class=si>}</span><span class=s2>/lib/locale/locale-archive&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>29</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Note that here we will also need to set the <code>GIT_SSL_CAINFO</code> to prevent some
errors during the build process<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.</p><h3 id=native-approach>Native Approach</h3><p>The native approach essentially leverages the <code>nix</code> method for building <code>R</code>
packages. This is the most reproducible of the lot, and also has the useful
property of storing the files in the <code>nix-store</code> so re-using packages across
different projects will not store, build or download the package again. The
values required can be calculated from <code>nix-prefetch-git</code> as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>nix-env -i nix-prefetch-git
</span></span><span class=line><span class=ln>2</span><span class=cl>nix-prefetch-git https://github.com/rmcelreath/rethinking.git
</span></span></code></pre></div><p>The crux of this approach is the following snippet<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=ln> 1</span><span class=cl><span class=p>(</span><span class=n>buildRPackage</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>  <span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;rethinking&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=n>src</span> <span class=o>=</span> <span class=n>fetchFromGitHub</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=n>owner</span> <span class=o>=</span> <span class=s2>&#34;rmcelreath&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=n>repo</span> <span class=o>=</span> <span class=s2>&#34;rethinking&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=n>rev</span> <span class=o>=</span> <span class=s2>&#34;d0978c7f8b6329b94efa2014658d750ae12b1fa2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=n>sha256</span> <span class=o>=</span> <span class=s2>&#34;1qip6x3f6j9lmcmck6sjrj50a5azqfl6rfhp4fdj7ddabpb8n0z0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=n>propagatedBuildInputs</span> <span class=o>=</span> <span class=p>[</span> <span class=n>coda</span> <span class=n>MASS</span> <span class=n>mvtnorm</span> <span class=n>loo</span> <span class=n>shape</span> <span class=n>rstan</span> <span class=n>dagitty</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>10</span><span class=cl> <span class=p>})</span>
</span></span></code></pre></div><h4 id=project-shell>Project Shell</h4><p>This formulation for some strange reason does not work from the shell or environment by default, but does work with <code>nix-shell --run bash --pure</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=ln> 1</span><span class=cl><span class=p>{</span> <span class=n>pkgs</span> <span class=o>?</span> <span class=kn>import</span> <span class=sr>&lt;nixpkgs&gt;</span> <span class=p>{</span> <span class=p>}</span> <span class=p>}:</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=k>let</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=n>my-r-pkgs</span> <span class=o>=</span> <span class=n>rWrapper</span><span class=o>.</span><span class=n>override</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>rPackages</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>      <span class=n>ggplot2</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>      <span class=n>knitr</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>      <span class=n>rstan</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>      <span class=n>tidyverse</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>      <span class=n>V8</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>      <span class=n>dagitty</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>      <span class=n>coda</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>      <span class=n>mvtnorm</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>      <span class=n>shape</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>      <span class=n>Rcpp</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>      <span class=n>tidybayes</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>      <span class=p>(</span><span class=n>buildRPackage</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>        <span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;rethinking&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>        <span class=n>src</span> <span class=o>=</span> <span class=n>fetchFromGitHub</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>          <span class=n>owner</span> <span class=o>=</span> <span class=s2>&#34;rmcelreath&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>          <span class=n>repo</span> <span class=o>=</span> <span class=s2>&#34;rethinking&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>          <span class=n>rev</span> <span class=o>=</span> <span class=s2>&#34;d0978c7f8b6329b94efa2014658d750ae12b1fa2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>          <span class=n>sha256</span> <span class=o>=</span> <span class=s2>&#34;1qip6x3f6j9lmcmck6sjrj50a5azqfl6rfhp4fdj7ddabpb8n0z0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>        <span class=n>propagatedBuildInputs</span> <span class=o>=</span> <span class=p>[</span> <span class=n>coda</span> <span class=n>MASS</span> <span class=n>mvtnorm</span> <span class=n>loo</span> <span class=n>shape</span> <span class=n>rstan</span> <span class=n>dagitty</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>      <span class=p>})</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=ln>29</span><span class=cl><span class=k>in</span> <span class=n>mkShell</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>30</span><span class=cl>  <span class=n>buildInputs</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span> <span class=n>git</span> <span class=n>glibcLocales</span> <span class=n>openssl</span> <span class=n>which</span> <span class=n>openssh</span> <span class=n>curl</span> <span class=n>wget</span> <span class=n>my-r-pkgs</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>  <span class=n>shellHook</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=s1>    mkdir -p &#34;$(pwd)/_libs&#34;
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=s1>    export R_LIBS_USER=&#34;$(pwd)/_libs&#34;
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=s1>    echo </span><span class=si>${</span><span class=n>my-r-pkgs</span><span class=si>}</span><span class=s1>/bin/R
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=s1>  &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>  <span class=n>GIT_SSL_CAINFO</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>${</span><span class=n>cacert</span><span class=si>}</span><span class=s2>/etc/ssl/certs/ca-bundle.crt&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>  <span class=n>LOCALE_ARCHIVE</span> <span class=o>=</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>optionalString</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>isLinux</span>
</span></span><span class=line><span class=ln>38</span><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=n>glibcLocales</span><span class=si>}</span><span class=s2>/lib/locale/locale-archive&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>39</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The reason behind this is simply that <code>rWrapper</code> forms an extra package which
has lower precedence than the user profile <code>R</code>, which is documented in more
detail here on the <a href=https://nixos.wiki/wiki/R>NixOS wiki</a>.</p><h4 id=user-profile>User Profile</h4><p>This is a more general approach which defines the environment for R with all the
relevant libraries and is described in the <a href=https://nixos.org/nixpkgs/manual/#r>nixpkgs manual</a>. The following code
should be placed in <code>$HOME/.config/nixpkgs/config.nix</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=ln> 1</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>  <span class=n>packageOverrides</span> <span class=o>=</span> <span class=n>super</span><span class=p>:</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>    <span class=k>let</span> <span class=n>self</span> <span class=o>=</span> <span class=n>super</span><span class=o>.</span><span class=n>pkgs</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=k>in</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>      <span class=n>rEnv</span> <span class=o>=</span> <span class=n>super</span><span class=o>.</span><span class=n>rWrapper</span><span class=o>.</span><span class=n>override</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>        <span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>self</span><span class=o>.</span><span class=n>rPackages</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>          <span class=n>ggplot2</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>          <span class=n>knitr</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>          <span class=n>tidyverse</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>          <span class=n>tidybayes</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>          <span class=p>(</span><span class=n>buildRPackage</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>            <span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;rethinking&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>            <span class=n>src</span> <span class=o>=</span> <span class=n>self</span><span class=o>.</span><span class=n>fetchFromGitHub</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>              <span class=n>owner</span> <span class=o>=</span> <span class=s2>&#34;rmcelreath&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>              <span class=n>repo</span> <span class=o>=</span> <span class=s2>&#34;rethinking&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>              <span class=n>rev</span> <span class=o>=</span> <span class=s2>&#34;d0978c7f8b6329b94efa2014658d750ae12b1fa2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>              <span class=n>sha256</span> <span class=o>=</span> <span class=s2>&#34;1qip6x3f6j9lmcmck6sjrj50a5azqfl6rfhp4fdj7ddabpb8n0z0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>            <span class=n>propagatedBuildInputs</span> <span class=o>=</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>              <span class=p>[</span> <span class=n>coda</span> <span class=n>MASS</span> <span class=n>mvtnorm</span> <span class=n>loo</span> <span class=n>shape</span> <span class=n>rstan</span> <span class=n>dagitty</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>          <span class=p>})</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=ln>25</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This snippet allows us to use our <code>R</code> as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=c1># Install things</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>nix-env -f <span class=s2>&#34;&lt;nixpkgs&gt;&#34;</span> -iA rEnv
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=c1># Fix locale</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nb>export</span> <span class=nv>LOCALE_ARCHIVE</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>nix-build --no-out-link <span class=s2>&#34;&lt;nixpkgs&gt;&#34;</span> -A glibcLocales<span class=k>)</span><span class=s2>/lib/locale/locale-archive&#34;</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=c1># Profit</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>R
</span></span></code></pre></div><p>Note that in this method, on Linux systems, the locale problem has to be fixed
with the explicit export. This means that this should be used mostly with
project level environments, instead of populating the global shell RC files.</p><p><strong>Update:</strong> There is <a href=/posts/emacs-nix-r/>another post</a> with methods to reload this configuration automatically</p><h2 id=conclusions>Conclusions</h2><p>Of the methods described, the most useful method for working with packages not
hosted on CRAN is through the user-profile, while the <code>shell.nix</code> method is
useful in conjunction, for managing various projects. So the ideal approach is
then to use the user profile for installing anything which normally uses
<code>devtools</code> and then use <code>shell.nix</code> for the rest.</p><p>Note that if the <a href=#project-shell>Project Shell</a> is used with a <a href=#user-profile>User Profile</a> as described in the
next section, all packages defined there can be dropped and then the project
shell does not need to execute <code>R</code> by default. The simplified <code>shell.nix</code> is
then simply:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=ln> 1</span><span class=cl><span class=p>{</span> <span class=n>pkgs</span> <span class=o>?</span> <span class=kn>import</span> <span class=sr>&lt;nixpkgs&gt;</span> <span class=p>{</span> <span class=p>}</span> <span class=p>}:</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=k>let</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=n>my-r-pkgs</span> <span class=o>=</span> <span class=n>rWrapper</span><span class=o>.</span><span class=n>override</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>rPackages</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>      <span class=n>ggplot2</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=k>in</span> <span class=n>mkShell</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>  <span class=n>buildInputs</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;[</span> <span class=n>git</span> <span class=n>glibcLocales</span> <span class=n>openssl</span> <span class=n>which</span> <span class=n>openssh</span> <span class=n>curl</span> <span class=n>wget</span> <span class=n>my-r-pkgs</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=n>inputsFrom</span> <span class=o>=</span> <span class=p>[</span> <span class=n>my-r-pkgs</span> <span class=p>];</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  <span class=n>shellHook</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=s1>    mkdir -p &#34;$(pwd)/_libs&#34;
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=s1>    export R_LIBS_USER=&#34;$(pwd)/_libs&#34;
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=s1>  &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>  <span class=n>GIT_SSL_CAINFO</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>${</span><span class=n>cacert</span><span class=si>}</span><span class=s2>/etc/ssl/certs/ca-bundle.crt&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>  <span class=n>LOCALE_ARCHIVE</span> <span class=o>=</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>optionalString</span> <span class=n>stdenv</span><span class=o>.</span><span class=n>isLinux</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=n>glibcLocales</span><span class=si>}</span><span class=s2>/lib/locale/locale-archive&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The entire workflow for
<code>rethinking</code> is <a href=/posts/rethinking-r-nix/>continued here</a>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>As part of <a href="https://ugla.hi.is/kennsluskra/index.php?sid=&amp;tab=nam&amp;chapter=namskeid&amp;id=71055920203">a summer course</a> at the University of Iceland relating to their successful <a href=http://covid.hi.is/>COVID-19 model</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>The <a href=https://wiki.archlinux.org/index.php/Arch_User_Repository>Arch User Repository</a> is the port of first call for most ArchLinux users&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Though, like any good AUR user, I did post a bug report&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>This approach is also <a href=https://churchman.nl/tag/r/>discussed here</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>As discussed on <a href=https://github.com/NixOS/nixpkgs/issues/44290>this issue</a>, this <a href=https://stackoverflow.com/questions/55176609/how-to-install-r-and-packages-through-configuration-nix-and-how-to-add-packages>stackoverflow question</a> and also <a href=https://github.com/rikhuijzer/nix-with-r/blob/master/default.nix>seen here</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><hr><div class=post-series-bottom><h2>Series info</h2><h3>R x Nix Nexus: Crafting Cohesive Environments series</h3><ol><li><b>Nix with R and devtools</b> &lt;-- You are here!</li><li><a href=https://rgoswami.me/posts/rethinking-r-nix/>Statistical Rethinking and Nix</a></li><li><a href=https://rgoswami.me/posts/emacs-nix-r/>Emacs for Nix-R</a></li></ol></div></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/tools>tools</a></span><span class=tag><a href=/tags/nix>nix</a></span><span class=tag><a href=/tags/workflow>workflow</a></span><span class=tag><a href=/tags/r>R</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1315 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Posted: <time class=dt-published>2020-06-06 05:49 +0000</time></p><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frgoswami.me%2fposts%2fnix-r-devtools%2f" target=_blank rel=noopener aria-label=Facebook><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15.84 9.5H13.5V8.48c0-.53.35-.65.6-.65h1.4v-2.3h-2.35c-2.3.0-2.65 1.7-2.65 2.8V9.5h-2v2h2v7h3v-7h2.1l.24-2z"/></svg></div>Facebook</div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=%22Nix%20with%20R%20and%20devtools%22%20seems%20like%20an%20interesting%20read%20from%20%40rg0swami&amp;url=https%3a%2f%2frgoswami.me%2fposts%2fnix-r-devtools%2f" target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3.0 1 .4 1.7 1.2 2.2-.5.0-1 0-1.2-.3.0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8.0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="12" cy="12" r="11.5"/></svg></div>Twitter</div></a><a class=resp-sharing-button__link href="mailto:?subject=%22Nix%20with%20R%20and%20devtools%22%20seems%20interesting...&amp;body=https%3a%2f%2frgoswami.me%2fposts%2fnix-r-devtools%2f" target=_self rel=noopener aria-label=E-Mail><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 16c0 .8-.7 1.5-1.5 1.5H6c-.8.0-1.5-.7-1.5-1.5V8c0-.8.7-1.5 1.5-1.5h12c.8.0 1.5.7 1.5 1.5v8zm-2-7.5L12 13 6.5 8.5m11 6-4-2.5m-7 2.5 4-2.5"/><circle cx="12" cy="12" r="11.5"/></svg></div>E-Mail</div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2frgoswami.me%2fposts%2fnix-r-devtools%2f&amp;title=%22Nix%20with%20R%20and%20devtools%22%20seems%20interesting...&amp;summary=%22Nix%20with%20R%20and%20devtools%22%20seems%20interesting...&amp;source=https%3a%2f%2frgoswami.me%2fposts%2fnix-r-devtools%2f" target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15 12.5c-.28.0-.5.22-.5.5v3.5h-3s.03-6.48.0-7h3v.83s.46-.75 1.7-.75c1.56.0 2.3 1.12 2.3 3.3v3.62h-3V13c0-.28-.23-.5-.5-.5zm-7.5-3h2v7h-2z"/><circle cx="8.5" cy="6.5" r="1"/></svg></div>LinkedIn</div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2frgoswami.me%2fposts%2fnix-r-devtools%2f&amp;resubmit=true&amp;title=%22Nix%20with%20R%20and%20devtools%22%20seems%20interesting..." target=_blank rel=noopener aria-label=Reddit><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><ellipse cx="12" cy="14.37" rx="6.2" ry="4.24"/><path d="M14.3 16.25c-.62.36-1.42.57-2.3.57s-1.7-.2-2.32-.58"/><circle cx="14.61" cy="13.39" r=".98"/><circle cx="9.39" cy="13.39" r=".98"/><path d="M16.4 11.38c.26-.55.82-.92 1.47-.92.9.0 1.63.73 1.63 1.63.0.8-.6 1.47-1.38 1.6"/><circle cx="17.22" cy="7.52" r="1.63"/><path d="M7.6 11.38c-.26-.54-.82-.92-1.47-.92-.9.0-1.63.73-1.63 1.63.0.8.6 1.47 1.38 1.6M12 10.12s-.08-4.82 3.6-2.6"/></svg></div>Reddit</div></a><a class=resp-sharing-button__link href="whatsapp://send?text=%22Nix%20with%20R%20and%20devtools%22%20seems%20interesting...%20https%3a%2f%2frgoswami.me%2fposts%2fnix-r-devtools%2f" target=_blank rel=noopener aria-label=WhatsApp><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle xmlns="http://www.w3.org/2000/svg" cx="12" cy="12" r="11.5"/><path stroke-width="1" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3.0-7.8 3.5-7.8 7.8.0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4.9 3.7.9 4.3.0 7.8-3.5 7.8-7.8.1-2-.7-3.9-2.2-5.4zm-5.5 11.9c-1.2.0-2.3-.3-3.3-.9l-.2-.1-2.4.6.7-2.4-.2-.2c-.6-1-1-2.2-1-3.4.0-3.6 2.9-6.5 6.5-6.5 1.7.0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.4-6.6 6.4zm3.5-4.8c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1s-.5.6-.6.8c-.1.1-.2.1-.4.0s-.8-.3-1.6-1c-.6-.5-1-1.2-1.1-1.3-.1-.2.0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.0-.2.0-.3s-.4-1.1-.6-1.4c-.2-.4-.3-.3-.4-.3h-.4s-.3.0-.5.2-.7.7-.7 1.6c0 1 .7 1.9.8 2s1.4 2.1 3.3 2.9c.5.2.8.3 1.1.4.5.1.9.1 1.2.1.4-.1 1.1-.5 1.3-.9.2-.5.2-.8.1-.9.0-.2-.2-.3-.4-.4z"/></svg></div>WhatsApp</div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://rgoswami.me/posts/sr2-ch2-ch3-ch4/><span class=button__icon>←</span>
<span class=button__text>"SR2 :: Solutions for Chapters {2,3,4}"</span></a></span>
<span class="button next"><a href=https://rgoswami.me/posts/losslesscut-zoom-ama/><span class=button__text>LosslessCut, Zoom and an AMA for CS106A</span>
<span class=button__icon>→</span></a></span></div></div><div id=comments class=thin><div class=pagination__title><span class=pagination__title-h>Comments</span><hr></div><script src=https://utteranc.es/client.js repo=haozeke/haozeke.github.io issue-term=pathname theme=photon-dark label="Utterance 💬" crossorigin=anonymous async></script></div></main><footer class=footer><p>&copy; 2023
<span><a href=https://rgoswami.me/>Rohit Goswami (HaoZeke)</a></span>
<a href=/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a><br><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br><script src=https://liberapay.com/rohit/widgets/button.js></script><noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript></p></footer></div><script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script>
<script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-109503488-16","auto"),ga("send","pageview")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","3z2xvwqu4u")</script><script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script><script async src=https://static.getclicky.com/js></script>
<script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script>
<script src=/js/codefold.min.f0790269b87613b3bcff64022840fe1991eee3ea384e874c78a24022c9936bd888a3c14a05a10955881eebb1558e4fcf37576dac120cd0bf4ebaf7aca27b35b1.js></script>
<script src=/js/copyClipboard.min.1c92539aea398296101add0e80508ad94cb59fb37f946f06ec9ca1c7558a961b8de0c5595a921aed70aa91eb94d24db35e5a01243bc625f8b1814b17928f478b.js></script></body></html>