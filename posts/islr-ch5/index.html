<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[  &#34;Rohit Goswami&#34;
  ]"><meta name=description content="Chapter V - Resampling Methods All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&amp;#34;mlr3&amp;#34;,&amp;#34;data.table&amp;#34;,&amp;#34;mlr3viz&amp;#34;,&amp;#34;mlr3learners&amp;#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
1install.packages(&amp;#34;remotes&amp;#34;,&amp;#34;data.table&amp;#34;, 2&amp;#34;GGally&amp;#34;,&amp;#34;precerec&amp;#34;) # For plots 1library(remotes) 2remotes::install_github(&amp;#34;mlr-org/mlr3&amp;#34;) 3remotes::install_github(&amp;#34;mlr-org/mlr3viz&amp;#34;) 4remotes::install_github(&amp;#34;mlr-org/mlr3learners&amp;#34;) Load ISLR and other libraries.
1libsUsed&amp;lt;-c(&amp;#34;dplyr&amp;#34;,&amp;#34;ggplot2&amp;#34;,&amp;#34;tidyverse&amp;#34;, 2&amp;#34;ISLR&amp;#34;,&amp;#34;caret&amp;#34;,&amp;#34;MASS&amp;#34;, 3&amp;#34;pROC&amp;#34;,&amp;#34;mlr3&amp;#34;,&amp;#34;data.table&amp;#34;, 4&amp;#34;mlr3viz&amp;#34;,&amp;#34;mlr3learners&amp;#34;) 5invisible(lapply(libsUsed, library, character.only = TRUE)) Question 5."><meta name=keywords content=",solutions,R,ISLR"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rgoswami.me/posts/islr-ch5/><title>"ISLR :: Resampling Methods"
:: Rohit Goswami — Reflections</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.b6dbce0fdf6c61563a0c2226e857d5dadd8e5afa2c4f73ec9ea55abd831f9a72.css><meta itemprop=name content="  &#34;ISLR :: Resampling Methods&#34;
  "><meta itemprop=description content="Chapter V - Resampling Methods All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
1install.packages(&#34;remotes&#34;,&#34;data.table&#34;, 2&#34;GGally&#34;,&#34;precerec&#34;) # For plots 1library(remotes) 2remotes::install_github(&#34;mlr-org/mlr3&#34;) 3remotes::install_github(&#34;mlr-org/mlr3viz&#34;) 4remotes::install_github(&#34;mlr-org/mlr3learners&#34;) Load ISLR and other libraries.
1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2&#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, 3&#34;pROC&#34;,&#34;mlr3&#34;,&#34;data.table&#34;, 4&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) 5invisible(lapply(libsUsed, library, character.only = TRUE)) Question 5."><meta itemprop=datePublished content="2020-02-18T22:00:00+00:00"><meta itemprop=dateModified content="2020-02-18T22:00:00+00:00"><meta itemprop=wordCount content="5182"><meta itemprop=image content="https://rgoswami.me/images/RG.png"><meta itemprop=keywords content="solutions,R,ISLR,"><meta property="og:title" content="  &#34;ISLR :: Resampling Methods&#34;
  "><meta property="og:description" content="Chapter V - Resampling Methods All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
1install.packages(&#34;remotes&#34;,&#34;data.table&#34;, 2&#34;GGally&#34;,&#34;precerec&#34;) # For plots 1library(remotes) 2remotes::install_github(&#34;mlr-org/mlr3&#34;) 3remotes::install_github(&#34;mlr-org/mlr3viz&#34;) 4remotes::install_github(&#34;mlr-org/mlr3learners&#34;) Load ISLR and other libraries.
1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2&#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, 3&#34;pROC&#34;,&#34;mlr3&#34;,&#34;data.table&#34;, 4&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) 5invisible(lapply(libsUsed, library, character.only = TRUE)) Question 5."><meta property="og:type" content="article"><meta property="og:url" content="https://rgoswami.me/posts/islr-ch5/"><meta property="og:image" content="https://rgoswami.me/images/RG.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-18T22:00:00+00:00"><meta property="article:modified_time" content="2020-02-18T22:00:00+00:00"><meta property="og:site_name" content="Rohit Goswami"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rgoswami.me/images/RG.png"><meta name=twitter:title content="  &#34;ISLR :: Resampling Methods&#34;
  "><meta name=twitter:description content="Chapter V - Resampling Methods All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
1install.packages(&#34;remotes&#34;,&#34;data.table&#34;, 2&#34;GGally&#34;,&#34;precerec&#34;) # For plots 1library(remotes) 2remotes::install_github(&#34;mlr-org/mlr3&#34;) 3remotes::install_github(&#34;mlr-org/mlr3viz&#34;) 4remotes::install_github(&#34;mlr-org/mlr3learners&#34;) Load ISLR and other libraries.
1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2&#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, 3&#34;pROC&#34;,&#34;mlr3&#34;,&#34;data.table&#34;, 4&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) 5invisible(lapply(libsUsed, library, character.only = TRUE)) Question 5."><meta property="article:section" content="programming"><meta property="article:published_time" content="2020-02-18 22:00:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><div class=header__inner><div class=header__left><div class=logo><a href=/ style=text-decoration:none><img src=/images/home.png alt></a></div></div><div class=header__mid><button class=button><div class=button__text><a href=https://rgoswami.me//search>Search</a></div></button></div><div class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://rgoswami.me/about>About</a></li><li><a href=https://rgoswami.me/posts>Blog</a></li></ul><ul class=menu__inner><li><a href=https://rgoswami.me/categories>Categories</a></li><li><a href=https://rgoswami.me/tags>Tags</a></li></ul></nav><button id=toggleMenu><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></div></button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></button></div></div></header><script src=https://rgoswami.me/js/mathjax-config.js></script>
<script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script><aside class=sidebar><div class=hideTOC><button id=tocTog>TOC</button><div class="sideTOC m-fadeOut"><nav id=TableOfContents><ul><li><a href=#chapter-v---resampling-methods>Chapter V - Resampling Methods</a><ul><li><a href=#common>Common</a></li></ul></li><li><a href=#question-5.5---page-198>Question 5.5 - Page 198</a><ul><li><a href=#answer>Answer</a></li></ul></li><li><a href=#question-5.6---page-199>Question 5.6 - Page 199</a><ul><li><a href=#answer-1>Answer</a></li></ul></li><li><a href=#question-5.8---page-200>Question 5.8 - Page 200</a><ul><li><a href=#answer-2>Answer</a></li></ul></li><li><a href=#question-5.9---page-201>Question 5.9 - Page 201</a><ul><li><a href=#answer-3>Answer</a></li></ul></li></ul></nav></div></div></aside><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>25 minutes<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Written: 2020-02-18 22:00 +0000</p></p></div><article class=h-entry><h1 class="post-title p-name"><a class=u-url href=https://rgoswami.me/posts/islr-ch5/>&ldquo;ISLR :: Resampling Methods&rdquo;</a></h1><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pen-tool"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg><span class="author u-author p-author"><a href=https://rgoswami.me/author/rohit-goswami>"Rohit Goswami"</a></span></div><hr><aside id=toc class=sidebar><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#chapter-v---resampling-methods>Chapter V - Resampling Methods</a><ul><li><a href=#common>Common</a></li></ul></li><li><a href=#question-5.5---page-198>Question 5.5 - Page 198</a><ul><li><a href=#answer>Answer</a></li></ul></li><li><a href=#question-5.6---page-199>Question 5.6 - Page 199</a><ul><li><a href=#answer-1>Answer</a></li></ul></li><li><a href=#question-5.8---page-200>Question 5.8 - Page 200</a><ul><li><a href=#answer-2>Answer</a></li></ul></li><li><a href=#question-5.9---page-201>Question 5.9 - Page 201</a><ul><li><a href=#answer-3>Answer</a></li></ul></li></ul></nav></aside><hr><div class="post-content e-content"><h2 id=chapter-v---resampling-methods>Chapter V - Resampling Methods</h2><p>All the questions are as per the
<a href=https://www.statlearning.com/>ISL seventh
printing of the First edition</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><h3 id=common>Common</h3><p>Instead of using the standard functions, we will leverage the <code>mlr3</code>
package<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1>#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;)</span>
</span></span></code></pre></div><p>Actually for <code>R</code> version <code>3.6.2</code>, the steps to get it working were a bit
more involved.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;remotes&#34;</span><span class=p>,</span><span class=s>&#34;data.table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                 <span class=s>&#34;GGally&#34;</span><span class=p>,</span><span class=s>&#34;precerec&#34;</span><span class=p>)</span> <span class=c1># For plots</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>remotes</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>remotes</span><span class=o>::</span><span class=nf>install_github</span><span class=p>(</span><span class=s>&#34;mlr-org/mlr3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>remotes</span><span class=o>::</span><span class=nf>install_github</span><span class=p>(</span><span class=s>&#34;mlr-org/mlr3viz&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>remotes</span><span class=o>::</span><span class=nf>install_github</span><span class=p>(</span><span class=s>&#34;mlr-org/mlr3learners&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Load <code>ISLR</code> and other libraries.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>libsUsed</span><span class=o>&lt;-</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;dplyr&#34;</span><span class=p>,</span><span class=s>&#34;ggplot2&#34;</span><span class=p>,</span><span class=s>&#34;tidyverse&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>            <span class=s>&#34;ISLR&#34;</span><span class=p>,</span><span class=s>&#34;caret&#34;</span><span class=p>,</span><span class=s>&#34;MASS&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>            <span class=s>&#34;pROC&#34;</span><span class=p>,</span><span class=s>&#34;mlr3&#34;</span><span class=p>,</span><span class=s>&#34;data.table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>            <span class=s>&#34;mlr3viz&#34;</span><span class=p>,</span><span class=s>&#34;mlr3learners&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>invisible</span><span class=p>(</span><span class=nf>lapply</span><span class=p>(</span><span class=n>libsUsed</span><span class=p>,</span> <span class=n>library</span><span class=p>,</span> <span class=n>character.only</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=question-5.5---page-198>Question 5.5 - Page 198</h2><p>In Chapter 4, we used logistic regression to predict the probability of
<code>default</code> using <code>income</code> and <code>balance</code> on the <code>Default</code> data set. We
will now estimate the test error of this logistic regression model using
the validation set approach. Do not forget to set a random seed before
beginning your analysis.</p><p><strong>(a)</strong> Fit a logistic regression model that uses income and balance to
predict <code>default</code>.</p><p><strong>(b)</strong> Using the validation set approach, estimate the test error of this
model. In order to do this, you must perform the following steps:</p><ol><li><p>Split the sample set into a training set and a validation set.</p></li><li><p>Fit a multiple logistic regression model using only the training
observations.</p></li><li><p>Obtain a prediction of default status for each individual in the
validation set by computing the posterior probability of default for
that individual, and classifying the individual to the <code>default</code>
category if the posterior probability is greater than \(0.5\).</p></li><li><p>Compute the validation set error, which is the fraction of the
observations in the validation set that are misclassified.</p></li></ol><p><strong>(c)</strong> Repeat the process in (b) three times, using three different
splits of the observations into a training set and a validation set.
Comment on the results obtained.</p><p><strong>(d)</strong> Now consider a logistic regression model that predicts the prob-
ability of <code>default</code> using <code>income</code> , <code>balance</code> , and a dummy variable
for <code>student</code>. Estimate the test error for this model using the
validation set approach. Comment on whether or not including a dummy
variable for <code>student</code> leads to a reduction in the test error rate.</p><h3 id=answer>Answer</h3><p>We will need our data.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>defDat</span><span class=o>&lt;-</span><span class=n>ISLR</span><span class=o>::</span><span class=n>Default</span>
</span></span></code></pre></div><ul><li>Very quick peek</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>defDat</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##  default    student       balance           income
</span></span><span class=line><span class=ln>2</span><span class=cl>##  No :9667   No :7056   Min.   :   0.0   Min.   :  772
</span></span><span class=line><span class=ln>3</span><span class=cl>##  Yes: 333   Yes:2944   1st Qu.: 481.7   1st Qu.:21340
</span></span><span class=line><span class=ln>4</span><span class=cl>##                        Median : 823.6   Median :34553
</span></span><span class=line><span class=ln>5</span><span class=cl>##                        Mean   : 835.4   Mean   :33517
</span></span><span class=line><span class=ln>6</span><span class=cl>##                        3rd Qu.:1166.3   3rd Qu.:43808
</span></span><span class=line><span class=ln>7</span><span class=cl>##                        Max.   :2654.3   Max.   :73554
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>defDat</span> <span class=o>%&gt;%</span> <span class=n>str</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## &#39;data.frame&#39;:    10000 obs. of  4 variables:
</span></span><span class=line><span class=ln>2</span><span class=cl>##  $ default: Factor w/ 2 levels &#34;No&#34;,&#34;Yes&#34;: 1 1 1 1 1 1 1 1 1 1 ...
</span></span><span class=line><span class=ln>3</span><span class=cl>##  $ student: Factor w/ 2 levels &#34;No&#34;,&#34;Yes&#34;: 1 2 1 1 1 2 1 2 1 1 ...
</span></span><span class=line><span class=ln>4</span><span class=cl>##  $ balance: num  730 817 1074 529 786 ...
</span></span><span class=line><span class=ln>5</span><span class=cl>##  $ income : num  44362 12106 31767 35704 38463 ...
</span></span></code></pre></div><h4 id=a-logistic-model-with-mlr3>a) Logistic Model with mlr3</h4><p>Following the <a href=https://mlr3book.mlr-org.com/tasks.html>new approach</a>
which leverages R6 features leads us to define a classification task
first. As far as I can tell, the data needs to be filtered to contain
only the things we need to predict with, in this case we are required to
use only income and balance so we will do so.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>1984</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>redDat</span><span class=o>&lt;-</span><span class=n>defDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>income</span><span class=p>,</span><span class=n>balance</span><span class=p>,</span><span class=n>default</span><span class=p>))</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>tskLogiFull</span><span class=o>=</span><span class=n>TaskClassif</span><span class=o>$</span><span class=nf>new</span><span class=p>(</span><span class=n>id</span><span class=o>=</span><span class=s>&#34;credit&#34;</span><span class=p>,</span><span class=n>backend</span><span class=o>=</span><span class=n>redDat</span><span class=p>,</span><span class=n>target</span><span class=o>=</span><span class=s>&#34;default&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## &lt;TaskClassif:credit&gt; (10000 x 3)
</span></span><span class=line><span class=ln>2</span><span class=cl>## * Target: default
</span></span><span class=line><span class=ln>3</span><span class=cl>## * Properties: twoclass
</span></span><span class=line><span class=ln>4</span><span class=cl>## * Features (2):
</span></span><span class=line><span class=ln>5</span><span class=cl>##   - dbl (2): balance, income
</span></span></code></pre></div><p>This can be visualized neatly as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-8-1.png alt="Figure 1: MLR3 Visualizations"><figcaption><p><span class=figure-number>Figure 1: </span>MLR3 Visualizations</p></figcaption></figure><p>We have a pretty imbalanced data-set.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;pairs&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Registered S3 method overwritten by &#39;GGally&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##   method from
</span></span><span class=line><span class=ln>3</span><span class=cl>##   +.gg   ggplot2
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span><span class=line><span class=ln>2</span><span class=cl>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-9-1.png alt="Figure 2: Paired mlr3 data"><figcaption><p><span class=figure-number>Figure 2: </span>Paired mlr3 data</p></figcaption></figure><p>We can use any of the learners implemented, so it is a good idea to take
a quick peek at them all.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>as.data.table</span><span class=p>(</span><span class=n>mlr_learners</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##                     key                                    feature_types
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  1:       classif.debug logical,integer,numeric,character,factor,ordered
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  2: classif.featureless logical,integer,numeric,character,factor,ordered
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  3:      classif.glmnet                          logical,integer,numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  4:        classif.kknn           logical,integer,numeric,factor,ordered
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  5:         classif.lda           logical,integer,numeric,factor,ordered
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  6:     classif.log_reg logical,integer,numeric,character,factor,ordered
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  7: classif.naive_bayes                   logical,integer,numeric,factor
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  8:         classif.qda           logical,integer,numeric,factor,ordered
</span></span><span class=line><span class=ln>10</span><span class=cl>##  9:      classif.ranger logical,integer,numeric,character,factor,ordered
</span></span><span class=line><span class=ln>11</span><span class=cl>## 10:       classif.rpart           logical,integer,numeric,factor,ordered
</span></span><span class=line><span class=ln>12</span><span class=cl>## 11:         classif.svm                          logical,integer,numeric
</span></span><span class=line><span class=ln>13</span><span class=cl>## 12:     classif.xgboost                          logical,integer,numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## 13:    regr.featureless logical,integer,numeric,character,factor,ordered
</span></span><span class=line><span class=ln>15</span><span class=cl>## 14:         regr.glmnet                          logical,integer,numeric
</span></span><span class=line><span class=ln>16</span><span class=cl>## 15:           regr.kknn           logical,integer,numeric,factor,ordered
</span></span><span class=line><span class=ln>17</span><span class=cl>## 16:             regr.km                          logical,integer,numeric
</span></span><span class=line><span class=ln>18</span><span class=cl>## 17:             regr.lm                   logical,integer,numeric,factor
</span></span><span class=line><span class=ln>19</span><span class=cl>## 18:         regr.ranger logical,integer,numeric,character,factor,ordered
</span></span><span class=line><span class=ln>20</span><span class=cl>## 19:          regr.rpart           logical,integer,numeric,factor,ordered
</span></span><span class=line><span class=ln>21</span><span class=cl>## 20:            regr.svm                          logical,integer,numeric
</span></span><span class=line><span class=ln>22</span><span class=cl>## 21:        regr.xgboost                          logical,integer,numeric
</span></span><span class=line><span class=ln>23</span><span class=cl>##                     key                                    feature_types
</span></span><span class=line><span class=ln>24</span><span class=cl>##        packages
</span></span><span class=line><span class=ln>25</span><span class=cl>##  1:
</span></span><span class=line><span class=ln>26</span><span class=cl>##  2:
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3:      glmnet
</span></span><span class=line><span class=ln>28</span><span class=cl>##  4:        kknn
</span></span><span class=line><span class=ln>29</span><span class=cl>##  5:        MASS
</span></span><span class=line><span class=ln>30</span><span class=cl>##  6:       stats
</span></span><span class=line><span class=ln>31</span><span class=cl>##  7:       e1071
</span></span><span class=line><span class=ln>32</span><span class=cl>##  8:        MASS
</span></span><span class=line><span class=ln>33</span><span class=cl>##  9:      ranger
</span></span><span class=line><span class=ln>34</span><span class=cl>## 10:       rpart
</span></span><span class=line><span class=ln>35</span><span class=cl>## 11:       e1071
</span></span><span class=line><span class=ln>36</span><span class=cl>## 12:     xgboost
</span></span><span class=line><span class=ln>37</span><span class=cl>## 13:       stats
</span></span><span class=line><span class=ln>38</span><span class=cl>## 14:      glmnet
</span></span><span class=line><span class=ln>39</span><span class=cl>## 15:        kknn
</span></span><span class=line><span class=ln>40</span><span class=cl>## 16: DiceKriging
</span></span><span class=line><span class=ln>41</span><span class=cl>## 17:       stats
</span></span><span class=line><span class=ln>42</span><span class=cl>## 18:      ranger
</span></span><span class=line><span class=ln>43</span><span class=cl>## 19:       rpart
</span></span><span class=line><span class=ln>44</span><span class=cl>## 20:       e1071
</span></span><span class=line><span class=ln>45</span><span class=cl>## 21:     xgboost
</span></span><span class=line><span class=ln>46</span><span class=cl>##        packages
</span></span><span class=line><span class=ln>47</span><span class=cl>##                                                            properties
</span></span><span class=line><span class=ln>48</span><span class=cl>##  1:                                      missings,multiclass,twoclass
</span></span><span class=line><span class=ln>49</span><span class=cl>##  2:         importance,missings,multiclass,selected_features,twoclass
</span></span><span class=line><span class=ln>50</span><span class=cl>##  3:                                       multiclass,twoclass,weights
</span></span><span class=line><span class=ln>51</span><span class=cl>##  4:                                               multiclass,twoclass
</span></span><span class=line><span class=ln>52</span><span class=cl>##  5:                                       multiclass,twoclass,weights
</span></span><span class=line><span class=ln>53</span><span class=cl>##  6:                                                  twoclass,weights
</span></span><span class=line><span class=ln>54</span><span class=cl>##  7:                                               multiclass,twoclass
</span></span><span class=line><span class=ln>55</span><span class=cl>##  8:                                       multiclass,twoclass,weights
</span></span><span class=line><span class=ln>56</span><span class=cl>##  9:                  importance,multiclass,oob_error,twoclass,weights
</span></span><span class=line><span class=ln>57</span><span class=cl>## 10: importance,missings,multiclass,selected_features,twoclass,weights
</span></span><span class=line><span class=ln>58</span><span class=cl>## 11:                                               multiclass,twoclass
</span></span><span class=line><span class=ln>59</span><span class=cl>## 12:                   importance,missings,multiclass,twoclass,weights
</span></span><span class=line><span class=ln>60</span><span class=cl>## 13:                             importance,missings,selected_features
</span></span><span class=line><span class=ln>61</span><span class=cl>## 14:                                                           weights
</span></span><span class=line><span class=ln>62</span><span class=cl>## 15:
</span></span><span class=line><span class=ln>63</span><span class=cl>## 16:
</span></span><span class=line><span class=ln>64</span><span class=cl>## 17:                                                           weights
</span></span><span class=line><span class=ln>65</span><span class=cl>## 18:                                      importance,oob_error,weights
</span></span><span class=line><span class=ln>66</span><span class=cl>## 19:                     importance,missings,selected_features,weights
</span></span><span class=line><span class=ln>67</span><span class=cl>## 20:
</span></span><span class=line><span class=ln>68</span><span class=cl>## 21:                                       importance,missings,weights
</span></span><span class=line><span class=ln>69</span><span class=cl>##                                                            properties
</span></span><span class=line><span class=ln>70</span><span class=cl>##     predict_types
</span></span><span class=line><span class=ln>71</span><span class=cl>##  1: response,prob
</span></span><span class=line><span class=ln>72</span><span class=cl>##  2: response,prob
</span></span><span class=line><span class=ln>73</span><span class=cl>##  3: response,prob
</span></span><span class=line><span class=ln>74</span><span class=cl>##  4: response,prob
</span></span><span class=line><span class=ln>75</span><span class=cl>##  5: response,prob
</span></span><span class=line><span class=ln>76</span><span class=cl>##  6: response,prob
</span></span><span class=line><span class=ln>77</span><span class=cl>##  7: response,prob
</span></span><span class=line><span class=ln>78</span><span class=cl>##  8: response,prob
</span></span><span class=line><span class=ln>79</span><span class=cl>##  9: response,prob
</span></span><span class=line><span class=ln>80</span><span class=cl>## 10: response,prob
</span></span><span class=line><span class=ln>81</span><span class=cl>## 11: response,prob
</span></span><span class=line><span class=ln>82</span><span class=cl>## 12: response,prob
</span></span><span class=line><span class=ln>83</span><span class=cl>## 13:   response,se
</span></span><span class=line><span class=ln>84</span><span class=cl>## 14:      response
</span></span><span class=line><span class=ln>85</span><span class=cl>## 15:      response
</span></span><span class=line><span class=ln>86</span><span class=cl>## 16:   response,se
</span></span><span class=line><span class=ln>87</span><span class=cl>## 17:   response,se
</span></span><span class=line><span class=ln>88</span><span class=cl>## 18:   response,se
</span></span><span class=line><span class=ln>89</span><span class=cl>## 19:      response
</span></span><span class=line><span class=ln>90</span><span class=cl>## 20:      response
</span></span><span class=line><span class=ln>91</span><span class=cl>## 21:      response
</span></span><span class=line><span class=ln>92</span><span class=cl>##     predict_types
</span></span></code></pre></div><p>We can now pick the logistic one.
<a href=https://github.com/mlr-org/mlr3learners/>Note that</a> this essentially
proxies our requests down to the <code>stats</code> package.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>learner</span> <span class=o>=</span> <span class=n>mlr_learners</span><span class=o>$</span><span class=nf>get</span><span class=p>(</span><span class=s>&#34;classif.log_reg&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Now we can final solve the question, which is to simply use the model on
all our data and return the accuracy metrics.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>trainFullCred</span><span class=o>=</span><span class=n>learner</span><span class=o>$</span><span class=nf>train</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>learner</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>)</span><span class=o>$</span><span class=n>confusion</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##         truth
</span></span><span class=line><span class=ln>2</span><span class=cl>## response   No  Yes
</span></span><span class=line><span class=ln>3</span><span class=cl>##      No  9629  225
</span></span><span class=line><span class=ln>4</span><span class=cl>##      Yes   38  108
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>measure</span> <span class=o>=</span> <span class=nf>msr</span><span class=p>(</span><span class=s>&#34;classif.acc&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>learner</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>)</span><span class=o>$</span><span class=nf>score</span><span class=p>(</span><span class=n>measure</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## classif.acc
</span></span><span class=line><span class=ln>2</span><span class=cl>##      0.9737
</span></span></code></pre></div><p>Note that this style of working with objects does not really utilize the
familiar <code>%>%</code> interface.</p><p>The <code>caret</code> package still has neater default metrics so we will use that
as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>confusionMatrix</span><span class=p>(</span><span class=n>learner</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>)</span><span class=o>$</span><span class=n>response</span><span class=p>,</span><span class=n>defDat</span><span class=o>$</span><span class=n>default</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Confusion Matrix and Statistics
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>##           Reference
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Prediction   No  Yes
</span></span><span class=line><span class=ln> 5</span><span class=cl>##        No  9629  225
</span></span><span class=line><span class=ln> 6</span><span class=cl>##        Yes   38  108
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##                Accuracy : 0.9737
</span></span><span class=line><span class=ln> 9</span><span class=cl>##                  95% CI : (0.9704, 0.9767)
</span></span><span class=line><span class=ln>10</span><span class=cl>##     No Information Rate : 0.9667
</span></span><span class=line><span class=ln>11</span><span class=cl>##     P-Value [Acc &gt; NIR] : 3.067e-05
</span></span><span class=line><span class=ln>12</span><span class=cl>##
</span></span><span class=line><span class=ln>13</span><span class=cl>##                   Kappa : 0.4396
</span></span><span class=line><span class=ln>14</span><span class=cl>##
</span></span><span class=line><span class=ln>15</span><span class=cl>##  Mcnemar&#39;s Test P-Value : &lt; 2.2e-16
</span></span><span class=line><span class=ln>16</span><span class=cl>##
</span></span><span class=line><span class=ln>17</span><span class=cl>##             Sensitivity : 0.9961
</span></span><span class=line><span class=ln>18</span><span class=cl>##             Specificity : 0.3243
</span></span><span class=line><span class=ln>19</span><span class=cl>##          Pos Pred Value : 0.9772
</span></span><span class=line><span class=ln>20</span><span class=cl>##          Neg Pred Value : 0.7397
</span></span><span class=line><span class=ln>21</span><span class=cl>##              Prevalence : 0.9667
</span></span><span class=line><span class=ln>22</span><span class=cl>##          Detection Rate : 0.9629
</span></span><span class=line><span class=ln>23</span><span class=cl>##    Detection Prevalence : 0.9854
</span></span><span class=line><span class=ln>24</span><span class=cl>##       Balanced Accuracy : 0.6602
</span></span><span class=line><span class=ln>25</span><span class=cl>##
</span></span><span class=line><span class=ln>26</span><span class=cl>##        &#39;Positive&#39; Class : No
</span></span><span class=line><span class=ln>27</span><span class=cl>##
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>learner</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>))</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-14-1.png alt="Figure 3: Autoplot results"><figcaption><p><span class=figure-number>Figure 3: </span>Autoplot results</p></figcaption></figure><p>We can get some other plots as well, but we need our probabilities to be
returned.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1># For ROC curves</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lrnprob</span> <span class=o>=</span> <span class=nf>lrn</span><span class=p>(</span><span class=s>&#34;classif.log_reg&#34;</span><span class=p>,</span><span class=n>predict_type</span><span class=o>=</span><span class=s>&#34;prob&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>lrnprob</span><span class=o>$</span><span class=nf>train</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>lrnprob</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;roc&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-15-1.png alt="Figure 4: ROC curve"><figcaption><p><span class=figure-number>Figure 4: </span>ROC curve</p></figcaption></figure><h4 id=b-validation-sets-with-mlr3>b) Validation Sets with mlr3</h4><p>Though the question seems to require a manual validation set generation
and thresholding, we can simply use the defaults.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_set</span> <span class=o>=</span> <span class=nf>sample</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=o>$</span><span class=n>nrow</span><span class=p>,</span> <span class=m>0.8</span> <span class=o>*</span> <span class=n>tskLogiFull</span><span class=o>$</span><span class=n>nrow</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_set</span> <span class=o>=</span> <span class=nf>setdiff</span><span class=p>(</span><span class=nf>seq_len</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=o>$</span><span class=n>nrow</span><span class=p>),</span> <span class=n>train_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>learner</span><span class=o>$</span><span class=nf>train</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>,</span><span class=n>row_ids</span><span class=o>=</span><span class=n>train_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>confusionMatrix</span><span class=p>(</span><span class=n>learner</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>,</span> <span class=n>row_ids</span><span class=o>=</span><span class=n>test_set</span><span class=p>)</span><span class=o>$</span><span class=n>response</span><span class=p>,</span><span class=n>defDat[</span><span class=o>-</span><span class=n>train_set</span><span class=p>,</span><span class=n>]</span><span class=o>$</span><span class=n>default</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Confusion Matrix and Statistics
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>##           Reference
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Prediction   No  Yes
</span></span><span class=line><span class=ln> 5</span><span class=cl>##        No  1921   47
</span></span><span class=line><span class=ln> 6</span><span class=cl>##        Yes    9   23
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##                Accuracy : 0.972
</span></span><span class=line><span class=ln> 9</span><span class=cl>##                  95% CI : (0.9638, 0.9788)
</span></span><span class=line><span class=ln>10</span><span class=cl>##     No Information Rate : 0.965
</span></span><span class=line><span class=ln>11</span><span class=cl>##     P-Value [Acc &gt; NIR] : 0.04663
</span></span><span class=line><span class=ln>12</span><span class=cl>##
</span></span><span class=line><span class=ln>13</span><span class=cl>##                   Kappa : 0.4387
</span></span><span class=line><span class=ln>14</span><span class=cl>##
</span></span><span class=line><span class=ln>15</span><span class=cl>##  Mcnemar&#39;s Test P-Value : 7.641e-07
</span></span><span class=line><span class=ln>16</span><span class=cl>##
</span></span><span class=line><span class=ln>17</span><span class=cl>##             Sensitivity : 0.9953
</span></span><span class=line><span class=ln>18</span><span class=cl>##             Specificity : 0.3286
</span></span><span class=line><span class=ln>19</span><span class=cl>##          Pos Pred Value : 0.9761
</span></span><span class=line><span class=ln>20</span><span class=cl>##          Neg Pred Value : 0.7188
</span></span><span class=line><span class=ln>21</span><span class=cl>##              Prevalence : 0.9650
</span></span><span class=line><span class=ln>22</span><span class=cl>##          Detection Rate : 0.9605
</span></span><span class=line><span class=ln>23</span><span class=cl>##    Detection Prevalence : 0.9840
</span></span><span class=line><span class=ln>24</span><span class=cl>##       Balanced Accuracy : 0.6620
</span></span><span class=line><span class=ln>25</span><span class=cl>##
</span></span><span class=line><span class=ln>26</span><span class=cl>##        &#39;Positive&#39; Class : No
</span></span><span class=line><span class=ln>27</span><span class=cl>##
</span></span></code></pre></div><p>For a reasonable comparison, we will demonstrate a standard approach as
well. In this instance we will not use <code>caret</code> to ensure that our class
distribution in the train and test sets are not sampled to remain the
same.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>trainNoCaret</span><span class=o>&lt;-</span><span class=nf>sample</span><span class=p>(</span><span class=nf>nrow</span><span class=p>(</span><span class=n>defDat</span><span class=p>),</span> <span class=n>size</span> <span class=o>=</span> <span class=nf>floor</span><span class=p>(</span><span class=m>.8</span><span class=o>*</span><span class=nf>nrow</span><span class=p>(</span><span class=n>defDat</span><span class=p>)),</span> <span class=n>replace</span> <span class=o>=</span> <span class=bp>F</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>glm.fit</span><span class=o>=</span><span class=nf>glm</span><span class=p>(</span><span class=n>default</span><span class=o>~</span><span class=n>income</span><span class=o>+</span><span class=n>balance</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>defDat</span><span class=p>,</span><span class=n>family</span><span class=o>=</span><span class=n>binomial</span><span class=p>,</span><span class=n>subset</span><span class=o>=</span><span class=n>trainNoCaret</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>glm.probs</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>glm.fit</span><span class=p>,</span><span class=n>defDat[</span><span class=o>-</span><span class=n>trainNoCaret</span><span class=p>,</span><span class=n>]</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;response&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>glm.preds</span><span class=o>&lt;-</span><span class=nf>ifelse</span><span class=p>(</span><span class=n>glm.probs</span> <span class=o>&lt;</span> <span class=m>0.5</span><span class=p>,</span> <span class=s>&#34;No&#34;</span><span class=p>,</span> <span class=s>&#34;Yes&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>confusionMatrix</span><span class=p>(</span><span class=n>glm.preds</span> <span class=o>%&gt;%</span> <span class=n>factor</span><span class=p>,</span><span class=n>defDat[</span><span class=o>-</span><span class=n>trainNoCaret</span><span class=p>,</span><span class=n>]</span><span class=o>$</span><span class=n>default</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Confusion Matrix and Statistics
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>##           Reference
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Prediction   No  Yes
</span></span><span class=line><span class=ln> 5</span><span class=cl>##        No  1930   46
</span></span><span class=line><span class=ln> 6</span><span class=cl>##        Yes    6   18
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##                Accuracy : 0.974
</span></span><span class=line><span class=ln> 9</span><span class=cl>##                  95% CI : (0.966, 0.9805)
</span></span><span class=line><span class=ln>10</span><span class=cl>##     No Information Rate : 0.968
</span></span><span class=line><span class=ln>11</span><span class=cl>##     P-Value [Acc &gt; NIR] : 0.06859
</span></span><span class=line><span class=ln>12</span><span class=cl>##
</span></span><span class=line><span class=ln>13</span><span class=cl>##                   Kappa : 0.3986
</span></span><span class=line><span class=ln>14</span><span class=cl>##
</span></span><span class=line><span class=ln>15</span><span class=cl>##  Mcnemar&#39;s Test P-Value : 6.362e-08
</span></span><span class=line><span class=ln>16</span><span class=cl>##
</span></span><span class=line><span class=ln>17</span><span class=cl>##             Sensitivity : 0.9969
</span></span><span class=line><span class=ln>18</span><span class=cl>##             Specificity : 0.2812
</span></span><span class=line><span class=ln>19</span><span class=cl>##          Pos Pred Value : 0.9767
</span></span><span class=line><span class=ln>20</span><span class=cl>##          Neg Pred Value : 0.7500
</span></span><span class=line><span class=ln>21</span><span class=cl>##              Prevalence : 0.9680
</span></span><span class=line><span class=ln>22</span><span class=cl>##          Detection Rate : 0.9650
</span></span><span class=line><span class=ln>23</span><span class=cl>##    Detection Prevalence : 0.9880
</span></span><span class=line><span class=ln>24</span><span class=cl>##       Balanced Accuracy : 0.6391
</span></span><span class=line><span class=ln>25</span><span class=cl>##
</span></span><span class=line><span class=ln>26</span><span class=cl>##        &#39;Positive&#39; Class : No
</span></span><span class=line><span class=ln>27</span><span class=cl>##
</span></span></code></pre></div><p>Since the two approaches use different samples there is a little
variation, but we can see that the accuracy is essentially the same.</p><h4 id=c-3-fold-cross-validation>c) 3-fold cross validation</h4><p>As per the question, we can repeat the block above three times, or
extract it into a function which takes a seed value and run that three
times. Either way, here we will present the <code>mlr3</code> approach to cross
validation and resampling.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>rr</span> <span class=o>=</span> <span class=nf>resample</span><span class=p>(</span><span class=n>tskLogiFull</span><span class=p>,</span> <span class=n>lrnprob</span><span class=p>,</span> <span class=nf>rsmp</span><span class=p>(</span><span class=s>&#34;cv&#34;</span><span class=p>,</span> <span class=n>folds</span> <span class=o>=</span> <span class=m>3</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## INFO  [22:12:30.025] Applying learner &#39;classif.log_reg&#39; on task &#39;credit&#39; (iter 1/3)
</span></span><span class=line><span class=ln>2</span><span class=cl>## INFO  [22:12:30.212] Applying learner &#39;classif.log_reg&#39; on task &#39;credit&#39; (iter 2/3)
</span></span><span class=line><span class=ln>3</span><span class=cl>## INFO  [22:12:30.360] Applying learner &#39;classif.log_reg&#39; on task &#39;credit&#39; (iter 3/3)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>rr</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;roc&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-18-1.png alt="Figure 5: Resampled ROC curve"><figcaption><p><span class=figure-number>Figure 5: </span>Resampled ROC curve</p></figcaption></figure><p>We might want the average as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>rr</span><span class=o>$</span><span class=nf>aggregate</span><span class=p>(</span><span class=nf>msr</span><span class=p>(</span><span class=s>&#34;classif.ce&#34;</span><span class=p>))</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## classif.ce
</span></span><span class=line><span class=ln>2</span><span class=cl>## 0.02630035
</span></span></code></pre></div><h4 id=adding-student-as-a-dummy-variable>Adding Student as a dummy variable</h4><p>We will stick to the <code>mlr3</code> approach because it is faster.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>redDat2</span><span class=o>&lt;-</span><span class=n>defDat</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>student</span><span class=o>=</span><span class=nf>as.numeric</span><span class=p>(</span><span class=n>defDat</span><span class=o>$</span><span class=n>student</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>tskLogi2</span><span class=o>=</span><span class=n>TaskClassif</span><span class=o>$</span><span class=nf>new</span><span class=p>(</span><span class=n>id</span><span class=o>=</span><span class=s>&#34;credit&#34;</span><span class=p>,</span><span class=n>backend</span><span class=o>=</span><span class=n>redDat2</span><span class=p>,</span><span class=n>target</span><span class=o>=</span><span class=s>&#34;default&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>tskLogi2</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## &lt;TaskClassif:credit&gt; (10000 x 4)
</span></span><span class=line><span class=ln>2</span><span class=cl>## * Target: default
</span></span><span class=line><span class=ln>3</span><span class=cl>## * Properties: twoclass
</span></span><span class=line><span class=ln>4</span><span class=cl>## * Features (3):
</span></span><span class=line><span class=ln>5</span><span class=cl>##   - dbl (3): balance, income, student
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>tskLogi2</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;pairs&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span><span class=line><span class=ln>2</span><span class=cl>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span><span class=line><span class=ln>3</span><span class=cl>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-21-1.png alt="Figure 6: Logistic regression pairs data"><figcaption><p><span class=figure-number>Figure 6: </span>Logistic regression pairs data</p></figcaption></figure><p>This gives us a visual indicator and premonition that we might not be
getting incredible results with our new variable in the mix, but we
should still work it through.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>confusionMatrix</span><span class=p>(</span><span class=n>lrnprob</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogi2</span><span class=p>)</span><span class=o>$</span><span class=n>response</span><span class=p>,</span><span class=n>defDat</span><span class=o>$</span><span class=n>default</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Confusion Matrix and Statistics
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>##           Reference
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Prediction   No  Yes
</span></span><span class=line><span class=ln> 5</span><span class=cl>##        No  9629  225
</span></span><span class=line><span class=ln> 6</span><span class=cl>##        Yes   38  108
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##                Accuracy : 0.9737
</span></span><span class=line><span class=ln> 9</span><span class=cl>##                  95% CI : (0.9704, 0.9767)
</span></span><span class=line><span class=ln>10</span><span class=cl>##     No Information Rate : 0.9667
</span></span><span class=line><span class=ln>11</span><span class=cl>##     P-Value [Acc &gt; NIR] : 3.067e-05
</span></span><span class=line><span class=ln>12</span><span class=cl>##
</span></span><span class=line><span class=ln>13</span><span class=cl>##                   Kappa : 0.4396
</span></span><span class=line><span class=ln>14</span><span class=cl>##
</span></span><span class=line><span class=ln>15</span><span class=cl>##  Mcnemar&#39;s Test P-Value : &lt; 2.2e-16
</span></span><span class=line><span class=ln>16</span><span class=cl>##
</span></span><span class=line><span class=ln>17</span><span class=cl>##             Sensitivity : 0.9961
</span></span><span class=line><span class=ln>18</span><span class=cl>##             Specificity : 0.3243
</span></span><span class=line><span class=ln>19</span><span class=cl>##          Pos Pred Value : 0.9772
</span></span><span class=line><span class=ln>20</span><span class=cl>##          Neg Pred Value : 0.7397
</span></span><span class=line><span class=ln>21</span><span class=cl>##              Prevalence : 0.9667
</span></span><span class=line><span class=ln>22</span><span class=cl>##          Detection Rate : 0.9629
</span></span><span class=line><span class=ln>23</span><span class=cl>##    Detection Prevalence : 0.9854
</span></span><span class=line><span class=ln>24</span><span class=cl>##       Balanced Accuracy : 0.6602
</span></span><span class=line><span class=ln>25</span><span class=cl>##
</span></span><span class=line><span class=ln>26</span><span class=cl>##        &#39;Positive&#39; Class : No
</span></span><span class=line><span class=ln>27</span><span class=cl>##
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>lrnprob</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogi2</span><span class=p>))</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-23-1.png alt="Figure 7: Autoplot figure"><figcaption><p><span class=figure-number>Figure 7: </span>Autoplot figure</p></figcaption></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lrnprob</span><span class=o>$</span><span class=nf>train</span><span class=p>(</span><span class=n>tskLogi2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>autoplot</span><span class=p>(</span><span class=n>lrnprob</span><span class=o>$</span><span class=nf>predict</span><span class=p>(</span><span class=n>tskLogi2</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;roc&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-24-1.png alt="Figure 8: ROC plot"><figcaption><p><span class=figure-number>Figure 8: </span>ROC plot</p></figcaption></figure><p>Although we have slightly better accuracy with the new variable, it
needs to be compared to determine if it is worth further investigation.</p><p>With a three-fold validation approach,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=s>&#34;gridExtra&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##
</span></span><span class=line><span class=ln>2</span><span class=cl>## Attaching package: &#39;gridExtra&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## The following object is masked from &#39;package:dplyr&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##
</span></span><span class=line><span class=ln>3</span><span class=cl>##     combine
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>rr2</span> <span class=o>=</span> <span class=nf>resample</span><span class=p>(</span><span class=n>tskLogi2</span><span class=p>,</span> <span class=n>lrnprob</span><span class=p>,</span> <span class=nf>rsmp</span><span class=p>(</span><span class=s>&#34;cv&#34;</span><span class=p>,</span> <span class=n>folds</span> <span class=o>=</span> <span class=m>3</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## INFO  [22:12:39.670] Applying learner &#39;classif.log_reg&#39; on task &#39;credit&#39; (iter 1/3)
</span></span><span class=line><span class=ln>2</span><span class=cl>## INFO  [22:12:39.731] Applying learner &#39;classif.log_reg&#39; on task &#39;credit&#39; (iter 2/3)
</span></span><span class=line><span class=ln>3</span><span class=cl>## INFO  [22:12:39.780] Applying learner &#39;classif.log_reg&#39; on task &#39;credit&#39; (iter 3/3)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>wS</span><span class=o>&lt;-</span><span class=nf>autoplot</span><span class=p>(</span><span class=n>rr2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>nS</span><span class=o>&lt;-</span><span class=nf>autoplot</span><span class=p>(</span><span class=n>rr</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>grid.arrange</span><span class=p>(</span><span class=n>wS</span><span class=p>,</span><span class=n>nS</span><span class=p>,</span><span class=n>ncol</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>bottom</span><span class=o>=</span><span class=s>&#34;With student (left) and without (right)&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-25-1.png alt="Figure 9: Plot of accuracy"><figcaption><p><span class=figure-number>Figure 9: </span>Plot of accuracy</p></figcaption></figure><p>Given the results, it is fair to say that adding the student data is
useful in general.</p><h2 id=question-5.6---page-199>Question 5.6 - Page 199</h2><p>We continue to consider the use of a logistic regression model to
predict the probability of <code>default</code> using <code>income</code> and <code>balance</code> on the
<code>Default</code> data set. In particular, we will now compute estimates for the
standard errors of the <code>income</code> and <code>balance</code> logistic regression
coefficients in two different ways: (1) using the bootstrap, and (2)
using the standard formula for computing the standard errors in the
<code>glm()</code> function. Do not forget to set a random seed before beginning
your analysis.</p><p><strong>(a)</strong> Using the <code>summary()</code> and <code>glm()</code> functions, determine the
estimated standard errors for the coefficients associated with <code>income</code>
and <code>balance</code> in a multiple logistic regression model that uses both
predictors.</p><p><strong>(b)</strong> Write a function, <code>boot.fn()</code> , that takes as input the <code>Default</code>
data set as well as an index of the observations, and that outputs the
coefficient estimates for <code>income</code> and <code>balance</code> in the multiple
logistic regression model.</p><p><strong>(c)</strong> Use the <code>boot()</code> function together with your <code>boot.fn()</code> function
to estimate the standard errors of the logistic regression coefficients
for <code>income</code> and <code>balance</code>.</p><p><strong>(d)</strong> Comment on the estimated standard errors obtained using the
<code>glm()</code> function and using your bootstrap function.</p><h3 id=answer-1>Answer</h3><p>This question is slightly more specific to the packages in the book so
we will use them.</p><h4 id=a-fit-summary>a) Fit summary</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>glm.fit</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## glm(formula = default ~ income + balance, family = binomial,
</span></span><span class=line><span class=ln> 4</span><span class=cl>##     data = defDat, subset = trainNoCaret)
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Deviance Residuals:
</span></span><span class=line><span class=ln> 7</span><span class=cl>##     Min       1Q   Median       3Q      Max
</span></span><span class=line><span class=ln> 8</span><span class=cl>## -2.1943  -0.1488  -0.0588  -0.0217   3.7058
</span></span><span class=line><span class=ln> 9</span><span class=cl>##
</span></span><span class=line><span class=ln>10</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>11</span><span class=cl>##               Estimate Std. Error z value Pr(&gt;|z|)
</span></span><span class=line><span class=ln>12</span><span class=cl>## (Intercept) -1.150e+01  4.814e-01 -23.885  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>13</span><span class=cl>## income       2.288e-05  5.553e-06   4.121 3.78e-05 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## balance      5.593e-03  2.509e-04  22.295  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>15</span><span class=cl>## ---
</span></span><span class=line><span class=ln>16</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>17</span><span class=cl>##
</span></span><span class=line><span class=ln>18</span><span class=cl>## (Dispersion parameter for binomial family taken to be 1)
</span></span><span class=line><span class=ln>19</span><span class=cl>##
</span></span><span class=line><span class=ln>20</span><span class=cl>##     Null deviance: 2354.0  on 7999  degrees of freedom
</span></span><span class=line><span class=ln>21</span><span class=cl>## Residual deviance: 1283.6  on 7997  degrees of freedom
</span></span><span class=line><span class=ln>22</span><span class=cl>## AIC: 1289.6
</span></span><span class=line><span class=ln>23</span><span class=cl>##
</span></span><span class=line><span class=ln>24</span><span class=cl>## Number of Fisher Scoring iterations: 8
</span></span></code></pre></div><h4 id=b-function>b) Function</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boot.fn</span><span class=o>=</span><span class=nf>function</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=n>subs</span><span class=p>){</span><span class=nf>return</span><span class=p>(</span><span class=nf>coef</span><span class=p>(</span><span class=nf>glm</span><span class=p>(</span><span class=n>default</span><span class=o>~</span><span class=n>income</span><span class=o>+</span><span class=n>balance</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>family</span><span class=o>=</span><span class=n>binomial</span><span class=p>,</span><span class=n>subset</span><span class=o>=</span><span class=n>subs</span><span class=p>)))}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>boot.fn</span><span class=p>(</span><span class=n>defDat</span><span class=p>,</span><span class=n>train_set</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##   (Intercept)        income       balance
</span></span><span class=line><span class=ln>2</span><span class=cl>## -1.136824e+01  1.846153e-05  5.576468e-03
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>glm</span><span class=p>(</span><span class=n>default</span><span class=o>~</span><span class=n>income</span><span class=o>+</span><span class=n>balance</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>defDat</span><span class=p>,</span><span class=n>family</span><span class=o>=</span><span class=n>binomial</span><span class=p>,</span><span class=n>subset</span><span class=o>=</span><span class=n>train_set</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## glm(formula = default ~ income + balance, family = binomial,
</span></span><span class=line><span class=ln> 4</span><span class=cl>##     data = defDat, subset = train_set)
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Deviance Residuals:
</span></span><span class=line><span class=ln> 7</span><span class=cl>##     Min       1Q   Median       3Q      Max
</span></span><span class=line><span class=ln> 8</span><span class=cl>## -2.4280  -0.1465  -0.0582  -0.0218   3.7115
</span></span><span class=line><span class=ln> 9</span><span class=cl>##
</span></span><span class=line><span class=ln>10</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>11</span><span class=cl>##               Estimate Std. Error z value Pr(&gt;|z|)
</span></span><span class=line><span class=ln>12</span><span class=cl>## (Intercept) -1.137e+01  4.813e-01 -23.618  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>13</span><span class=cl>## income       1.846e-05  5.553e-06   3.324 0.000886 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## balance      5.576e-03  2.529e-04  22.046  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>15</span><span class=cl>## ---
</span></span><span class=line><span class=ln>16</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>17</span><span class=cl>##
</span></span><span class=line><span class=ln>18</span><span class=cl>## (Dispersion parameter for binomial family taken to be 1)
</span></span><span class=line><span class=ln>19</span><span class=cl>##
</span></span><span class=line><span class=ln>20</span><span class=cl>##     Null deviance: 2313.6  on 7999  degrees of freedom
</span></span><span class=line><span class=ln>21</span><span class=cl>## Residual deviance: 1266.4  on 7997  degrees of freedom
</span></span><span class=line><span class=ln>22</span><span class=cl>## AIC: 1272.4
</span></span><span class=line><span class=ln>23</span><span class=cl>##
</span></span><span class=line><span class=ln>24</span><span class=cl>## Number of Fisher Scoring iterations: 8
</span></span></code></pre></div><p>We see that the statistics obtained from both are the same.</p><h4 id=c-bootstrap>c) Bootstrap</h4><p>The old fashioned way. <code>R</code> is the resample rate, <code>boot.fn</code> is the
statistic used.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>boot</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##
</span></span><span class=line><span class=ln>2</span><span class=cl>## Attaching package: &#39;boot&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## The following object is masked from &#39;package:lattice&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##
</span></span><span class=line><span class=ln>3</span><span class=cl>##     melanoma
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>boot</span><span class=p>(</span><span class=n>defDat</span><span class=p>,</span><span class=n>boot.fn</span><span class=p>,</span><span class=n>R</span><span class=o>=</span><span class=m>184</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## ORDINARY NONPARAMETRIC BOOTSTRAP
</span></span><span class=line><span class=ln> 3</span><span class=cl>##
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 6</span><span class=cl>## boot(data = defDat, statistic = boot.fn, R = 184)
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Bootstrap Statistics :
</span></span><span class=line><span class=ln>10</span><span class=cl>##          original        bias     std. error
</span></span><span class=line><span class=ln>11</span><span class=cl>## t1* -1.154047e+01 -1.407368e-02 4.073453e-01
</span></span><span class=line><span class=ln>12</span><span class=cl>## t2*  2.080898e-05 -6.386634e-08 4.720109e-06
</span></span><span class=line><span class=ln>13</span><span class=cl>## t3*  5.647103e-03  1.350950e-05 2.111547e-04
</span></span></code></pre></div><h4 id=d-comparison>d) Comparison</h4><ul><li>Clearly, there is not much difference in the standard error estimates</li></ul><div class=verse><p>Var | Bootstrap | Summary |<br>| :&mdash;&mdash;&mdash;: | &mdash;&mdash;&mdash; |<br>Intercept | 4.428026e-01 | 4.883e-01 |<br>income | 2.797011e-06 | 5.548e-06 |<br>balance | 2.423002e-04 | 2.591e-04 |<br></p></div><h2 id=question-5.8---page-200>Question 5.8 - Page 200</h2><p>We will now perform cross-validation on a simulated data set. <strong>(a)</strong>
Generate a simulated data set as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=o>&gt;</span> <span class=n>set</span> <span class=nf>. seed </span><span class=p>(</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=o>&gt;</span> <span class=n>y</span> <span class=o>=</span> <span class=nf>rnorm </span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=o>&gt;</span> <span class=n>x</span> <span class=o>=</span> <span class=nf>rnorm </span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=o>&gt;</span> <span class=n>y</span> <span class=o>=</span><span class=n>x</span> <span class=m>-2</span><span class=n>\</span><span class=o>*</span> <span class=n>x</span> <span class=n>^2</span><span class=o>+</span> <span class=nf>rnorm </span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span></code></pre></div><p>In this data set, what is n and what is p? Write out the model used to
generate the data in equation form.</p><p><strong>(b)</strong> Create a scatterplot of \(X\) against \(Y\). Comment on what you find.</p><p><strong>(c)</strong> Set a random seed, and then compute the LOOCV errors that result
from fitting the following four models using least squares:</p><ol><li><p>\(Y=\beta_0+\beta_1X+\eta\)</p></li><li><p>\(Y=\beta_0+\beta_1X+\beta_2X^2+\eta\)</p></li><li><p>\(Y=\beta_0+\beta_1X+\beta_2X^2+\beta_{3}X^{3}+\eta\)</p></li><li><p>\(Y=\beta_0+\beta_1X+\beta_2X^2+\beta_{3}X^{3}+\beta_{4}X^{4}+\eta\)</p></li></ol><p>Note you may find it helpful to use the <code>data.frame()</code> function to
create a single data set containing both \(X\) and \(Y\).</p><p><strong>(d)</strong> Repeat (c) using another random seed, and report your results. Are
your results the same as what you got in (c)? Why?</p><p><strong>(e)</strong> Which of the models in (c) had the smallest LOOCV error? Is this
what you expected? Explain your answer.</p><p><strong>(f)</strong> Comment on the statistical significance of the coefficient esti-
mates that results from fitting each of the models in (c) using least
squares. Do these results agree with the conclusions drawn based on the
cross-validation results?</p><h3 id=answer-2>Answer</h3><h4 id=a-modeling-data>a) Modeling data</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>y</span> <span class=o>&lt;-</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>y</span> <span class=o>&lt;-</span> <span class=n>x</span> <span class=o>-</span> <span class=m>2</span><span class=o>*</span><span class=n>x^2</span> <span class=o>+</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span></code></pre></div><p>Clearly:</p><ul><li>Our equation is \(y=x-2x^{2}+\epsilon\) where \(epsilon\) is normally
distributed from 100 samples</li><li>We have \(n=100\) observations</li><li>\(p=2\) where \(p\) is the number of features</li></ul><h4 id=b-visual-inspection>b) Visual inspection</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>qplot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol3/unnamed-chunk-31-1.png alt="Figure 10: Model data plot"><figcaption><p><span class=figure-number>Figure 10: </span>Model data plot</p></figcaption></figure><p>We observe that the data is quadratic, as we also know from the
generating function, which was a quadratic equation plus normally
distributed noise.</p><h4 id=c-least-squares-fits>c) Least squares fits</h4><p>Not very important, but here we use the <code>caret</code> form.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pow</span><span class=o>=</span><span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>){</span><span class=nf>return</span><span class=p>(</span><span class=n>x^y</span><span class=p>)}</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>dfDat</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>x2</span><span class=o>=</span><span class=nf>pow</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>2</span><span class=p>),</span><span class=n>x3</span><span class=o>=</span><span class=nf>pow</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>3</span><span class=p>),</span><span class=n>x4</span><span class=o>=</span><span class=nf>pow</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>4</span><span class=p>))</span>
</span></span></code></pre></div><p>We might have also just used <code>poly(x,n)</code> to skip making the data frame.</p><p>We will set our resampling method as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>fitControl</span><span class=o>&lt;-</span><span class=nf>trainControl</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;LOOCV&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   1 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared    MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   2.427134  0.05389864  1.878566
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=o>+</span><span class=n>x2</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   2 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.042399  0.8032414  0.8029942
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=o>+</span><span class=n>x2</span><span class=o>+</span><span class=n>x3</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   3 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.050041  0.8003517  0.8073024
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=o>+</span><span class=n>x2</span><span class=o>+</span><span class=n>x3</span><span class=o>+</span><span class=n>x4</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   4 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.055828  0.7982111  0.8150296
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><h4 id=d-seeding-effects>d) Seeding effects</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>1995</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   1 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared    MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   2.427134  0.05389864  1.878566
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=o>+</span><span class=n>x2</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   2 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.042399  0.8032414  0.8029942
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=o>+</span><span class=n>x2</span><span class=o>+</span><span class=n>x3</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   3 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.050041  0.8003517  0.8073024
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=o>+</span><span class=n>x2</span><span class=o>+</span><span class=n>x3</span><span class=o>+</span><span class=n>x4</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span><span class=p>,</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   4 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.055828  0.7982111  0.8150296
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><p>We note that there is no change on varying the seed because LOOCV is
exhaustive and uses n folds for each observation.</p><h4 id=e-analysis>e) Analysis</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   1 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared    MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   2.427134  0.05389864  1.878566
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>2</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   1 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.042399  0.8032414  0.8029942
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>3</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   1 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.050041  0.8003517  0.8073024
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>4</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Linear Regression
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln> 4</span><span class=cl>##   1 predictor
</span></span><span class=line><span class=ln> 5</span><span class=cl>##
</span></span><span class=line><span class=ln> 6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Resampling: Leave-One-Out Cross-Validation
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Summary of sample sizes: 99, 99, 99, 99, 99, 99, ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Resampling results:
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##   RMSE      Rsquared   MAE
</span></span><span class=line><span class=ln>12</span><span class=cl>##   1.055828  0.7982111  0.8150296
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</span></span></code></pre></div><p>Clearly the quadratic polynomial has the lowest error, which makes sense
given how the data was generated.</p><h4 id=f-statistical-significance>f) Statistical significance</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>x</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##     Min      1Q  Median      3Q     Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -7.3469 -0.9275  0.8028  1.5608  4.3974
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##             Estimate Std. Error t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept)  -1.8185     0.2364  -7.692 1.14e-11 ***
</span></span><span class=line><span class=ln>12</span><span class=cl>## x             0.2430     0.2479   0.981    0.329
</span></span><span class=line><span class=ln>13</span><span class=cl>## ---
</span></span><span class=line><span class=ln>14</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>15</span><span class=cl>##
</span></span><span class=line><span class=ln>16</span><span class=cl>## Residual standard error: 2.362 on 98 degrees of freedom
</span></span><span class=line><span class=ln>17</span><span class=cl>## Multiple R-squared:  0.009717,   Adjusted R-squared:  -0.0003881
</span></span><span class=line><span class=ln>18</span><span class=cl>## F-statistic: 0.9616 on 1 and 98 DF,  p-value: 0.3292
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>2</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##      Min       1Q   Median       3Q      Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -2.89884 -0.53765  0.04135  0.61490  2.73607
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##               Estimate Std. Error t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept)    -1.8277     0.1032 -17.704   &lt;2e-16 ***
</span></span><span class=line><span class=ln>12</span><span class=cl>## `poly(x, 2)1`   2.3164     1.0324   2.244   0.0271 *
</span></span><span class=line><span class=ln>13</span><span class=cl>## `poly(x, 2)2` -21.0586     1.0324 -20.399   &lt;2e-16 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## ---
</span></span><span class=line><span class=ln>15</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>16</span><span class=cl>##
</span></span><span class=line><span class=ln>17</span><span class=cl>## Residual standard error: 1.032 on 97 degrees of freedom
</span></span><span class=line><span class=ln>18</span><span class=cl>## Multiple R-squared:  0.8128, Adjusted R-squared:  0.8089
</span></span><span class=line><span class=ln>19</span><span class=cl>## F-statistic: 210.6 on 2 and 97 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>3</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##      Min       1Q   Median       3Q      Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -2.87250 -0.53881  0.02862  0.59383  2.74350
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##               Estimate Std. Error t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept)    -1.8277     0.1037 -17.621   &lt;2e-16 ***
</span></span><span class=line><span class=ln>12</span><span class=cl>## `poly(x, 3)1`   2.3164     1.0372   2.233   0.0279 *
</span></span><span class=line><span class=ln>13</span><span class=cl>## `poly(x, 3)2` -21.0586     1.0372 -20.302   &lt;2e-16 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## `poly(x, 3)3`  -0.3048     1.0372  -0.294   0.7695
</span></span><span class=line><span class=ln>15</span><span class=cl>## ---
</span></span><span class=line><span class=ln>16</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>17</span><span class=cl>##
</span></span><span class=line><span class=ln>18</span><span class=cl>## Residual standard error: 1.037 on 96 degrees of freedom
</span></span><span class=line><span class=ln>19</span><span class=cl>## Multiple R-squared:  0.813,  Adjusted R-squared:  0.8071
</span></span><span class=line><span class=ln>20</span><span class=cl>## F-statistic: 139.1 on 3 and 96 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>4</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>dfDat</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>)),</span><span class=n>trControl</span><span class=o>=</span><span class=n>fitControl</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##     Min      1Q  Median      3Q     Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -2.8914 -0.5244  0.0749  0.5932  2.7796
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##               Estimate Std. Error t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept)    -1.8277     0.1041 -17.549   &lt;2e-16 ***
</span></span><span class=line><span class=ln>12</span><span class=cl>## `poly(x, 4)1`   2.3164     1.0415   2.224   0.0285 *
</span></span><span class=line><span class=ln>13</span><span class=cl>## `poly(x, 4)2` -21.0586     1.0415 -20.220   &lt;2e-16 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## `poly(x, 4)3`  -0.3048     1.0415  -0.293   0.7704
</span></span><span class=line><span class=ln>15</span><span class=cl>## `poly(x, 4)4`  -0.4926     1.0415  -0.473   0.6373
</span></span><span class=line><span class=ln>16</span><span class=cl>## ---
</span></span><span class=line><span class=ln>17</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>18</span><span class=cl>##
</span></span><span class=line><span class=ln>19</span><span class=cl>## Residual standard error: 1.041 on 95 degrees of freedom
</span></span><span class=line><span class=ln>20</span><span class=cl>## Multiple R-squared:  0.8134, Adjusted R-squared:  0.8055
</span></span><span class=line><span class=ln>21</span><span class=cl>## F-statistic: 103.5 on 4 and 95 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></div><ul><li>Clearly, the second order terms are the most significant, as expected</li></ul><h2 id=question-5.9---page-201>Question 5.9 - Page 201</h2><p>We will now consider the Boston housing data set, from the MASS library.</p><p><strong>(a)</strong> Based on this data set, provide an estimate for the population
mean of <code>medv</code>. Call this estimate \(\hat{\mu}\).</p><p><strong>(b)</strong> Provide an estimate of the standard error of \(\hat{\mu}\).
Interpret this result. <em>Hint: We can compute the standard error of the
sample mean by dividing the sample standard deviation by the square root
of the number of observations.</em></p><p><strong>(c)</strong> Now estimate the standard error of \(\hat{\mu}\) using the
bootstrap. How does this compare to your answer from (b)?</p><p><strong>(d)</strong> Based on your bootstrap estimate from (c), provide a 95 %
confidence interval for the mean of <code>medv</code>. Compare it to the results
obtained using <code>t.test(Boston\$medv)</code>. <em>Hint: You can approximate a 95 %
confidence interval using the formula
\([\hat{\mu} − 2SE(\hat{\mu}), \hat{\mu} + 2SE(\hat{\mu})]\).</em></p><p><strong>(e)</strong> Based on this data set, provide an estimate, \(\hat{\mu_{med}}\),
for the median value of <code>medv</code> in the population.</p><p><strong>(f)</strong> We now would like to estimate the standard error of \(\hat{\mu}\)
med. Unfortunately, there is no simple formula for computing the
standard error of the median. Instead, estimate the standard error of
the median using the bootstrap. Comment on your findings.</p><p><strong>(g)</strong> Based on this data set, provide an estimate for the tenth
percentile of <code>medv</code> in Boston suburbs. Call this quantity
\(\hat{\mu_{0.1}}\). (You can use the <code>quantile()</code> function.)</p><p><strong>(h)</strong> Use the bootstrap to estimate the standard error of
\(\hat{\mu_{0.1}}\). Comment on your findings.</p><h3 id=answer-3>Answer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>&lt;-</span><span class=n>MASS</span><span class=o>::</span><span class=n>Boston</span>
</span></span></code></pre></div><ul><li>Reminder</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##       crim                zn             indus            chas
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  1st Qu.: 0.08204   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000
</span></span><span class=line><span class=ln> 8</span><span class=cl>##       nox               rm             age              dis
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100
</span></span><span class=line><span class=ln>11</span><span class=cl>##  Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207
</span></span><span class=line><span class=ln>12</span><span class=cl>##  Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795
</span></span><span class=line><span class=ln>13</span><span class=cl>##  3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188
</span></span><span class=line><span class=ln>14</span><span class=cl>##  Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127
</span></span><span class=line><span class=ln>15</span><span class=cl>##       rad              tax           ptratio          black
</span></span><span class=line><span class=ln>16</span><span class=cl>##  Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32
</span></span><span class=line><span class=ln>17</span><span class=cl>##  1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38
</span></span><span class=line><span class=ln>18</span><span class=cl>##  Median : 5.000   Median :330.0   Median :19.05   Median :391.44
</span></span><span class=line><span class=ln>19</span><span class=cl>##  Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67
</span></span><span class=line><span class=ln>20</span><span class=cl>##  3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23
</span></span><span class=line><span class=ln>21</span><span class=cl>##  Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90
</span></span><span class=line><span class=ln>22</span><span class=cl>##      lstat            medv
</span></span><span class=line><span class=ln>23</span><span class=cl>##  Min.   : 1.73   Min.   : 5.00
</span></span><span class=line><span class=ln>24</span><span class=cl>##  1st Qu.: 6.95   1st Qu.:17.02
</span></span><span class=line><span class=ln>25</span><span class=cl>##  Median :11.36   Median :21.20
</span></span><span class=line><span class=ln>26</span><span class=cl>##  Mean   :12.65   Mean   :22.53
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3rd Qu.:16.95   3rd Qu.:25.00
</span></span><span class=line><span class=ln>28</span><span class=cl>##  Max.   :37.97   Max.   :50.00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    506 obs. of  14 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>##  $ black  : num  397 397 393 395 397 ...
</span></span><span class=line><span class=ln>14</span><span class=cl>##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
</span></span><span class=line><span class=ln>15</span><span class=cl>##  $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...
</span></span><span class=line><span class=ln>16</span><span class=cl>## NULL
</span></span></code></pre></div><h4 id=a-mean>a) Mean</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>muhat</span><span class=o>=</span><span class=n>boston</span><span class=o>$</span><span class=n>medv</span> <span class=o>%&gt;%</span> <span class=nf>mean</span><span class=p>()</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>muhat</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 22.53281
</span></span></code></pre></div><h4 id=b-standard-error>b) Standard error</h4><p>Recall that \(SE=\frac{SD}{\sqrt{N_{obs}}}\)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>$</span><span class=n>medv</span> <span class=o>%&gt;%</span> <span class=n>sd</span><span class=o>/</span><span class=p>(</span><span class=nf>nrow</span><span class=p>(</span><span class=n>boston</span><span class=p>)</span><span class=n>^0.5</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 22.49444
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 0.4088611
</span></span></code></pre></div><h4 id=c-bootstrap-estimate>c) Bootstrap estimate</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>boot</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>myMean</span><span class=o>&lt;-</span><span class=nf>function</span><span class=p>(</span><span class=n>frame</span><span class=p>,</span><span class=n>ind</span><span class=p>){</span><span class=nf>return</span><span class=p>(</span><span class=nf>mean</span><span class=p>(</span><span class=n>frame[ind]</span><span class=p>))}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>boot</span><span class=p>(</span><span class=n>boston</span><span class=o>$</span><span class=n>medv</span><span class=p>,</span><span class=n>myMean</span><span class=p>,</span><span class=n>R</span><span class=o>=</span><span class=m>184</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## ORDINARY NONPARAMETRIC BOOTSTRAP
</span></span><span class=line><span class=ln> 3</span><span class=cl>##
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 6</span><span class=cl>## boot(data = boston$medv, statistic = myMean, R = 184)
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Bootstrap Statistics :
</span></span><span class=line><span class=ln>10</span><span class=cl>##     original     bias    std. error
</span></span><span class=line><span class=ln>11</span><span class=cl>## t1* 22.53281 0.03451839    0.409621
</span></span></code></pre></div><p>We see that the bootstrapped error over 184 samples is <code>0.4341499</code> while
without it we had <code>0.4088611</code> which is similar enough.</p><h4 id=d-confidence-intervals-with-bootstrap-and-t.test>d) Confidence intervals with bootstrap and t.test</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>$</span><span class=n>medv</span> <span class=o>%&gt;%</span> <span class=n>t.test</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  One Sample t-test
</span></span><span class=line><span class=ln> 3</span><span class=cl>##
</span></span><span class=line><span class=ln> 4</span><span class=cl>## data:  .
</span></span><span class=line><span class=ln> 5</span><span class=cl>## t = 55.111, df = 505, p-value &lt; 2.2e-16
</span></span><span class=line><span class=ln> 6</span><span class=cl>## alternative hypothesis: true mean is not equal to 0
</span></span><span class=line><span class=ln> 7</span><span class=cl>## 95 percent confidence interval:
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  21.72953 23.33608
</span></span><span class=line><span class=ln> 9</span><span class=cl>## sample estimates:
</span></span><span class=line><span class=ln>10</span><span class=cl>## mean of x
</span></span><span class=line><span class=ln>11</span><span class=cl>##  22.53281
</span></span></code></pre></div><p>We can approximate this with what we already have</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>bRes</span><span class=o>=</span><span class=nf>boot</span><span class=p>(</span><span class=n>boston</span><span class=o>$</span><span class=n>medv</span><span class=p>,</span><span class=n>myMean</span><span class=p>,</span><span class=n>R</span><span class=o>=</span><span class=m>184</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>seBoot</span><span class=o>&lt;-</span><span class=n>bRes</span><span class=o>$</span><span class=n>t</span> <span class=o>%&gt;%</span> <span class=n>var</span> <span class=o>%&gt;%</span> <span class=n>sqrt</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>xlow</span><span class=o>=</span><span class=n>muhat</span><span class=m>-2</span><span class=o>*</span><span class=p>(</span><span class=n>seBoot</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>xhigh</span><span class=o>=</span><span class=n>muhat</span><span class=m>+2</span><span class=o>*</span><span class=p>(</span><span class=n>seBoot</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>c</span><span class=p>(</span><span class=n>xlow</span><span class=p>,</span><span class=n>xhigh</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 21.72675 23.33887
</span></span></code></pre></div><p>Our intervals are also pretty close to each other.</p><h4 id=e-median>e) Median</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>$</span><span class=n>medv</span> <span class=o>%&gt;%</span> <span class=n>sort</span> <span class=o>%&gt;%</span> <span class=n>median</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 21.2
</span></span></code></pre></div><h4 id=f-median-standard-error>f) Median standard error</h4><p>We can reuse the logic of the <code>myMean</code> function defined previously.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>myMedian</span><span class=o>=</span><span class=nf>function</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=n>ind</span><span class=p>){</span><span class=nf>return</span><span class=p>(</span><span class=nf>median</span><span class=p>(</span><span class=n>data[ind]</span><span class=p>))}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>$</span><span class=n>medv</span> <span class=o>%&gt;%</span> <span class=nf>boot</span><span class=p>(</span><span class=n>myMedian</span><span class=p>,</span><span class=n>R</span><span class=o>=</span><span class=m>1500</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## ORDINARY NONPARAMETRIC BOOTSTRAP
</span></span><span class=line><span class=ln> 3</span><span class=cl>##
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 6</span><span class=cl>## boot(data = ., statistic = myMedian, R = 1500)
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Bootstrap Statistics :
</span></span><span class=line><span class=ln>10</span><span class=cl>##     original      bias    std. error
</span></span><span class=line><span class=ln>11</span><span class=cl>## t1*     21.2 -0.03773333    0.387315
</span></span></code></pre></div><p>We see that the standard error is <code>0.3767072</code>.</p><h4 id=g-tenth-percentile>g) Tenth percentile</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>mu0one</span><span class=o>&lt;-</span><span class=n>boston</span><span class=o>$</span><span class=n>medv</span> <span class=o>%&gt;%</span> <span class=nf>quantile</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=m>0.1</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>mu0one</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##   10%
</span></span><span class=line><span class=ln>2</span><span class=cl>## 12.75
</span></span></code></pre></div><h4 id=h-bootstrap>h) Bootstrap</h4><p>Once again.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>myQuant</span><span class=o>=</span><span class=nf>function</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=n>ind</span><span class=p>){</span><span class=nf>return</span><span class=p>(</span><span class=nf>quantile</span><span class=p>(</span><span class=n>data[ind]</span><span class=p>,</span><span class=m>0.1</span><span class=p>))}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>$</span><span class=n>medv</span> <span class=o>%&gt;%</span> <span class=nf>boot</span><span class=p>(</span><span class=n>myQuant</span><span class=p>,</span><span class=n>R</span><span class=o>=</span><span class=m>500</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## ORDINARY NONPARAMETRIC BOOTSTRAP
</span></span><span class=line><span class=ln> 3</span><span class=cl>##
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 6</span><span class=cl>## boot(data = ., statistic = myQuant, R = 500)
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Bootstrap Statistics :
</span></span><span class=line><span class=ln>10</span><span class=cl>##     original  bias    std. error
</span></span><span class=line><span class=ln>11</span><span class=cl>## t1*    12.75 -0.0095   0.4951415
</span></span></code></pre></div><p>The standard error is <code>0.5024526</code></p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>James, G., Witten, D., Hastie, T., & Tibshirani, R. (2013). An
Introduction to Statistical Learning: with Applications in R.
Berlin, Germany: Springer Science & Business Media.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Lang et al., (2019). mlr3: A modern object-oriented machine
learning framework in R. Journal of Open Source Software, 4(44),
1903, <a href=https://doi.org/10.21105/joss.01903>https://doi.org/10.21105/joss.01903</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://rgoswami.me/tags/solutions>solutions</a></span><span class=tag><a href=https://rgoswami.me/tags/r>R</a></span><span class=tag><a href=https://rgoswami.me/tags/islr>ISLR</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>5182 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Posted: <time class=dt-published>2020-02-18 22:00 +0000</time></p><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch5%2f" target=_blank rel=noopener aria-label=Facebook><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15.84 9.5H13.5V8.48c0-.53.35-.65.6-.65h1.4v-2.3h-2.35c-2.3.0-2.65 1.7-2.65 2.8V9.5h-2v2h2v7h3v-7h2.1l.24-2z"/></svg></div>Facebook</div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=%22%20%20%22ISLR%20%3a%3a%20Resampling%20Methods%22%0a%20%20%22%20seems%20like%20an%20interesting%20read%20from%20%40rg0swami&url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch5%2f" target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3.0 1 .4 1.7 1.2 2.2-.5.0-1 0-1.2-.3.0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8.0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="12" cy="12" r="11.5"/></svg></div>Twitter</div></a><a class=resp-sharing-button__link href="mailto:?subject=%22%20%20%22ISLR%20%3a%3a%20Resampling%20Methods%22%0a%20%20%22%20seems%20interesting...&body=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch5%2f" target=_self rel=noopener aria-label=E-Mail><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 16c0 .8-.7 1.5-1.5 1.5H6c-.8.0-1.5-.7-1.5-1.5V8c0-.8.7-1.5 1.5-1.5h12c.8.0 1.5.7 1.5 1.5v8zm-2-7.5L12 13 6.5 8.5m11 6-4-2.5m-7 2.5 4-2.5"/><circle cx="12" cy="12" r="11.5"/></svg></div>E-Mail</div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch5%2f&title=%22%20%20%22ISLR%20%3a%3a%20Resampling%20Methods%22%0a%20%20%22%20seems%20interesting...&summary=%22%20%20%22ISLR%20%3a%3a%20Resampling%20Methods%22%0a%20%20%22%20seems%20interesting...&source=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch5%2f" target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15 12.5c-.28.0-.5.22-.5.5v3.5h-3s.03-6.48.0-7h3v.83s.46-.75 1.7-.75c1.56.0 2.3 1.12 2.3 3.3v3.62h-3V13c0-.28-.23-.5-.5-.5zm-7.5-3h2v7h-2z"/><circle cx="8.5" cy="6.5" r="1"/></svg></div>LinkedIn</div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch5%2f&resubmit=true&title=%22%20%20%22ISLR%20%3a%3a%20Resampling%20Methods%22%0a%20%20%22%20seems%20interesting..." target=_blank rel=noopener aria-label=Reddit><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><ellipse cx="12" cy="14.37" rx="6.2" ry="4.24"/><path d="M14.3 16.25c-.62.36-1.42.57-2.3.57s-1.7-.2-2.32-.58"/><circle cx="14.61" cy="13.39" r=".98"/><circle cx="9.39" cy="13.39" r=".98"/><path d="M16.4 11.38c.26-.55.82-.92 1.47-.92.9.0 1.63.73 1.63 1.63.0.8-.6 1.47-1.38 1.6"/><circle cx="17.22" cy="7.52" r="1.63"/><path d="M7.6 11.38c-.26-.54-.82-.92-1.47-.92-.9.0-1.63.73-1.63 1.63.0.8.6 1.47 1.38 1.6M12 10.12s-.08-4.82 3.6-2.6"/></svg></div>Reddit</div></a><a class=resp-sharing-button__link href="whatsapp://send?text=%22%20%20%22ISLR%20%3a%3a%20Resampling%20Methods%22%0a%20%20%22%20seems%20interesting...%20https%3a%2f%2frgoswami.me%2fposts%2fislr-ch5%2f" target=_blank rel=noopener aria-label=WhatsApp><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle xmlns="http://www.w3.org/2000/svg" cx="12" cy="12" r="11.5"/><path stroke-width="1" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3.0-7.8 3.5-7.8 7.8.0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4.9 3.7.9 4.3.0 7.8-3.5 7.8-7.8.1-2-.7-3.9-2.2-5.4zm-5.5 11.9c-1.2.0-2.3-.3-3.3-.9l-.2-.1-2.4.6.7-2.4-.2-.2c-.6-1-1-2.2-1-3.4.0-3.6 2.9-6.5 6.5-6.5 1.7.0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.4-6.6 6.4zm3.5-4.8c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1s-.5.6-.6.8c-.1.1-.2.1-.4.0s-.8-.3-1.6-1c-.6-.5-1-1.2-1.1-1.3-.1-.2.0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.0-.2.0-.3s-.4-1.1-.6-1.4c-.2-.4-.3-.3-.4-.3h-.4s-.3.0-.5.2-.7.7-.7 1.6c0 1 .7 1.9.8 2s1.4 2.1 3.3 2.9c.5.2.8.3 1.1.4.5.1.9.1 1.2.1.4-.1 1.1-.5 1.3-.9.2-.5.2-.8.1-.9.0-.2-.2-.3-.4-.4z"/></svg></div>WhatsApp</div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://rgoswami.me/posts/islr-ch6/><span class=button__icon>←</span>
<span class=button__text>"ISLR :: Linear Model Selection and Regularization"</span></a></span>
<span class="button next"><a href=https://rgoswami.me/posts/islr-ch4/><span class=button__text>"ISLR :: Classification"</span>
<span class=button__icon>→</span></a></span></div></div><div id=comments class=thin><div class=pagination__title><span class=pagination__title-h>Comments</span><hr></div><script src=https://utteranc.es/client.js repo=haozeke/haozeke.github.io issue-term=pathname theme=photon-dark label="Utterance 💬" crossorigin=anonymous async></script></div></main><footer class=footer><p>&copy; 2022
<span><a href=https://rgoswami.me/>Rohit Goswami (HaoZeke)</a></span>
<a href=https://rgoswami.me/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a><br><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br><script src=https://liberapay.com/rohit/widgets/button.js></script><noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript></p></footer></div><script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script>
<script>(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-109503488-16","auto"),ga("send","pageview")</script><script type=text/javascript>(function(e,o,t,i,a,n,s){e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},n=o.createElement(i),n.async=1,n.src="https://www.clarity.ms/tag/"+a,s=o.getElementsByTagName(i)[0],s.parentNode.insertBefore(n,s)})(window,document,"clarity","script","3z2xvwqu4u")</script><script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script><script async src=https://static.getclicky.com/js></script>
<script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script>
<script src=/js/codefold.min.d0515ab08b3615633a8e8628e085c3c753ffc806b6d58bc2221083be6e9ab17a7a86ac9b4fc772c93a44f5d665dc13e87de3bc389b27c736e2a6a46e0df12f9c.js></script></body></html>