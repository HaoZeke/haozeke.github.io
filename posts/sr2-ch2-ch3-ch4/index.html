<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content="[Rohit Goswami]">
<meta name=description content="Setup details are described here, and the meta-post about these solutions is here.
 Materials The summmer course1 is based off of the second edition of Statistical Rethinking by Richard McElreath. This post covers the following exercise questions:
 Chapter 2  Easy {1,2,3,4} Medium {1,2,4}   Chapter 3  Easy {1,2,3,4,5} Medium {1,2,3,4,6}   Chapter 4  Easy {1,2,3,4,5} Medium {1,2,3,4,5,6,7}    Packages libsUsed&amp;lt;-c(&amp;#34;tidyverse&amp;#34;,&amp;#34;tidybayes&amp;#34;,&amp;#34;orgutils&amp;#34;, &amp;#34;rethinking&amp;#34;,&amp;#34;tidybayes.">
<meta name=keywords content=",solutions,R,SR2">
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=https://rgoswami.me/posts/sr2-ch2-ch3-ch4/>
<title>
SR2 :: Solutions for Chapters {2,3,4} :: Rohit Goswami — Reflections
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=/main.min.b6dbce0fdf6c61563a0c2226e857d5dadd8e5afa2c4f73ec9ea55abd831f9a72.css>
<meta itemprop=name content="SR2 :: Solutions for Chapters {2,3,4}">
<meta itemprop=description content="Setup details are described here, and the meta-post about these solutions is here.
 Materials The summmer course1 is based off of the second edition of Statistical Rethinking by Richard McElreath. This post covers the following exercise questions:
 Chapter 2  Easy {1,2,3,4} Medium {1,2,4}   Chapter 3  Easy {1,2,3,4,5} Medium {1,2,3,4,6}   Chapter 4  Easy {1,2,3,4,5} Medium {1,2,3,4,5,6,7}    Packages libsUsed<-c(&#34;tidyverse&#34;,&#34;tidybayes&#34;,&#34;orgutils&#34;, &#34;rethinking&#34;,&#34;tidybayes."><meta itemprop=datePublished content="2020-06-07T00:00:00+00:00">
<meta itemprop=dateModified content="2020-06-07T00:00:00+00:00">
<meta itemprop=wordCount content="3661"><meta itemprop=image content="https://rgoswami.me/images/RG.png">
<meta itemprop=keywords content="solutions,R,SR2,"><meta property="og:title" content="SR2 :: Solutions for Chapters {2,3,4}">
<meta property="og:description" content="Setup details are described here, and the meta-post about these solutions is here.
 Materials The summmer course1 is based off of the second edition of Statistical Rethinking by Richard McElreath. This post covers the following exercise questions:
 Chapter 2  Easy {1,2,3,4} Medium {1,2,4}   Chapter 3  Easy {1,2,3,4,5} Medium {1,2,3,4,6}   Chapter 4  Easy {1,2,3,4,5} Medium {1,2,3,4,5,6,7}    Packages libsUsed<-c(&#34;tidyverse&#34;,&#34;tidybayes&#34;,&#34;orgutils&#34;, &#34;rethinking&#34;,&#34;tidybayes.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://rgoswami.me/posts/sr2-ch2-ch3-ch4/"><meta property="og:image" content="https://rgoswami.me/images/RG.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-06-07T00:00:00+00:00">
<meta property="article:modified_time" content="2020-06-07T00:00:00+00:00"><meta property="og:site_name" content="Rohit Goswami">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://rgoswami.me/images/RG.png">
<meta name=twitter:title content="SR2 :: Solutions for Chapters {2,3,4}">
<meta name=twitter:description content="Setup details are described here, and the meta-post about these solutions is here.
 Materials The summmer course1 is based off of the second edition of Statistical Rethinking by Richard McElreath. This post covers the following exercise questions:
 Chapter 2  Easy {1,2,3,4} Medium {1,2,4}   Chapter 3  Easy {1,2,3,4,5} Medium {1,2,3,4,6}   Chapter 4  Easy {1,2,3,4,5} Medium {1,2,3,4,5,6,7}    Packages libsUsed<-c(&#34;tidyverse&#34;,&#34;tidybayes&#34;,&#34;orgutils&#34;, &#34;rethinking&#34;,&#34;tidybayes.">
<meta property="article:section" content="programming">
<meta property="article:published_time" content="2020-06-07 00:00:00 +0000 UTC">
</head>
<body>
<div class=container>
<header class=header>
<div class=header__inner>
<div class=header__left>
<div class=logo>
<a href=/ style=text-decoration:none>
<img src=/images/home.png alt>
</a>
</div>
</div>
<div class=header__mid>
<button class=button>
<div class=button__text>
<a href=https://rgoswami.me//search>
Search
</a>
</div>
</button>
</div>
<div class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=https://rgoswami.me/about>About</a></li><li><a href=https://rgoswami.me/posts>Blog</a></li>
</ul>
<ul class=menu__inner><li><a href=https://rgoswami.me/categories>Categories</a></li><li><a href=https://rgoswami.me/tags>Tags</a></li>
</ul>
</nav>
<button id=toggleMenu>
<div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</div>
</button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</button>
</div>
</div>
</header>
<script src=https://rgoswami.me/js/mathjax-config.js></script>
<script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script>
<aside class=sidebar>
<div class=hideTOC>
<button id=tocTog>TOC</button>
<div class="sideTOC m-fadeOut">
<nav id=TableOfContents>
<ul>
<li><a href=#materials>Materials</a>
<ul>
<li><a href=#packages>Packages</a></li>
</ul>
</li>
<li><a href=#chapter-ii-the-golem-of-prague>Chapter II: The Golem of Prague</a>
<ul>
<li><a href=#easy-questions--ch2>Easy Questions (Ch2)</a></li>
<li><a href=#questions-of-medium-complexity--ch2>Questions of Medium Complexity (Ch2)</a></li>
</ul>
</li>
<li><a href=#chapter-iii-sampling-the-imaginary>Chapter III: Sampling the Imaginary</a>
<ul>
<li><a href=#easy-questions--ch3>Easy Questions (Ch3)</a></li>
<li><a href=#questions-of-medium-complexity--ch3>Questions of Medium Complexity (Ch3)</a></li>
</ul>
</li>
<li><a href=#chapter-iv-geocentric-models>Chapter IV: Geocentric Models</a>
<ul>
<li><a href=#easy-questions--ch4>Easy Questions (Ch4)</a></li>
<li><a href=#questions-of-medium-complexity--ch4>Questions of Medium Complexity (Ch4)</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</aside>
<main class=post>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>18 minutes
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Written: 2020-06-07 00:00 +0000</p>
</p>
</div>
<article class=h-entry>
<h1 class="post-title p-name">
<a class=u-url href=https://rgoswami.me/posts/sr2-ch2-ch3-ch4/>SR2 :: Solutions for Chapters {2,3,4}</a>
</h1>
<div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pen-tool"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg>
<span class="author u-author p-author"><a href=https://rgoswami.me/author/rohit-goswami>Rohit Goswami</a></span>
</div>
<hr>
<aside id=toc class=sidebar>
<div class=toc-title>Table of Contents</div>
<nav id=TableOfContents>
<ul>
<li><a href=#materials>Materials</a>
<ul>
<li><a href=#packages>Packages</a></li>
</ul>
</li>
<li><a href=#chapter-ii-the-golem-of-prague>Chapter II: The Golem of Prague</a>
<ul>
<li><a href=#easy-questions--ch2>Easy Questions (Ch2)</a></li>
<li><a href=#questions-of-medium-complexity--ch2>Questions of Medium Complexity (Ch2)</a></li>
</ul>
</li>
<li><a href=#chapter-iii-sampling-the-imaginary>Chapter III: Sampling the Imaginary</a>
<ul>
<li><a href=#easy-questions--ch3>Easy Questions (Ch3)</a></li>
<li><a href=#questions-of-medium-complexity--ch3>Questions of Medium Complexity (Ch3)</a></li>
</ul>
</li>
<li><a href=#chapter-iv-geocentric-models>Chapter IV: Geocentric Models</a>
<ul>
<li><a href=#easy-questions--ch4>Easy Questions (Ch4)</a></li>
<li><a href=#questions-of-medium-complexity--ch4>Questions of Medium Complexity (Ch4)</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
<hr>
<div class="post-content e-content">
<blockquote>
<p>Setup details <a href=https://rgoswami.me/posts/rethinking-r-nix/>are described here</a>, and the meta-post about these solutions <a href=https://rgoswami.me/posts/some-sol-sr2/>is here</a>.</p>
</blockquote>
<h2 id=materials>Materials</h2>
<p>The <a href="https://ugla.hi.is/kennsluskra/index.php?sid=&tab=nam&chapter=namskeid&id=71055920203">summmer course</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> is based off of <a href=https://xcelab.net/rm/statistical-rethinking/>the second edition of
Statistical Rethinking</a> by <a href=https://twitter.com/rlmcelreath>Richard McElreath</a>.
This post covers the following exercise questions:</p>
<ul>
<li><input checked disabled type=checkbox> Chapter 2
<ul>
<li><input checked disabled type=checkbox> Easy {1,2,3,4}</li>
<li><input checked disabled type=checkbox> Medium {1,2,4}</li>
</ul>
</li>
<li><input checked disabled type=checkbox> Chapter 3
<ul>
<li><input checked disabled type=checkbox> Easy {1,2,3,4,5}</li>
<li><input checked disabled type=checkbox> Medium {1,2,3,4,6}</li>
</ul>
</li>
<li><input checked disabled type=checkbox> Chapter 4
<ul>
<li><input checked disabled type=checkbox> Easy {1,2,3,4,5}</li>
<li><input checked disabled type=checkbox> Medium {1,2,3,4,5,6,7}</li>
</ul>
</li>
</ul>
<h3 id=packages>Packages</h3>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>libsUsed</span><span class=o>&lt;-</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;tidyverse&#34;</span><span class=p>,</span><span class=s>&#34;tidybayes&#34;</span><span class=p>,</span><span class=s>&#34;orgutils&#34;</span><span class=p>,</span>
            <span class=s>&#34;rethinking&#34;</span><span class=p>,</span><span class=s>&#34;tidybayes.rethinking&#34;</span><span class=p>,</span>
            <span class=s>&#34;ggplot2&#34;</span><span class=p>,</span><span class=s>&#34;kableExtra&#34;</span><span class=p>,</span><span class=s>&#34;dplyr&#34;</span><span class=p>,</span><span class=s>&#34;glue&#34;</span><span class=p>,</span>
            <span class=s>&#34;latex2exp&#34;</span><span class=p>,</span><span class=s>&#34;data.table&#34;</span><span class=p>,</span><span class=s>&#34;printr&#34;</span><span class=p>)</span>
<span class=nf>invisible</span><span class=p>(</span><span class=nf>lapply</span><span class=p>(</span><span class=n>libsUsed</span><span class=p>,</span> <span class=n>library</span><span class=p>,</span> <span class=n>character.only</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>));</span>
</code></pre></div><p>We also set the following theme parameters for the plots.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>theme_set</span><span class=p>(</span><span class=nf>theme_grey</span><span class=p>(</span><span class=n>base_size</span><span class=o>=</span><span class=m>24</span><span class=p>))</span>
</code></pre></div><h2 id=chapter-ii-the-golem-of-prague>Chapter II: The Golem of Prague</h2>
<h3 id=easy-questions--ch2>Easy Questions (Ch2)</h3>
<h4 id=e1>2E1</h4>
<p>Which of the expressions below correspond to the statement: /the
probability of rain on Monday?</p>
<ol>
<li>Pr(rain)</li>
<li>Pr(rain|Monday)</li>
<li>Pr(Monday|rain)</li>
<li>Pr(rain, Monday)/Pr(Monday)</li>
</ol>
<h5 id=solution>Solution</h5>
<p>We can read each of these sentences as follows:</p>
<dl>
<dt>Pr(rain)</dt>
<dd>Probability of rain</dd>
<dt>Pr(rain|Monday)</dt>
<dd>Probability of rain given that it is Monday, or probability that it rains on Monday</dd>
<dt>Pr(Monday|rain)</dt>
<dd>Probability of being a Monday given that it rains</dd>
<dt>Pr(rain,Monday)/Pr(Monday)</dt>
<dd>Compound statement</dd>
</dl>
<p>We further note that we can express the joint probability of 4. to be equivalent to the probability written in 2.</p>
<p>Hence the correct solutions are <strong>options 2 and 4</strong>.</p>
<h4 id=e2>2E2</h4>
<p>Which of the following statements corresponds to the expression:
<em>Pr(Monday|rain)?</em></p>
<ol>
<li>The probability of rain on Monday.</li>
<li>The probability of rain, given that it is Monday.</li>
<li>The probability that it is Monday, given that it is raining.</li>
<li>The probability that it is Monday and that it is raining.</li>
</ol>
<h5 id=solution>Solution</h5>
<p>Using the same logic as described previously we note that the sentences
correspond to the following formulations:</p>
<dl>
<dt>Pr(rain,Monday)</dt>
<dd>The probability of rain on Monday.</dd>
<dt>Pr(rain|Monday)</dt>
<dd>The probability of rain, given that it is Monday.</dd>
<dt>Pr(Monday|rain)</dt>
<dd>The probability that it is Monday, given that it is raining.</dd>
<dt>Pr(Monday,rain)</dt>
<dd>The probability that it is Monday and that it is raining.
<p>Hence <strong>only option 3</strong> is correct.</p>
</dd>
</dl>
<h4 id=e3>2E3</h4>
<p>Which of the expressions below correspond to the statement: <em>the
probability that it is Monday, given that it is raining?</em></p>
<ol>
<li>Pr(Monday|rain)</li>
<li>Pr(rain|Monday)</li>
<li>Pr(rain|Monday)Pr(Monday)</li>
<li>Pr(rain|Monday)Pr(Monday)/Pr(rain)</li>
<li>Pr(Monday|rain)Pr(rain)/Pr(Monday)</li>
</ol>
<h5 id=solution>Solution</h5>
<p>We will simplify these slightly.</p>
<p>Hence the correct solutions are <strong>options 1 and 4</strong>.</p>
<h4 id=e4>2E4</h4>
<p>The Bayesian statistician Bruno de Finetti (1906&ndash;1985) began his 1973
book on probability theory with the declaration: &ldquo;PROBABILITY DOES NOT
EXIST.&rdquo; The capitals appeared in the original, so I imagine de Finetti
wanted us to shout this statement. What he meant is that probability is
a device for describing uncertainty from the perspective of an observer
with limited knowledge; it has no objective reality. Discuss the globe
tossing example from the chapter, in light of this statement. What does
it mean to say &ldquo;the probability of water is 0.7&rdquo;?</p>
<h5 id=solution>Solution</h5>
<p>The de Finetti school of thought subscribed to the belief that all processes
were deterministic and therefore did not have any inherent probabilitic
interpretation. With this framework, uncertainty did not have any physical
realization, and so the random effects of a process could be accounted for
entirely in terms of aleatoric and epistemic uncertainity without needing to
consider the fact that in some processes (not discovered then) like quantum
mechanics, random effects are part of the physical system, and are not due to a
lack of information. Under this assumption, the entirity of probability is
simply an numerical artifact with which the lack of information about a process
could be expressed. Thus the statement &ldquo;the probability of water is 0.7&rdquo; would
mean that the observable is 0.7, i.e., it would express the partial knowledge of
the observer, and not have any bearing on the (presumably fully deterministic)
underlying process which is a (presumed) exact function of angular momentum, and
other exact classical properties.</p>
<h3 id=questions-of-medium-complexity--ch2>Questions of Medium Complexity (Ch2)</h3>
<h4 id=m1>2M1</h4>
<p>Recall the globe tossing model from the chapter. Compute and plot the
grid approximate posterior distribution for each of the following sets
of observations. In each case, assume a uniform prior for \(p\).</p>
<ol>
<li>W, W, W</li>
<li>W, W, W, L</li>
<li>L, W, W, L, W, W, W</li>
</ol>
<h5 id=solution>Solution</h5>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nPoints</span><span class=o>&lt;-</span><span class=m>50</span>
<span class=c1># Grid</span>
<span class=n>pGrid</span><span class=o>&lt;-</span><span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=n>nPoints</span><span class=p>)</span>
<span class=c1># Prior</span>
<span class=n>prior</span><span class=o>&lt;-</span><span class=nf>rep</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=n>nPoints</span><span class=p>)</span>
<span class=c1># Likelihood for each grid point</span>
<span class=n>likelihood</span><span class=o>&lt;-</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>3</span><span class=p>,</span><span class=m>3</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span>
<span class=n>noStdPosterior</span><span class=o>&lt;-</span><span class=n>likelihood</span><span class=o>*</span><span class=n>prior</span>
<span class=c1># Posterior</span>
<span class=n>posterior</span><span class=o>&lt;-</span> <span class=n>noStdPosterior</span> <span class=o>/</span> <span class=nf>sum</span><span class=p>(</span><span class=n>noStdPosterior</span><span class=p>)</span>
</code></pre></div><p>Now we can visualize this.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span><span class=n>posterior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>pGrid</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>posterior</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Globe Tosses&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;2M1.1)W W W&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Posterior&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Grid Approximation points&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>),</span>
                     <span class=n>labels</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sprintf</span><span class=p>(</span><span class=s>&#34;%.2f&#34;</span><span class=p>,</span><span class=n>.)</span><span class=p>,</span>
                     <span class=n>expand</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span><span class=p>,</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/globeWWW.png>
</figure>
<p>For the remaining parts we will use a more abbreviated solution.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>3</span><span class=p>,</span><span class=m>4</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>post2unstd</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>posterior</span><span class=o>=</span><span class=n>post2unstd</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>post2unstd</span><span class=p>))</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>pGrid</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>posterior</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Globe Tosses&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;2M1.2) W W W L&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Posterior&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Grid Approximation points&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>),</span>
                     <span class=n>labels</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sprintf</span><span class=p>(</span><span class=s>&#34;%.2f&#34;</span><span class=p>,</span><span class=n>.)</span><span class=p>,</span>
                     <span class=n>expand</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/globeWWWL.png>
</figure>
<p>For the final part, note that since the observations are independent, the
ordering is irrelevant.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>5</span><span class=p>,</span><span class=m>7</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>post2unstd</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>posterior</span><span class=o>=</span><span class=n>post2unstd</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>post2unstd</span><span class=p>))</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>pGrid</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>posterior</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Globe Tosses&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;2M1.2) L W W L W W W&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Posterior&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Grid Approximation points&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>),</span>
                     <span class=n>labels</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sprintf</span><span class=p>(</span><span class=s>&#34;%.2f&#34;</span><span class=p>,</span><span class=n>.)</span><span class=p>,</span>
                     <span class=n>expand</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/globeW5L7.png>
</figure>
<h4 id=m2>2M2</h4>
<p>Now assume a prior for \(p\) that is equal to zero when \(p &lt; 0.5\) and is a
positive constant when \(p\geq 0.5\). Again compute and plot the grid
approximate posterior distribution for each of the sets of observations
in the problem just above.</p>
<ol>
<li>W, W, W</li>
<li>W, W, W, L</li>
<li>L, W, W, L, W, W, W</li>
</ol>
<h5 id=solution>Solution</h5>
<p>We proceed in much the same way as in the previous question. We also use the vectorized <code>ifelse</code> instead of explicitly using a <code>for</code> loop.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nPoints</span><span class=o>&lt;-</span><span class=m>50</span>
<span class=c1>## Grid</span>
<span class=n>pGrid</span><span class=o>&lt;-</span><span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=n>nPoints</span><span class=p>)</span>
<span class=c1>## Prior</span>
<span class=n>prior</span><span class=o>&lt;-</span><span class=nf>ifelse</span><span class=p>(</span><span class=n>pGrid</span><span class=o>&lt;</span><span class=m>0.5</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>3</span><span class=p>,</span><span class=m>3</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>post2unstd</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>posterior</span><span class=o>=</span><span class=n>post2unstd</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>post2unstd</span><span class=p>))</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>pGrid</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>posterior</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Globe Tosses with Prior information&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;2M2.1) W W W&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Posterior&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Grid Approximation points&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>),</span>
                     <span class=n>labels</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sprintf</span><span class=p>(</span><span class=s>&#34;%.2f&#34;</span><span class=p>,</span><span class=n>.)</span><span class=p>,</span>
                     <span class=n>expand</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/globeW3P.png>
</figure>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>3</span><span class=p>,</span><span class=m>4</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>post2unstd</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>posterior</span><span class=o>=</span><span class=n>post2unstd</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>post2unstd</span><span class=p>))</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>pGrid</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>posterior</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Globe Tosses with Prior information&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;2M2.2) W W W L&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Posterior&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Grid Approximation points&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>),</span>
                     <span class=n>labels</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sprintf</span><span class=p>(</span><span class=s>&#34;%.2f&#34;</span><span class=p>,</span><span class=n>.)</span><span class=p>,</span>
                     <span class=n>expand</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/2m2globeW3L1P.png>
</figure>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>5</span><span class=p>,</span><span class=m>7</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>post2unstd</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>posterior</span><span class=o>=</span><span class=n>post2unstd</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>post2unstd</span><span class=p>))</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>pGrid</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>posterior</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Globe Tosses with Prior information&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;2M2.3) L W W L W W W&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Posterior&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Grid Approximation points&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>),</span>
                     <span class=n>labels</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sprintf</span><span class=p>(</span><span class=s>&#34;%.2f&#34;</span><span class=p>,</span><span class=n>.)</span><span class=p>,</span>
                     <span class=n>expand</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/2m3globeW5L2P.png>
</figure>
<h4 id=m4>2M4</h4>
<p>Suppose you have a deck with only three cards. Each card has two sides,
and each side is either black or white. One card has two black sides.
The second card has one black and one white side. The third card has two
white sides. Now suppose all three cards are placed in a bag and
shuffled. Someone reaches into the bag and pulls out a card and places
it flat on a table. A black side is shown facing up, but you don&rsquo;t know
the color of the side facing down. Show that the probability that the
other side is also black is 2/3. Use the counting method (Section 2 of
this chapter) to approach this problem. This means counting up the ways
that each card could produce the observed data (a black side facing up
on the table).</p>
<h5 id=solution>Solution</h5>
<p>Let us begin by defining what is given to us.</p>
<ul>
<li>There are three cards
<ul>
<li>One has a black side and a white side (cBW)</li>
<li>One is colored black on both sides (cBB)</li>
<li>One is colored white on both sides (cWW)</li>
</ul>
</li>
</ul>
<p>Our total probability universe is defined by all possible states defined by the
enumeration of possible states for each card and their combinations. In other
words, it is a universe defined by color and the number of cards.</p>
<p>The question posed is essentially, given a single observation, that is that a
random draw from our universe has produced a black side (note that we already
know that there is one card so it satisfies the requirements of being a valid
state of the universe we are considering), what is the probability of the other
side being black as well?</p>
<p>Hence we can express this as O: cB? and we need P(B|cB?). We will enumerate
possibilities of observing the black side in our universe.</p>
<dl>
<dt>cBW</dt>
<dd>This has \(1\) way of producing cB?</dd>
<dt>cBB</dt>
<dd>This has \(2\) ways of producing cB?</dd>
<dt>cWW</dt>
<dd>This has \(0\) ways of producing cB?</dd>
</dl>
<table>
<thead>
<tr>
<th>Card</th>
<th>Ways to cB?</th>
</tr>
</thead>
<tbody>
<tr>
<td>cBW</td>
<td>1</td>
</tr>
<tr>
<td>cBB</td>
<td>2</td>
</tr>
<tr>
<td>cWW</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>So we see that there are \(3\) ways to see a black side in a single draw, and two of these come from (cBB), thus the probability of seeing another black side is \(\frac{2}{3}\).</p>
<h2 id=chapter-iii-sampling-the-imaginary>Chapter III: Sampling the Imaginary</h2>
<h3 id=easy-questions--ch3>Easy Questions (Ch3)</h3>
<p>These questions are associated with the following code snippet for the globe tossing example.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>p_grid</span><span class=o>&lt;-</span><span class=nf>seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>0</span><span class=p>,</span> <span class=n>to</span><span class=o>=</span><span class=m>1</span><span class=p>,</span> <span class=n>length.out</span><span class=o>=</span><span class=m>1000</span><span class=p>)</span>
<span class=n>prior</span><span class=o>&lt;-</span><span class=nf>rep</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=m>1000</span><span class=p>)</span>
<span class=n>likelihood</span><span class=o>&lt;-</span><span class=nf>dbinom</span><span class=p>(</span><span class=m>6</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>9</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>p_grid</span><span class=p>)</span>
<span class=n>posterior</span><span class=o>&lt;-</span><span class=n>likelihood</span><span class=o>*</span><span class=n>prior</span>
<span class=n>posterior</span><span class=o>&lt;-</span><span class=n>posterior</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>posterior</span><span class=p>)</span>
<span class=nf>set.seed</span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
<span class=n>samples</span><span class=o>&lt;-</span><span class=nf>sample</span><span class=p>(</span><span class=n>p_grid</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>posterior</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>1e4</span><span class=p>,</span><span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span>
</code></pre></div><h4 id=e1-1>3E1</h4>
<p>How much posterior probability lies below \(p = 0.2\)?</p>
<h5 id=solution>Solution</h5>
<p>We can check the number of samples as follows:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>ifelse</span><span class=p>(</span><span class=n>samples</span><span class=o>&lt;</span><span class=m>0.2</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sum</span><span class=p>(</span><span class=n>.)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>[1] 4
</code></pre></div><p>Now we will simply divide by the number of samples.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>ifelse</span><span class=p>(</span><span class=n>samples</span><span class=o>&lt;</span><span class=m>0.2</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sum</span><span class=p>(</span><span class=n>.)</span><span class=o>/</span><span class=m>1e4</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>[1] 4e-04
</code></pre></div><p>More practically, the percentage of the probability density below \(p=0.2\) is:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>ifelse</span><span class=p>(</span><span class=n>samples</span><span class=o>&lt;</span><span class=m>0.2</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sum</span><span class=p>(</span><span class=n>.)</span><span class=o>/</span><span class=m>1e4</span> <span class=o>*</span><span class=m>100</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>[1] 0.04
</code></pre></div><h4 id=e2-1>3E2</h4>
<p>How much posterior probability lies above \(p = 0.8\)?</p>
<h5 id=solution>Solution</h5>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>ifelse</span><span class=p>(</span><span class=n>samples</span><span class=o>&gt;</span><span class=m>0.8</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sum</span><span class=p>(</span><span class=n>.)</span><span class=o>/</span><span class=m>1e4</span> <span class=o>*</span><span class=m>100</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>[1] 11.16
</code></pre></div><h4 id=e3-1>3E3</h4>
<p>How much posterior probability lies between \(p = 0.2\) and \(p = 0.8\)?</p>
<h5 id=solution>Solution</h5>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>ifelse</span><span class=p>(</span><span class=n>samples</span><span class=o>&gt;</span><span class=m>0.2</span> <span class=o>&amp;</span> <span class=n>samples</span><span class=o>&lt;</span><span class=m>0.8</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sum</span><span class=p>(</span><span class=n>.)</span><span class=o>/</span><span class=m>1e4</span> <span class=o>*</span><span class=m>100</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>[1] 88.8
</code></pre></div><h4 id=e4-1>3E4</h4>
<p>20% of the posterior probability lies below which value of \(p\)?</p>
<h5 id=solution>Solution</h5>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>samples</span> <span class=o>%&gt;%</span> <span class=nf>quantile</span><span class=p>(</span><span class=m>0.2</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>      20%
0.5185185
</code></pre></div><h4 id=e5>3E5</h4>
<p>20% of the posterior probability lies above which value of \(p\)?</p>
<h5 id=solution>Solution</h5>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>samples</span> <span class=o>%&gt;%</span> <span class=nf>quantile</span><span class=p>(</span><span class=m>0.8</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>      80%
0.7557558
</code></pre></div><h3 id=questions-of-medium-complexity--ch3>Questions of Medium Complexity (Ch3)</h3>
<h4 id=m1-1>3M1</h4>
<p>Suppose the globe tossing data had turned out to be 8 water in 15
tosses. Construct the posterior distribution, using grid approximation.
Use the same flat prior as before.</p>
<h5 id=solution>Solution</h5>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nPoints</span><span class=o>&lt;-</span><span class=m>1000</span>
<span class=c1>## Grid</span>
<span class=n>pGrid</span><span class=o>&lt;-</span><span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=n>nPoints</span><span class=p>)</span>
<span class=c1>## Prior</span>
<span class=n>prior</span><span class=o>&lt;-</span><span class=nf>rep</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=n>nPoints</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>8</span><span class=p>,</span><span class=m>15</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>post2unstd</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>posterior</span><span class=o>=</span><span class=n>post2unstd</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>post2unstd</span><span class=p>))</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>pGrid</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>posterior</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Globe Tosses with a Flat Prior&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;3M1) 8W in 15 tosses&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Posterior&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Grid Approximation points&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>),</span>
                     <span class=n>labels</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=m>10</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sprintf</span><span class=p>(</span><span class=s>&#34;%.2f&#34;</span><span class=p>,</span><span class=n>.)</span><span class=p>,</span>
                     <span class=n>expand</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/3m1globeW8N15.png>
</figure>
<h4 id=m2-1>3M2</h4>
<p>Draw 10,000 samples from the grid approximation from above. Then use the
samples to calculate the 90% HPDI for \(p\).</p>
<h5 id=solution>Solution</h5>
<p>For this, we will create a <code>tibble</code> of the experiment and then sample from it.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>exp3m2</span><span class=o>&lt;-</span><span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=m>8</span><span class=p>,</span><span class=m>15</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>post2unstd</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>posterior</span><span class=o>=</span><span class=n>post2unstd</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>post2unstd</span><span class=p>))</span>

<span class=nf>sample</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>exp3m2</span><span class=o>$</span><span class=n>posterior</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>1e4</span><span class=p>,</span><span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>HPDI</span><span class=p>(</span><span class=n>prob</span><span class=o>=</span><span class=m>0.9</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>
     |0.9      0.9|
0.3293293 0.7167167
</code></pre></div><h4 id=m3>3M3</h4>
<p>Construct a posterior predictive check for this model and data. This
means simulate the distribution of samples, averaging over the posterior
uncertainty in \(p\). What is the probability of observing 8 water in 15
tosses.</p>
<h5 id=solution>Solution</h5>
<p>As covered in the chapter, we will sample from the posterior distribution and
use that to obtain experiment instances with <code>rbinom</code>. Finally we will then use
these instances to count our way to the probability of observing the true data.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>waterPred</span><span class=o>&lt;-</span><span class=nf>sample</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>exp3m2</span><span class=o>$</span><span class=n>posterior</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>1e4</span><span class=p>,</span><span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>rbinom</span><span class=p>(</span><span class=m>1e4</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>15</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span>
<span class=nf>ifelse</span><span class=p>(</span><span class=n>waterPred</span><span class=o>==</span><span class=m>8</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sum</span><span class=p>(</span><span class=n>.)</span><span class=o>/</span><span class=m>1e4</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>[1] 0.1447
</code></pre></div><p>This seems like a very poor model, but the spread of the realizations is
probably a better measure.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>waterPred</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
  0.000   6.000   8.000   7.936  10.000  15.000
</code></pre></div><p>This does seem to indicate that at any rate the realizations are close enough
to 8 for the model to be viable. A visualization of this should also be checked.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>waterPred</span> <span class=o>%&gt;%</span> <span class=n>simplehist</span>
</code></pre></div><figure><img src=/ox-hugo/3m3globeW8N15hist.png>
</figure>
<h4 id=m4-1>3M4</h4>
<p>Using the posterior distribution constructed from the new (8/15) data,
now calculate the probability of observing 6 water in 9 tosses</p>
<h5 id=solution>Solution</h5>
<p>We will reuse the posterior, and recalculate our samples (corresponding to new
possible instances).</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>waterPred</span><span class=o>&lt;-</span><span class=nf>sample</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>exp3m2</span><span class=o>$</span><span class=n>posterior</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>1e4</span><span class=p>,</span><span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>rbinom</span><span class=p>(</span><span class=m>1e4</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>9</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>ifelse</span><span class=p>(</span><span class=n>waterPred</span><span class=o>==</span><span class=m>6</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sum</span><span class=p>(</span><span class=n>.)</span><span class=o>/</span><span class=m>1e4</span>
<span class=n>waterPred</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>[1] 0.1723

   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
  0.000   4.000   5.000   4.777   6.000   9.000
</code></pre></div><p>Though the numerical value is not very different from the previous solution, we
note that the centrality measures are much worse.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>waterPred</span> <span class=o>%&gt;%</span> <span class=n>simplehist</span>
</code></pre></div><figure><img src=/ox-hugo/3m4globeW6N9hist.png>
</figure>
<h4 id=m6>3M6</h4>
<p>Suppose you want to estimate the Earth&rsquo;s proportion of water very
precisely. Specifically, you want the 99% percentile interval of the
posterior distribution of p to be only 0.05 wide. This means the
distance between the upper and lower bound of the interval should be
0.05. How many times will you have to toss the globe to do this?</p>
<h5 id=solution>Solution</h5>
<p>Since the no information of the model has been provided here, we will consider
reason out an approach, before making an estimate.</p>
<p>The number globe tosses corresponds to the number of observations we require. A
percentile interval this narrow will essentially require a large number of
samples i.e. be in the large number limit, so the choice of prior should not
matter much. The width of our interval should also be related to the number of
grid points we use in our approximation.</p>
<p>We will first use the true amount of water on the planet (approximately 71
percent) to generate information for the number of throws.</p>
<p>Let us generate observations.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nThrows</span><span class=o>&lt;-</span><span class=m>10000</span>
<span class=n>nWater</span><span class=o>&lt;-</span><span class=m>0.71</span><span class=o>*</span><span class=n>nThrows</span> <span class=o>%&gt;%</span> <span class=n>round</span>
</code></pre></div><p>We will set up a simple model for this, with an indifferent prior along with a
better prior.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nPoints</span><span class=o>&lt;-</span><span class=m>1000</span>
<span class=c1>## Grid</span>
<span class=n>pGrid</span><span class=o>&lt;-</span><span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=n>length.out</span><span class=o>=</span><span class=n>nPoints</span><span class=p>)</span>
<span class=c1>## Prior</span>
<span class=n>prior</span><span class=o>&lt;-</span><span class=nf>rep</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=n>nPoints</span><span class=p>)</span>
<span class=n>betterPrior</span><span class=o>&lt;-</span><span class=nf>ifelse</span><span class=p>(</span><span class=n>pGrid</span><span class=o>&lt;</span><span class=m>0.5</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
</code></pre></div><p>We will define a function for generating our results since we will need to perform this a few times.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>genModel</span><span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>nThrows</span><span class=p>){</span>
<span class=n>nWater</span><span class=o>&lt;-</span><span class=m>0.71</span><span class=o>*</span><span class=n>nThrows</span> <span class=o>%&gt;%</span> <span class=n>round</span>
<span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=n>nWater</span><span class=p>,</span><span class=n>nThrows</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>,</span><span class=n>betterPrior</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>mutate</span><span class=p>(</span>
    <span class=n>postUnifNSD</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>,</span>
    <span class=n>postUnif</span><span class=o>=</span><span class=n>postUnifNSD</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>postUnifNSD</span><span class=p>),</span>
    <span class=n>smplUnif</span><span class=o>=</span><span class=nf>sample</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
                    <span class=n>prob</span><span class=o>=</span><span class=n>postUnif</span><span class=p>,</span>
                    <span class=n>size</span><span class=o>=</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span>
                    <span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>),</span>
    <span class=n>predUnif</span><span class=o>=</span><span class=nf>rbinom</span><span class=p>(</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>9</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>smplUnif</span><span class=p>),</span>
    <span class=n>postBPNSD</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>betterPrior</span><span class=p>,</span>
    <span class=n>postBP</span><span class=o>=</span><span class=n>postBPNSD</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>postBPNSD</span><span class=p>),</span>
    <span class=n>smplBP</span><span class=o>=</span><span class=nf>sample</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
                    <span class=n>prob</span><span class=o>=</span><span class=n>postBP</span><span class=p>,</span>
                    <span class=n>size</span><span class=o>=</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span>
                    <span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>),</span>
    <span class=n>predBP</span><span class=o>=</span><span class=nf>rbinom</span><span class=p>(</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>9</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>smplBP</span><span class=p>)</span>
  <span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>It would be nice to look at the different priors as well.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>genModel2</span><span class=p>(</span><span class=m>1e4</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>.$predBP</span> <span class=o>%&gt;%</span> <span class=n>simplehist</span>
</code></pre></div><figure><img src=/ox-hugo/3m6globeNP.png>
</figure>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>genModel</span><span class=p>(</span><span class=m>1e6</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>.$predUnif</span> <span class=o>%&gt;%</span> <span class=n>simplehist</span>
</code></pre></div><figure><img src=/ox-hugo/3m6globeNP.png>
</figure>
<p>As can be expected, with the large number of observations, the priors barely
make a difference.</p>
<p>We note that what we are looking for is a credibility width of less than 0.05 at
a probability of 0.99.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>get99Width</span><span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>nx</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>piInter</span><span class=o>&lt;-</span><span class=nf>PI</span><span class=p>(</span><span class=n>x</span><span class=o>$</span><span class=n>postUnif</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=m>0.99</span><span class=p>)</span>
  <span class=n>hpdiInter</span><span class=o>&lt;-</span><span class=nf>HPDI</span><span class=p>(</span><span class=n>x</span><span class=o>$</span><span class=n>postUnif</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=m>0.99</span><span class=p>)</span>
  <span class=nf>tibble</span><span class=p>(</span><span class=n>wPI</span><span class=o>=</span><span class=n>piInter[2]</span><span class=o>-</span><span class=n>piInter[1]</span><span class=p>,</span><span class=n>wHPDI</span><span class=o>=</span><span class=n>hpdiInter[2]</span><span class=o>-</span><span class=n>hpdiInter[1]</span><span class=p>,</span><span class=n>nSamples</span><span class=o>=</span><span class=n>nx</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>Now we are in a position to start testing samples.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>base100</span><span class=o>&lt;-</span><span class=nf>genModel</span><span class=p>(</span><span class=m>1e2</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>get99Width</span><span class=p>(</span><span class=m>1e2</span><span class=p>)</span>
<span class=n>t</span><span class=o>&lt;-</span><span class=m>1000</span>
<span class=nf>while</span><span class=p>(</span><span class=nf>min</span><span class=p>(</span><span class=n>base100</span><span class=o>$</span><span class=n>wPI</span><span class=p>)</span> <span class=o>&amp;</span> <span class=nf>min</span><span class=p>(</span><span class=n>base100</span><span class=o>$</span><span class=n>wHPDI</span><span class=p>)</span> <span class=o>&gt;</span> <span class=m>0.005</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>t</span><span class=o>&lt;-</span><span class=n>t</span><span class=o>*</span><span class=m>10</span>
  <span class=n>base100</span><span class=o>&lt;-</span><span class=nf>genModel</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>get99Width</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>bind_rows</span><span class=p>(</span><span class=n>base100</span><span class=p>)</span>
<span class=p>}</span>
<span class=n>base100</span> <span class=o>%&gt;%</span> <span class=n>toOrg</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>
|                 wPI |               wHPDI | nSamples |
|---------------------+---------------------+----------|
|  0.0464554168997065 | 0.00121611594937107 |    1e+05 |
|  0.0735809517149284 |  0.0511200696528017 |    10000 |
| 0.00884431494702241 |  0.0088121623437198 |      100 |
</code></pre></div><p>There is an inherent problem with this formulation, and that is that the model
confidence is based on the observations which were drawn to emulate the true
distribution of water on Earth. This means that a highly tight width, should be
recognized to still be highly dependent on the observed data. Let us try to
obtain the same intervals with a randomized observation setup instead.</p>
<p>In order to do this we simply modify the number of water observations.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>genModel2</span><span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>nThrows</span><span class=p>){</span>
<span class=nf>tibble</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
       <span class=n>li2</span><span class=o>=</span><span class=n>pGrid</span> <span class=o>%&gt;%</span> <span class=nf>dbinom</span><span class=p>(</span><span class=nf>sample</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=n>nThrows</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>),</span><span class=n>nThrows</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>.)</span><span class=p>,</span>
       <span class=n>prior</span><span class=p>,</span><span class=n>betterPrior</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>mutate</span><span class=p>(</span>
    <span class=n>postUnifNSD</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>prior</span><span class=p>,</span>
    <span class=n>postUnif</span><span class=o>=</span><span class=n>postUnifNSD</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>postUnifNSD</span><span class=p>),</span>
    <span class=n>smplUnif</span><span class=o>=</span><span class=nf>sample</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
                    <span class=n>prob</span><span class=o>=</span><span class=n>postUnif</span><span class=p>,</span>
                    <span class=n>size</span><span class=o>=</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span>
                    <span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>),</span>
    <span class=n>predUnif</span><span class=o>=</span><span class=nf>rbinom</span><span class=p>(</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>9</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>smplUnif</span><span class=p>),</span>
    <span class=n>postBPNSD</span><span class=o>=</span><span class=n>li2</span><span class=o>*</span><span class=n>betterPrior</span><span class=p>,</span>
    <span class=n>postBP</span><span class=o>=</span><span class=n>postBPNSD</span><span class=o>/</span><span class=nf>sum</span><span class=p>(</span><span class=n>postBPNSD</span><span class=p>),</span>
    <span class=n>smplBP</span><span class=o>=</span><span class=nf>sample</span><span class=p>(</span><span class=n>pGrid</span><span class=p>,</span>
                    <span class=n>prob</span><span class=o>=</span><span class=n>postBP</span><span class=p>,</span>
                    <span class=n>size</span><span class=o>=</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span>
                    <span class=n>replace</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>),</span>
    <span class=n>predBP</span><span class=o>=</span><span class=nf>rbinom</span><span class=p>(</span><span class=nf>nrow</span><span class=p>(</span><span class=n>.)</span><span class=p>,</span><span class=n>size</span><span class=o>=</span><span class=m>9</span><span class=p>,</span><span class=n>prob</span><span class=o>=</span><span class=n>smplBP</span><span class=p>)</span>
  <span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>We can now test these the same way.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>base100</span><span class=o>&lt;-</span><span class=nf>genModel2</span><span class=p>(</span><span class=m>100</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>get99Width</span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
<span class=n>t</span><span class=o>&lt;-</span><span class=m>100</span>
<span class=nf>while</span><span class=p>(</span><span class=nf>min</span><span class=p>(</span><span class=n>base100</span><span class=o>$</span><span class=n>wPI</span><span class=p>)</span> <span class=o>&amp;</span> <span class=nf>min</span><span class=p>(</span><span class=n>base100</span><span class=o>$</span><span class=n>wHPDI</span><span class=p>)</span> <span class=o>&gt;</span> <span class=m>0.05</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>t</span><span class=o>&lt;-</span><span class=n>t</span><span class=m>+100</span>
  <span class=n>base100</span><span class=o>&lt;-</span><span class=nf>genModel2</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>get99Width</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>bind_rows</span><span class=p>(</span><span class=n>base100</span><span class=p>)</span>
<span class=p>}</span>
<span class=n>base100</span> <span class=o>%&gt;%</span> <span class=n>toOrg</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>
|                 wPI |               wHPDI | nSamples |
|---------------------+---------------------+----------|
| 0.00853874459759265 | 0.00851020493831213 |      100 |
</code></pre></div><h2 id=chapter-iv-geocentric-models>Chapter IV: Geocentric Models</h2>
<h3 id=easy-questions--ch4>Easy Questions (Ch4)</h3>
<h4 id=e1-2>4E1</h4>
<p>In the model definition below, which line is the likelihood?</p>
<h5 id=solution>Solution</h5>
<p>The likelihood is defined by the first line, that is, \(y_i \sim\mathrm{Normal}(\mu, \sigma)\)</p>
<h4 id=e2-2>4E2</h4>
<p>In the model definition above, how many parameters are in the posterior
distribution?</p>
<h5 id=solution>Solution</h5>
<p>The model has two parameters for the posterior distribution, \(\mu\) and \(\sigma\).</p>
<h4 id=e3-2>4E3</h4>
<p>Using the model definition above, write down the appropriate form of
Bayes' theorem that includes the proper likelihood and priors.</p>
<h5 id=solution>Solution</h5>
<p>The appropriate form of Bayes' theorem in this case is:</p>
<p>\[ \mathrm(Pr)(\mu,\sigma|y)=\frac{\mathrm{Normal}(y|\mu,\sigma)\mathrm{Normal}(\mu|0,10)\mathrm{Exponential}(\sigma|1)}{\int\int \mathrm{Normal}(y|\mu,\sigma)\mathrm{Normal}(\mu|0,10)\mathrm{Exponential}(\sigma|1)d\mu d\sigma} \]</p>
<h4 id=e4-2>4E4</h4>
<p>In the model definition below, which line is the linear model?</p>
<h5 id=solution>Solution</h5>
<p>The second line is the linear model in the definition, that is:
\[\mu_i = \alpha + \beta x_i\]</p>
<h4 id=e5-1>4E5</h4>
<p>In the model definition just above, how many parameters are in the
posterior distribution?</p>
<h5 id=solution>Solution</h5>
<p>The model defined has three independent parameters for the posterior
distribution, which are \(\alpha\), \(\beta\) and \(\sigma\). Though \(\mu\) is a
parameter, it is defined in terms of \(\alpha\), \(\beta\) and \(x\) so will not be
considered to be a parameter for the posterior.</p>
<h3 id=questions-of-medium-complexity--ch4>Questions of Medium Complexity (Ch4)</h3>
<h4 id=m1-2>4M1</h4>
<p>For the model definition below, simulate observed \(y\) values from the
prior (not the posterior).</p>
<h5 id=solution>Solution</h5>
<p>Sampling from the prior involves averaging over the prior distributions of \(\mu\)
and \(\sigma\).</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>muPrior</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=m>1e4</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>10</span><span class=p>)</span>
<span class=n>sigmaPrior</span><span class=o>&lt;-</span><span class=nf>rexp</span><span class=p>(</span><span class=m>1e4</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
<span class=n>hSim</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=m>1e4</span><span class=p>,</span><span class=n>muPrior</span><span class=p>,</span><span class=n>sigmaPrior</span><span class=p>)</span>
</code></pre></div><p>We can visualize this as well.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>hSim</span> <span class=o>%&gt;%</span> <span class=nf>qplot</span><span class=p>(</span><span class=n>binwidth</span><span class=o>=</span><span class=m>0.8</span><span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/priorSim.png>
</figure>
<h4 id=m2-2>4M2</h4>
<p>Translate the model just above into a <code>quap</code> formula.</p>
<h5 id=solution>Solution</h5>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>ex4m2</span><span class=o>&lt;-</span><span class=nf>alist</span><span class=p>(</span>
  <span class=n>y</span><span class=o>~</span><span class=nf>dnorm</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span><span class=n>sigma</span><span class=p>),</span>
  <span class=n>mu</span><span class=o>~</span><span class=nf>dnorm</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>10</span><span class=p>),</span>
  <span class=n>sigma</span><span class=o>~</span><span class=nf>dexp</span><span class=p>(</span><span class=m>1</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div><h4 id=m3-1>4M3</h4>
<p>Translate the <code>quap</code> model formula below into a mathematical model
definition</p>
<h5 id=solution>Solution</h5>
<p>The model defined can be expressed mathematically as:</p>
<h4 id=m4-2>4M4</h4>
<p>A sample of students is measured for height each year for 3y ears. After
the third year,you want to fit a linear regression predicting height
using year as a predictor. Write down the mathematical model definition
for this regression, using any variable names and priors you choose. Be
prepared to defend your choice of priors.</p>
<h5 id=solution>Solution</h5>
<p>Let us first declare a model.</p>
<p>Where the double subscript is meant to indicate that the data is obtained both per year and per student. That is, we have:</p>
<ul>
<li>\(y_{ij}\) is the <strong>height</strong> of each student each year</li>
<li>\(x_{j}\) is the &ldquo;reduced&rdquo; year, that is the difference between a particular year and the average sample year</li>
</ul>
<p>The prior distributions are not too complicated. Since the distribution of males
and females in the student population is missing, as is information on the age
distribution, we will set a conservative lower value of 120 centimeters, based
on the understanding that the students have at-least 3 years in school, so they
are growing, so we assume students grow around 8 centimeters every year.</p>
<p>The distribution for beta is a log-normal distribution to ensure that we do not
sample negative values which might arise from sampling a Gaussian. This is due
to the assumption that the students grow every year.</p>
<p>Following the procedures of the chapter, we will visualize realizations from the
prior.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nDraws</span><span class=o>&lt;-</span><span class=m>50</span>
<span class=n>a</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>100</span><span class=p>,</span><span class=m>8</span><span class=p>)</span>
<span class=n>b</span><span class=o>&lt;-</span><span class=nf>rlnorm</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>2</span><span class=p>)</span>
<span class=n>sigmaPrior</span><span class=o>&lt;-</span><span class=nf>rexp</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
</code></pre></div><p>We will express our yearly function:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>genYr</span><span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>yr</span><span class=p>)</span> <span class=p>{</span><span class=nf>rnorm</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=n>a[x]</span><span class=o>+</span><span class=n>b[x]</span><span class=o>*</span><span class=p>(</span><span class=n>yr</span><span class=m>-1.5</span><span class=p>),</span><span class=n>sigmaPrior[x]</span><span class=p>)}</span>
</code></pre></div><p>Now we will assume a class size of 35 for our priors.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>testDat</span><span class=o>&lt;-</span><span class=nf>tibble</span><span class=p>(</span><span class=n>student</span><span class=o>=</span><span class=m>1</span><span class=o>:</span><span class=m>36</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year1</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>1</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year2</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>2</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year3</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>3</span><span class=p>)</span>
</code></pre></div><p>We will now look at this.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>testDat</span> <span class=o>%&gt;%</span> <span class=nf>pivot_longer</span><span class=p>(</span><span class=o>-</span><span class=n>student</span><span class=p>,</span><span class=n>names_to</span> <span class=o>=</span> <span class=s>&#34;year&#34;</span><span class=p>,</span><span class=n>values_to</span> <span class=o>=</span> <span class=s>&#34;height&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>student</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>height</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=n>year</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>alpha</span><span class=o>=</span><span class=m>0.4</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>colour</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Student Height variation&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;By year&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Height&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Student&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span><span class=p>,</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/tryHeight.png>
</figure>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>testDat</span> <span class=o>%&gt;%</span> <span class=nf>pivot_longer</span><span class=p>(</span><span class=o>-</span><span class=n>student</span><span class=p>,</span><span class=n>names_to</span> <span class=o>=</span> <span class=s>&#34;year&#34;</span><span class=p>,</span><span class=n>values_to</span> <span class=o>=</span> <span class=s>&#34;height&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>year</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>height</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=n>student</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>alpha</span><span class=o>=</span><span class=m>0.4</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>colour</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Student Height variation&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;By year&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Height&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Student&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span><span class=p>,</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/tryHeightYear.png>
</figure>
<p>This seems to be a pretty reasonable model, all things considered.</p>
<h4 id=m5>4M5</h4>
<p>Now suppose I remind you that every student got taller each year. Does
this information lead you to change your choice of priors? How?</p>
<h5 id=solution>Solution</h5>
<p>Since we have incorporated a LogNormal term, we do not need to change our choice
of prior. However, the parameters of our previous model did include some heights decreasing, so we will modify the LogNormal distribution on beta. Recall that we would like to see around 7 centimeters of growth, so our mean should be exp(1+2/2) which is around 7.</p>
<p>Simulating draws as before.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nDraws</span><span class=o>&lt;-</span><span class=m>50</span>
<span class=n>a</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>100</span><span class=p>,</span><span class=m>8</span><span class=p>)</span>
<span class=n>b</span><span class=o>&lt;-</span><span class=nf>rlnorm</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>2</span><span class=p>)</span>
<span class=n>sigmaPrior</span><span class=o>&lt;-</span><span class=nf>rexp</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
<span class=n>genYr</span><span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>yr</span><span class=p>)</span> <span class=p>{</span><span class=nf>rnorm</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=n>a[x]</span><span class=o>+</span><span class=n>b[x]</span><span class=o>*</span><span class=p>(</span><span class=n>yr</span><span class=m>-1.5</span><span class=p>),</span><span class=n>sigmaPrior[x]</span><span class=p>)}</span>
<span class=n>testDat</span><span class=o>&lt;-</span><span class=nf>tibble</span><span class=p>(</span><span class=n>student</span><span class=o>=</span><span class=m>1</span><span class=o>:</span><span class=m>36</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year1</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>1</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year2</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>2</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year3</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>3</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>testDat</span> <span class=o>%&gt;%</span> <span class=nf>pivot_longer</span><span class=p>(</span><span class=o>-</span><span class=n>student</span><span class=p>,</span><span class=n>names_to</span> <span class=o>=</span> <span class=s>&#34;year&#34;</span><span class=p>,</span><span class=n>values_to</span> <span class=o>=</span> <span class=s>&#34;height&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>student</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>height</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=n>year</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>alpha</span><span class=o>=</span><span class=m>0.4</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>colour</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Student Height variation&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;By year with better priors&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Height&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Student&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span><span class=p>,</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/4m5tryHeight.png>
</figure>
<h4 id=m6-1>4M6</h4>
<p>Now suppose I tell you that the variance among heights for students of
the same age is never more than 64cm. How does this lead you to revise
your priors?</p>
<h5 id=solution>Solution</h5>
<p>This information will change the variance term in our model. We will incorporate
this into our model by using a uniform distribution for sigma.
The new model is then:</p>
<p>Simulating draws as before.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>nDraws</span><span class=o>&lt;-</span><span class=m>50</span>
<span class=n>a</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>100</span><span class=p>,</span><span class=m>8</span><span class=p>)</span>
<span class=n>b</span><span class=o>&lt;-</span><span class=nf>rlnorm</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>2</span><span class=p>)</span>
<span class=n>sigmaPrior</span><span class=o>&lt;-</span><span class=nf>runif</span><span class=p>(</span><span class=n>nDraws</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>8</span><span class=p>)</span>
<span class=n>genYr</span><span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>yr</span><span class=p>)</span> <span class=p>{</span><span class=nf>rnorm</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=n>a[x]</span><span class=o>+</span><span class=n>b[x]</span><span class=o>*</span><span class=p>(</span><span class=n>yr</span><span class=m>-1.5</span><span class=p>),</span><span class=n>sigmaPrior[x]</span><span class=p>)}</span>
<span class=n>testDat</span><span class=o>&lt;-</span><span class=nf>tibble</span><span class=p>(</span><span class=n>student</span><span class=o>=</span><span class=m>1</span><span class=o>:</span><span class=m>36</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year1</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>1</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year2</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>2</span><span class=p>)</span>
<span class=n>testDat</span><span class=o>$</span><span class=n>year3</span><span class=o>&lt;-</span><span class=nf>sapply</span><span class=p>(</span><span class=n>testDat</span><span class=o>$</span><span class=n>student</span><span class=p>,</span><span class=n>FUN</span><span class=o>=</span><span class=n>genYr</span><span class=p>,</span><span class=n>yr</span><span class=o>=</span><span class=m>3</span><span class=p>)</span>
</code></pre></div><p>We will now look at this.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>testDat</span> <span class=o>%&gt;%</span> <span class=nf>pivot_longer</span><span class=p>(</span><span class=o>-</span><span class=n>student</span><span class=p>,</span><span class=n>names_to</span> <span class=o>=</span> <span class=s>&#34;year&#34;</span><span class=p>,</span><span class=n>values_to</span> <span class=o>=</span> <span class=s>&#34;height&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>year</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>height</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=n>student</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>alpha</span><span class=o>=</span><span class=m>0.4</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>colour</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Student Height variation&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;By year with additional information&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Height&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;Student&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span><span class=p>,</span>
        <span class=p>)</span>
</code></pre></div><figure><img src=/ox-hugo/4m6tryHeight.png>
</figure>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>testDat</span> <span class=o>%&gt;%</span> <span class=nf>pivot_longer</span><span class=p>(</span><span class=o>-</span><span class=n>student</span><span class=p>,</span><span class=n>names_to</span> <span class=o>=</span> <span class=s>&#34;year&#34;</span><span class=p>,</span><span class=n>values_to</span> <span class=o>=</span> <span class=s>&#34;height&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>year</span><span class=o>=</span><span class=n>year</span> <span class=o>%&gt;%</span> <span class=n>as.factor</span> <span class=o>%&gt;%</span> <span class=n>as.numeric</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>filter</span><span class=p>(</span><span class=n>student</span><span class=o>==</span><span class=m>3</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>year</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>height</span><span class=p>,</span><span class=n>color</span><span class=o>=</span><span class=n>student</span><span class=p>))</span><span class=o>+</span>
  <span class=nf>geom_line</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>alpha</span><span class=o>=</span><span class=m>0.4</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>geom_point</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>colour</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>)</span><span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s>&#34;Student Height variation with additional information&#34;</span><span class=p>,</span>
    <span class=n>subtitle</span><span class=o>=</span><span class=s>&#34;By year&#34;</span><span class=p>,</span>
    <span class=n>y</span><span class=o>=</span><span class=s>&#34;Height&#34;</span><span class=p>,</span>
    <span class=n>x</span><span class=o>=</span><span class=s>&#34;year&#34;</span>
  <span class=p>)</span><span class=o>+</span>
  <span class=nf>theme</span><span class=p>(</span>
    <span class=n>plot.title.position</span> <span class=o>=</span> <span class=s>&#34;plot&#34;</span><span class=p>,</span>
        <span class=p>)</span>
</code></pre></div><p><img src=/ox-hugo/4m6tryHeightYear.png alt>
This is now much more reasonable.</p>
<h4 id=m7>4M7</h4>
<p>Refit model <code>m4.3</code> from the chapter, but omit the mean weight <code>xbar</code>
this time. Compare the new model&rsquo;s posterior to that of the original
model. In particular, look at the covariance among the parameters. What
is different? Then compare the posterior predictions of both models.</p>
<h5 id=solution>Solution</h5>
<p>Let us re-create the original data model first.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>data</span><span class=p>(</span><span class=n>Howell1</span><span class=p>)</span>
<span class=n>howDat</span><span class=o>&lt;-</span><span class=n>Howell1</span>
<span class=n>howDat</span><span class=o>&lt;-</span><span class=n>howDat</span> <span class=o>%&gt;%</span> <span class=nf>filter</span><span class=p>(</span><span class=n>age</span><span class=o>&gt;=</span><span class=m>18</span><span class=p>)</span>
</code></pre></div><p>Recall that the original model was given by:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>xbar</span><span class=o>&lt;-</span><span class=nf>mean</span><span class=p>(</span><span class=n>howDat</span><span class=o>$</span><span class=n>weight</span><span class=p>)</span>
<span class=n>m43</span><span class=o>&lt;-</span><span class=nf>quap</span><span class=p>(</span>
  <span class=nf>alist</span><span class=p>(</span>
    <span class=n>height</span> <span class=o>~</span> <span class=nf>dnorm</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span><span class=n>sigma</span><span class=p>),</span>
    <span class=n>mu</span><span class=o>&lt;-</span><span class=n>a</span><span class=o>+</span><span class=n>b</span><span class=o>*</span><span class=p>(</span><span class=n>weight</span><span class=o>-</span><span class=n>xbar</span><span class=p>),</span>
    <span class=n>a</span> <span class=o>~</span> <span class=nf>dnorm</span><span class=p>(</span><span class=m>178</span><span class=p>,</span><span class=m>20</span><span class=p>),</span>
    <span class=n>b</span> <span class=o>~</span> <span class=nf>dlnorm</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>),</span>
    <span class=n>sigma</span> <span class=o>~</span> <span class=nf>dunif</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>50</span><span class=p>)</span>
  <span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>howDat</span>
<span class=p>)</span>
<span class=n>m43</span> <span class=o>%&gt;%</span> <span class=n>precis</span> <span class=o>%&gt;%</span> <span class=n>toOrg</span>
</code></pre></div><table>
<thead>
<tr>
<th>row.names</th>
<th>mean</th>
<th>sd</th>
<th>5.5%</th>
<th>94.5%</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>154.601366268055</td>
<td>0.270307670586024</td>
<td>154.169362403256</td>
<td>155.033370132855</td>
</tr>
<tr>
<td>b</td>
<td>0.90328084058895</td>
<td>0.041923632631821</td>
<td>0.83627877851613</td>
<td>0.970282902661771</td>
</tr>
<tr>
<td>sigma</td>
<td>5.07188106954248</td>
<td>0.191154797986941</td>
<td>4.76637878273641</td>
<td>5.37738335634854</td>
</tr>
</tbody>
</table>
<p>Now we can incorporate the new information we have.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m43b</span><span class=o>&lt;-</span><span class=nf>quap</span><span class=p>(</span>
  <span class=nf>alist</span><span class=p>(</span>
    <span class=n>height</span> <span class=o>~</span> <span class=nf>dnorm</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span><span class=n>sigma</span><span class=p>),</span>
    <span class=n>mu</span><span class=o>&lt;-</span><span class=n>a</span><span class=o>+</span><span class=n>b</span><span class=o>*</span><span class=n>weight</span><span class=p>,</span>
    <span class=n>a</span> <span class=o>~</span> <span class=nf>dnorm</span><span class=p>(</span><span class=m>178</span><span class=p>,</span><span class=m>20</span><span class=p>),</span>
    <span class=n>b</span> <span class=o>~</span> <span class=nf>dlnorm</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>),</span>
    <span class=n>sigma</span> <span class=o>~</span> <span class=nf>dunif</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>50</span><span class=p>)</span>
  <span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>howDat</span>
<span class=p>)</span>
<span class=n>m43b</span> <span class=o>%&gt;%</span> <span class=n>precis</span> <span class=o>%&gt;%</span> <span class=n>toOrg</span>
</code></pre></div><table>
<thead>
<tr>
<th>row.names</th>
<th>mean</th>
<th>sd</th>
<th>5.5%</th>
<th>94.5%</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>114.515009160638</td>
<td>1.89397291870405</td>
<td>111.488074634765</td>
<td>117.54194368651</td>
</tr>
<tr>
<td>b</td>
<td>0.891112682994587</td>
<td>0.0416750085549524</td>
<td>0.824507970215838</td>
<td>0.957717395773337</td>
</tr>
<tr>
<td>sigma</td>
<td>5.06263423083996</td>
<td>0.190299406826185</td>
<td>4.75849902431897</td>
<td>5.36676943736095</td>
</tr>
</tbody>
</table>
<p>Thus we note that the slope is the same, while the intercept changes. Now we
need to check the covariances. We will convert from the variable covariance
scale to the correlation matrix.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m43b</span> <span class=o>%&gt;%</span> <span class=n>vcov</span> <span class=o>%&gt;%</span> <span class=n>cov2cor</span> <span class=o>%&gt;%</span> <span class=nf>round</span><span class=p>(</span><span class=n>.,2</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>          a     b sigma
a      1.00 -0.99  0.02
b     -0.99  1.00 -0.02
sigma  0.02 -0.02  1.00
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m43</span> <span class=o>%&gt;%</span> <span class=n>vcov</span> <span class=o>%&gt;%</span> <span class=n>cov2cor</span> <span class=o>%&gt;%</span> <span class=nf>round</span><span class=p>(</span><span class=n>.,2</span><span class=p>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text>      a b sigma
a     1 0     0
b     0 1     0
sigma 0 0     1
</code></pre></div><p>The contrast between the two is very clear from the correlation matrices, the
new model has an almost perfect negatively correlated intercept and slope.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m43</span> <span class=o>%&gt;%</span> <span class=n>pairs</span>
</code></pre></div><figure><img src=/ox-hugo/4m7OrigM.png>
</figure>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m43b</span> <span class=o>%&gt;%</span> <span class=n>pairs</span>
</code></pre></div><figure><img src=/ox-hugo/4m7NewM.png>
</figure>
<p>This indicates that the scaling of the variables leads to a completely different
model in terms of the parameter relationships, in-spite of the fact that the
models have almost the same posterior predictions.</p>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>Summer of 2020&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
</article>
<hr>
<div class=post-info>
<p>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://rgoswami.me/tags/solutions>solutions</a></span><span class=tag><a href=https://rgoswami.me/tags/r>R</a></span><span class=tag><a href=https://rgoswami.me/tags/sr2>SR2</a></span>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>3661 Words</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Posted: <time class=dt-published> 2020-06-07 00:00 +0000</time></p>
<a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frgoswami.me%2fposts%2fsr2-ch2-ch3-ch4%2f" target=_blank rel=noopener aria-label=Facebook>
<div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15.84 9.5H13.5V8.48c0-.53.35-.65.6-.65h1.4v-2.3h-2.35c-2.3.0-2.65 1.7-2.65 2.8V9.5h-2v2h2v7h3v-7h2.1l.24-2z"/></svg></div>Facebook</div>
</a>
<a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=%22SR2%20%3a%3a%20Solutions%20for%20Chapters%20%7b2%2c3%2c4%7d%22%20seems%20like%20an%20interesting%20read%20from%20%40rg0swami&url=https%3a%2f%2frgoswami.me%2fposts%2fsr2-ch2-ch3-ch4%2f" target=_blank rel=noopener aria-label=Twitter>
<div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3.0 1 .4 1.7 1.2 2.2-.5.0-1 0-1.2-.3.0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8.0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="12" cy="12" r="11.5"/></svg></div>Twitter</div>
</a>
<a class=resp-sharing-button__link href="mailto:?subject=%22SR2%20%3a%3a%20Solutions%20for%20Chapters%20%7b2%2c3%2c4%7d%22%20seems%20interesting...&body=https%3a%2f%2frgoswami.me%2fposts%2fsr2-ch2-ch3-ch4%2f" target=_self rel=noopener aria-label=E-Mail>
<div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 16c0 .8-.7 1.5-1.5 1.5H6c-.8.0-1.5-.7-1.5-1.5V8c0-.8.7-1.5 1.5-1.5h12c.8.0 1.5.7 1.5 1.5v8zm-2-7.5L12 13 6.5 8.5m11 6-4-2.5m-7 2.5 4-2.5"/><circle cx="12" cy="12" r="11.5"/></svg></div>E-Mail</div>
</a>
<a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2frgoswami.me%2fposts%2fsr2-ch2-ch3-ch4%2f&title=%22SR2%20%3a%3a%20Solutions%20for%20Chapters%20%7b2%2c3%2c4%7d%22%20seems%20interesting...&summary=%22SR2%20%3a%3a%20Solutions%20for%20Chapters%20%7b2%2c3%2c4%7d%22%20seems%20interesting...&source=https%3a%2f%2frgoswami.me%2fposts%2fsr2-ch2-ch3-ch4%2f" target=_blank rel=noopener aria-label=LinkedIn>
<div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15 12.5c-.28.0-.5.22-.5.5v3.5h-3s.03-6.48.0-7h3v.83s.46-.75 1.7-.75c1.56.0 2.3 1.12 2.3 3.3v3.62h-3V13c0-.28-.23-.5-.5-.5zm-7.5-3h2v7h-2z"/><circle cx="8.5" cy="6.5" r="1"/></svg></div>LinkedIn</div>
</a>
<a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2frgoswami.me%2fposts%2fsr2-ch2-ch3-ch4%2f&resubmit=true&title=%22SR2%20%3a%3a%20Solutions%20for%20Chapters%20%7b2%2c3%2c4%7d%22%20seems%20interesting..." target=_blank rel=noopener aria-label=Reddit>
<div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><ellipse cx="12" cy="14.37" rx="6.2" ry="4.24"/><path d="M14.3 16.25c-.62.36-1.42.57-2.3.57s-1.7-.2-2.32-.58"/><circle cx="14.61" cy="13.39" r=".98"/><circle cx="9.39" cy="13.39" r=".98"/><path d="M16.4 11.38c.26-.55.82-.92 1.47-.92.9.0 1.63.73 1.63 1.63.0.8-.6 1.47-1.38 1.6"/><circle cx="17.22" cy="7.52" r="1.63"/><path d="M7.6 11.38c-.26-.54-.82-.92-1.47-.92-.9.0-1.63.73-1.63 1.63.0.8.6 1.47 1.38 1.6M12 10.12s-.08-4.82 3.6-2.6"/></svg></div>Reddit</div>
</a>
<a class=resp-sharing-button__link href="whatsapp://send?text=%22SR2%20%3a%3a%20Solutions%20for%20Chapters%20%7b2%2c3%2c4%7d%22%20seems%20interesting...%20https%3a%2f%2frgoswami.me%2fposts%2fsr2-ch2-ch3-ch4%2f" target=_blank rel=noopener aria-label=WhatsApp>
<div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle xmlns="http://www.w3.org/2000/svg" cx="12" cy="12" r="11.5"/><path stroke-width="1" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3.0-7.8 3.5-7.8 7.8.0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4.9 3.7.9 4.3.0 7.8-3.5 7.8-7.8.1-2-.7-3.9-2.2-5.4zm-5.5 11.9c-1.2.0-2.3-.3-3.3-.9l-.2-.1-2.4.6.7-2.4-.2-.2c-.6-1-1-2.2-1-3.4.0-3.6 2.9-6.5 6.5-6.5 1.7.0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.4-6.6 6.4zm3.5-4.8c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1s-.5.6-.6.8c-.1.1-.2.1-.4.0s-.8-.3-1.6-1c-.6-.5-1-1.2-1.1-1.3-.1-.2.0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.0-.2.0-.3s-.4-1.1-.6-1.4c-.2-.4-.3-.3-.4-.3h-.4s-.3.0-.5.2-.7.7-.7 1.6c0 1 .7 1.9.8 2s1.4 2.1 3.3 2.9c.5.2.8.3 1.1.4.5.1.9.1 1.2.1.4-.1 1.1-.5 1.3-.9.2-.5.2-.8.1-.9.0-.2-.2-.3-.4-.4z"/></svg></div>WhatsApp</div>
</a>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://rgoswami.me/posts/sr2-ch5-ch6-ch7/>
<span class=button__icon>←</span>
<span class=button__text>SR2 :: Solutions for Chapters {5,6,7}</span>
</a>
</span>
<span class="button next">
<a href=https://rgoswami.me/posts/trees-and-bags/>
<span class=button__text>Trees and Bags</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
<div id=comments class=thin><div class=pagination__title>
<span class=pagination__title-h>Comments</span>
<hr>
</div>
<div id=remarkbox-div>
<noscript>
<iframe id=remarkbox-iframe src="https://my.remarkbox.com/embed?nojs=true" style=height:600px;width:100%;border:none!important tabindex=0></iframe>
</noscript>
</div>
<script src=https://my.remarkbox.com/static/js/iframe-resizer/iframeResizer.min.js></script>
<script>var rb_owner_key="8e660759-e7e6-11ea-9711-040140774501",thread_uri=window.location.href,thread_title=window.document.title,thread_fragment=window.location.hash,rb_src="https://my.remarkbox.com/embed?rb_owner_key="+rb_owner_key+"&thread_title="+encodeURI(thread_title)+"&thread_uri="+encodeURIComponent(thread_uri)+thread_fragment;function create_remarkbox_iframe(){var a=document.createElement("iframe");a.setAttribute("id","remarkbox-iframe"),a.setAttribute("scrolling","no"),a.setAttribute("src",rb_src),a.setAttribute("frameborder","0"),a.setAttribute("tabindex","0"),a.setAttribute("title","Remarkbox"),a.style.width="100%",document.getElementById("remarkbox-div").appendChild(a)}create_remarkbox_iframe(),iFrameResize({checkOrigin:["https://my.remarkbox.com"],inPageLinks:!0,initCallback:function(a){a.iFrameResizer.moveToAnchor(thread_fragment)}},document.getElementById("remarkbox-iframe"))</script>
</div>
</main>
<footer class=footer>
<p>
&copy; 2021
<span><a href=https://rgoswami.me/>Rohit Goswami (HaoZeke)</a></span>
<a href=https://rgoswami.me/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a>
<br>
<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>
Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br>
<script src=https://liberapay.com/rohit/widgets/button.js></script>
<noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript>
</p>
</footer>
</div>
<script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'),ga('create','UA-109503488-16','auto'),ga('send','pageview')</script>
<script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","3z2xvwqu4u")</script>
<script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script>
<script async src=https://static.getclicky.com/js></script>
<script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script>
<script src=/js/codefold.min.4a43062cb83308b55227adf937c91be79ff6d95df8bb821dfd71805ce54629ff8cffed3ae81d70fdee5f324fa0f39c5280ae785f165801885db074551a993a21.js></script>
</body>
</html>