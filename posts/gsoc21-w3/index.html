<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[Rohit Goswami]"><meta name=description content="Standard practice pragmatic approaches to kind for dftatom
Background Serialized update for the 2021 Google Summer of Code under the fortran-lang organization, mentored by Ondrej Certik.
Logistics Met with Ondrej on Tuesday Went over my kind implementation Merged older approved MRs Worked on generating tests Talked about the test methodology in general Most of the tests are better off in their integration form (discussed below) Some aspects of the passes may be tested using the doctest setup Set an additional time to discuss the implementation of assumed length character declarations These are not actually used in any dftatom routines but they are very common for utility functions Met with Ondrej on Thursday Discussed repercussions of backends Better, more explicit ASR rules can stem from not relying on the CPP backend Talked about the number of passes (SRC-&amp;gt;AST-&amp;gt;ASR-&amp;gt;LLVM) Started working on getting the right thing happen when faced with character(len=*) Overview This week also saw an increase in community activities on the Fortran discourse, since the J3 meeting is now underway and user polling¬†1 is in full swing."><meta name=keywords content="personal,gsoc21,fortran,rambling"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rgoswami.me/posts/gsoc21-w3/><meta name=generator content="Wooframework"><title>GSoC21 W3: Kind, Characters, and Standards :: Rohit Goswami ‚Äî Reflections
</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.054e30538b054b321af6575a7659f551cec63e1cef6bbd674acccadf856d3aff.css><meta itemprop=name content="GSoC21 W3: Kind, Characters, and Standards"><meta itemprop=description content="Standard practice pragmatic approaches to kind for dftatom
Background Serialized update for the 2021 Google Summer of Code under the fortran-lang organization, mentored by Ondrej Certik.
Logistics Met with Ondrej on Tuesday Went over my kind implementation Merged older approved MRs Worked on generating tests Talked about the test methodology in general Most of the tests are better off in their integration form (discussed below) Some aspects of the passes may be tested using the doctest setup Set an additional time to discuss the implementation of assumed length character declarations These are not actually used in any dftatom routines but they are very common for utility functions Met with Ondrej on Thursday Discussed repercussions of backends Better, more explicit ASR rules can stem from not relying on the CPP backend Talked about the number of passes (SRC->AST->ASR->LLVM) Started working on getting the right thing happen when faced with character(len=*) Overview This week also saw an increase in community activities on the Fortran discourse, since the J3 meeting is now underway and user polling¬†1 is in full swing."><meta itemprop=datePublished content="2021-06-26T00:28:00+00:00"><meta itemprop=dateModified content="2021-06-26T00:28:00+00:00"><meta itemprop=wordCount content="1185"><meta itemprop=image content="https://rgoswami.me/images/RG.png"><meta itemprop=keywords content="gsoc21,fortran,rambling,"><meta property="og:title" content="GSoC21 W3: Kind, Characters, and Standards"><meta property="og:description" content="Standard practice pragmatic approaches to kind for dftatom
Background Serialized update for the 2021 Google Summer of Code under the fortran-lang organization, mentored by Ondrej Certik.
Logistics Met with Ondrej on Tuesday Went over my kind implementation Merged older approved MRs Worked on generating tests Talked about the test methodology in general Most of the tests are better off in their integration form (discussed below) Some aspects of the passes may be tested using the doctest setup Set an additional time to discuss the implementation of assumed length character declarations These are not actually used in any dftatom routines but they are very common for utility functions Met with Ondrej on Thursday Discussed repercussions of backends Better, more explicit ASR rules can stem from not relying on the CPP backend Talked about the number of passes (SRC->AST->ASR->LLVM) Started working on getting the right thing happen when faced with character(len=*) Overview This week also saw an increase in community activities on the Fortran discourse, since the J3 meeting is now underway and user polling¬†1 is in full swing."><meta property="og:type" content="article"><meta property="og:url" content="https://rgoswami.me/posts/gsoc21-w3/"><meta property="og:image" content="https://rgoswami.me/images/RG.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-06-26T00:28:00+00:00"><meta property="article:modified_time" content="2021-06-26T00:28:00+00:00"><meta property="og:see_also" content="https://rgoswami.me/posts/gsoc21-fin-reprot/"><meta property="og:see_also" content="https://rgoswami.me/posts/gsoc21-w10/"><meta property="og:see_also" content="https://rgoswami.me/posts/gsoc21-w9/"><meta property="og:see_also" content="https://rgoswami.me/posts/gsoc21-w8/"><meta property="og:see_also" content="https://rgoswami.me/posts/gsoc21-w7/"><meta property="og:see_also" content="https://rgoswami.me/posts/gsoc21-w6/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rgoswami.me/images/RG.png"><meta name=twitter:title content="GSoC21 W3: Kind, Characters, and Standards"><meta name=twitter:description content="Standard practice pragmatic approaches to kind for dftatom
Background Serialized update for the 2021 Google Summer of Code under the fortran-lang organization, mentored by Ondrej Certik.
Logistics Met with Ondrej on Tuesday Went over my kind implementation Merged older approved MRs Worked on generating tests Talked about the test methodology in general Most of the tests are better off in their integration form (discussed below) Some aspects of the passes may be tested using the doctest setup Set an additional time to discuss the implementation of assumed length character declarations These are not actually used in any dftatom routines but they are very common for utility functions Met with Ondrej on Thursday Discussed repercussions of backends Better, more explicit ASR rules can stem from not relying on the CPP backend Talked about the number of passes (SRC->AST->ASR->LLVM) Started working on getting the right thing happen when faced with character(len=*) Overview This week also saw an increase in community activities on the Fortran discourse, since the J3 meeting is now underway and user polling¬†1 is in full swing."><meta property="article:section" content="notes"><meta property="article:published_time" content="2021-06-26 00:28:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><div class=header__inner><div class=header__left><div class=logo><a href=/ style=text-decoration:none><img src=/images/home.png alt></a></div></div><div class=header__mid><button class=button><div class=button__text><a href=https://rgoswami.me//search>Search</a></div></button></div><div class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>Blog</a></li><li><a href=/series>Series</a></li></ul><ul class=menu__inner><li><a href=/categories>Categories</a></li><li><a href=/snippets>Snippets</a></li><li><a href=/tags>Tags</a></li></ul></nav><button id=toggleMenu><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></div></button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></button></div></div></header><script src=/js/mathjax-config.js></script><script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script><aside class=sidebar><div class=hideTOC><button id=tocTog>TOC</button><div class="sideTOC m-fadeOut"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#logistics>Logistics</a></li><li><a href=#overview>Overview</a><ul><li><a href=#new-merge-requests>New Merge Requests</a></li><li><a href=#freshly-assigned-issues>Freshly Assigned Issues</a></li><li><a href=#additional-tasks>Additional Tasks</a></li></ul></li><li><a href=#kinds>Kinds</a></li><li><a href=#tests>Tests</a><ul><li><a href=#fortran-integration-tests>Fortran Integration Tests</a></li><li><a href=#unit-tests-for-passes>Unit Tests for Passes</a></li></ul></li><li><a href=#towards-assumed-lengths>Towards Assumed Lengths</a></li><li><a href=#conclusions>Conclusions</a></li><li><a href=#references>References</a></li></ul></nav></div></div></aside><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>6 minutes<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Written: 2021-06-26 00:28 +0000</p></p></div><article class=h-entry><h1 class="post-title p-name"><a class=u-url href=https://rgoswami.me/posts/gsoc21-w3/>GSoC21 W3: Kind, Characters, and Standards</a></h1><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pen-tool"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg><span class="author u-author p-author"><a href=/author/rohit-goswami>Rohit Goswami</a></span></div><hr><aside id=toc class=sidebar><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#logistics>Logistics</a></li><li><a href=#overview>Overview</a><ul><li><a href=#new-merge-requests>New Merge Requests</a></li><li><a href=#freshly-assigned-issues>Freshly Assigned Issues</a></li><li><a href=#additional-tasks>Additional Tasks</a></li></ul></li><li><a href=#kinds>Kinds</a></li><li><a href=#tests>Tests</a><ul><li><a href=#fortran-integration-tests>Fortran Integration Tests</a></li><li><a href=#unit-tests-for-passes>Unit Tests for Passes</a></li></ul></li><li><a href=#towards-assumed-lengths>Towards Assumed Lengths</a></li><li><a href=#conclusions>Conclusions</a></li><li><a href=#references>References</a></li></ul></nav></aside><hr><div class="post-content e-content"><div class="notice--info post-series-top"><p>This post is part of the &lt;a href="https://rgoswami.me/series/gsoc21-lfortran/">GSoC21: LFortran&lt;/a> series.</p></div><blockquote><p>Standard practice pragmatic approaches to <code>kind</code> for <code>dftatom</code></p></blockquote><h2 id=background>Background</h2><p>Serialized update for the <a href=https://summerofcode.withgoogle.com/projects/#5790375215628288>2021 Google Summer of
Code</a>
under the <a href=https://fortran-lang.org/>fortran-lang organization</a>,
mentored by <a href=https://ondrejcertik.com/>Ondrej Certik</a>.</p><h2 id=logistics>Logistics</h2><ul><li>Met with Ondrej on Tuesday<ul><li>Went over my <code>kind</code> implementation</li><li>Merged older approved MRs</li><li>Worked on generating tests</li></ul></li><li>Talked about the test methodology in general<ul><li>Most of the tests are better off in their integration form
(discussed below)</li><li>Some aspects of the passes may be tested using the <code>doctest</code>
setup</li></ul></li><li>Set an additional time to discuss the implementation of <strong>assumed
length</strong> character declarations<ul><li>These are not actually used in any <code>dftatom</code> routines but they
are very common for utility functions</li></ul></li><li>Met with Ondrej on Thursday<ul><li>Discussed repercussions of backends<ul><li>Better, more explicit ASR rules can stem from not relying on
the CPP backend</li></ul></li></ul></li><li>Talked about the number of passes (SRC->AST->ASR->LLVM)</li><li>Started working on getting the right thing happen when faced with
<code>character(len=*)</code></li></ul><h2 id=overview>Overview</h2><p>This week also saw an increase in community activities on the <a href=https://fortran-lang.discourse.group/>Fortran
discourse</a>, since the J3 meeting
is now underway and user polling¬†<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> is in full swing.</p><h3 id=new-merge-requests>New Merge Requests</h3><dl><dt><a href=https://gitlab.com/lfortran/lfortran/-/merge_requests/997/diffs>Implement more kind() (997)</a></dt><dd>Added tests and code to the AST->ASR pass for <code>kind</code> calls relevant
to <code>dftatom</code></dd><dt><a href=https://gitlab.com/lfortran/lfortran/-/merge_requests/1000>Draft: Implement assumed length (1000)</a></dt><dd>More of a trailer for the next week; also happens to be the 1000th
MR (which is neat)</dd></dl><h3 id=freshly-assigned-issues>Freshly Assigned Issues</h3><dl><dt><a href=https://gitlab.com/lfortran/lfortran/-/issues/373>Some more Kind considerations (373)</a></dt><dd>More of a speculative issue about standards compliance, led to the
more concrete and general
<a href=https://gitlab.com/lfortran/lfortran/-/issues/375>375</a></dd></dl><h3 id=additional-tasks>Additional Tasks</h3><p>Still unofficially planning to take a stab at <a href=https://gitlab.com/lfortran/lfortran/-/issues/350>issue
350</a>; regarding the
main <code>lfortran.org</code> site.</p><h2 id=kinds>Kinds</h2><p>The standard allows for any constant to be used in a <code>kind</code> function
call. Some commonly seen variants in the wild are:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fortran data-lang=fortran><span class=line><span class=ln>1</span><span class=cl><span class=k>integer</span><span class=p>,</span><span class=w> </span><span class=k>parameter</span><span class=w> </span><span class=kd>::</span><span class=w> </span><span class=n>dp</span><span class=o>=</span><span class=nb>kind</span><span class=p>(</span><span class=mf>0.d0</span><span class=p>),</span><span class=w> </span><span class=p>&amp;</span><span class=w>             </span><span class=c>! double precision
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=c></span><span class=w>                      </span><span class=n>hp</span><span class=o>=</span><span class=nb>selected_real_kind</span><span class=p>(</span><span class=mi>15</span><span class=p>),</span><span class=w> </span><span class=p>&amp;</span><span class=w> </span><span class=c>! high precision
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=c></span><span class=w>                      </span><span class=n>qp</span><span class=o>=</span><span class=nb>selected_real_kind</span><span class=p>(</span><span class=mi>32</span><span class=p>),</span><span class=w> </span><span class=p>&amp;</span><span class=w> </span><span class=c>! quadruple precision
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=c></span><span class=w>                      </span><span class=n>sp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>kind</span><span class=p>(</span><span class=mf>0.</span><span class=p>)</span><span class=w>                </span><span class=c>! single precision
</span></span></span></code></pre></div><p>Most commonly; <code>kind(0.d0)</code> is seen in the wild. Currently the
<code>lfortran</code> ASR defines:
<code>ConstantInteger, ConstantReal, ConstantComplex, ConstantLogical</code> of
which only <code>ConstantLogical</code> is implemented.</p><p>The idea is that <code>0.</code> is single precision; while <code>1._dp</code>, <code>1.d0</code> or
<code>0.d0</code> are double precision. Essentially then the solution presented
itself naturally; to check if <code>d</code> is present; assign double precision if
true, otherwise stick to single precision. At the moment, <code>lfortran</code>
considers either <code>4</code> for single or <code>8</code> for double.</p><p>More generally, it might be useful to make the single and double
precision values managed by a pre-processor. For the other kinds of
precision, some more thought is required.</p><p>At this stage, it compiles with the LLVM backend.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>lfortran -v -c --show-asr --show-stacktrace lapack.f90
</span></span><span class=line><span class=ln>2</span><span class=cl>lfortran -v -c --backend<span class=o>=</span>llvm --show-stacktrace lapack.f90
</span></span></code></pre></div><h2 id=tests>Tests</h2><p>While implementing I used the simplest of debugging concepts, that of
making manual changes and writing out results. However, no compiler can
survive without rigorous unit tests, and <code>lfortran</code> is no different.</p><h3 id=fortran-integration-tests>Fortran Integration Tests</h3><p>So called because these are run by a <code>python</code> driver and store verbatim
the <code>stdout</code> in files. Note that this form of testing, though
convenient, does require the user to be certain of the test before
writing it; due to the update process it is possible to store the wrong
result and consistently get it wrong.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>./run_tests.py -u <span class=c1># Update</span>
</span></span></code></pre></div><h3 id=unit-tests-for-passes>Unit Tests for Passes</h3><p>These are not favored, as any change in any of the passes causes a large
amount of test metadata to be invalidated. There are some tests of this
nature, and the framework used is <code>doctest</code>.</p><h2 id=towards-assumed-lengths>Towards Assumed Lengths</h2><p>The first step towards implementing assumed lengths was to isolate the
problem, which was done through the age-old comment recompile and test
methodology. The offending function is a rather innocuous looking helper
function:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fortran data-lang=fortran><span class=line><span class=ln> 1</span><span class=cl><span class=k>function</span><span class=w> </span><span class=n>upcase</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=k>result</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=c>! Returns string &#39;s&#39; in uppercase
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=c></span><span class=k>character</span><span class=p>(</span><span class=o>*</span><span class=p>),</span><span class=w> </span><span class=k>intent</span><span class=p>(</span><span class=n>in</span><span class=p>)</span><span class=w> </span><span class=kd>::</span><span class=w> </span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w></span><span class=k>character</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>))</span><span class=w> </span><span class=kd>::</span><span class=w> </span><span class=n>t</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w></span><span class=k>integer</span><span class=w> </span><span class=kd>::</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>diff</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>s</span><span class=p>;</span><span class=w> </span><span class=n>diff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>ichar</span><span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>)</span><span class=o>-</span><span class=nb>ichar</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w></span><span class=k>do</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nb>ichar</span><span class=p>(</span><span class=n>t</span><span class=p>(</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=p>))</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=nb>ichar</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>)</span><span class=w> </span><span class=p>.</span><span class=nb>and</span><span class=p>.</span><span class=w> </span><span class=nb>ichar</span><span class=p>(</span><span class=n>t</span><span class=p>(</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=p>))</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=nb>ichar</span><span class=p>(</span><span class=s1>&#39;z&#39;</span><span class=p>))</span><span class=w> </span><span class=k>then</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>        </span><span class=c>! if lowercase, make uppercase
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=c></span><span class=w>        </span><span class=n>t</span><span class=p>(</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>char</span><span class=p>(</span><span class=nb>ichar</span><span class=p>(</span><span class=n>t</span><span class=p>(</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=p>))</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>diff</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span><span class=k>end</span><span class=w> </span><span class=k>if</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w></span><span class=k>end</span><span class=w> </span><span class=k>do</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w></span><span class=k>end</span><span class=w> </span><span class=k>function</span><span class=w>
</span></span></span></code></pre></div><p>Having zeroed in on a prototypical failure point within <code>dftatom</code>, in
the <code>utils.f90</code> file, the next steps are documented in the relevant
issue and PR.</p><p>The AST representation of the code is :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=o>(</span>TranslationUnit <span class=o>[(</span>Module utils <span class=o>[]</span> <span class=o>[(</span>ImplicitNone <span class=o>[])]</span> <span class=o>[(</span>Declaration <span class=o>()</span> <span class=o>[(</span>SimpleAttribute AttrPrivate<span class=o>)]</span> <span class=o>[])</span> <span class=o>(</span>Declaration <span class=o>()</span> <span class=o>[(</span>SimpleAttribute AttrPublic<span class=o>)]</span> <span class=o>[(</span>upcase <span class=o>[]</span> <span class=o>[]</span> <span class=o>()</span> None <span class=o>())])]</span> <span class=o>[(</span>Function upcase <span class=o>[(</span>s<span class=o>)]</span> <span class=o>[]</span> t <span class=o>()</span> <span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span> <span class=o>[(</span>Declaration <span class=o>(</span>AttrType TypeCharacter <span class=o>[(</span>len <span class=o>()</span> Star<span class=o>)]</span> <span class=o>())</span> <span class=o>[(</span>AttrIntent In<span class=o>)]</span> <span class=o>[(</span>s <span class=o>[]</span> <span class=o>[]</span> <span class=o>()</span> None <span class=o>())])</span> <span class=o>(</span>Declaration <span class=o>(</span>AttrType TypeCharacter <span class=o>[(()</span> <span class=m>20</span> Value<span class=o>)]</span> <span class=o>())</span> <span class=o>[]</span> <span class=o>[(</span>t <span class=o>[]</span> <span class=o>[]</span> <span class=o>()</span> None <span class=o>())])]</span> <span class=o>[]</span> <span class=o>[])])])</span>
</span></span></code></pre></div><p>No simplifications can be expected to occur from the AST representation
to the ASR for this situation so the first order of business is to let
the ASR accept the AST representation and pass it through to the
backend.</p><p>Early on, I considered managing this particular feature in the <code>cpp</code>
backend, but Ondrej pointed out that the ease-of-use features and
guarantees of the <code>cpp</code> compiler would lead to a more sloppy ASR
implementation.</p><h2 id=conclusions>Conclusions</h2><p>This third week led me down the rabbit hole with regards to the
standard, and a statement comes to mind from Clerman and Spector
(<a href=#ref-clermanModernFortranStyle2012>2012</a>):</p><blockquote><p>The standard is the contract between the compiler writer and the
application developer.</p></blockquote><p>For most of my life I&rsquo;ve been the latter, but now, the intricate
legalese of the standard haunts much of my day.</p><p>This attempt at standards level rigor in particular, for <code>kind</code>
(<a href=https://gitlab.com/lfortran/lfortran/-/issues/373>#373</a>) lead to the
discussion on the best way to work with constant expressions at compile
time (<a href=https://gitlab.com/lfortran/lfortran/-/issues/375>#375</a>).</p><p>My vaccination with the single shot Janssen vaccine and subsequent side
effects, have had a deliberating effect. However, the additional meeting
with Ondrej more than made up for it in terms of project productivity.</p><p>I also satiated mostly my interest in the historical development of
&ldquo;automatic coding&rdquo; or compiling as we would now call it in the context
of Fortran largely due to Cipra (<a href=#ref-cipraBest20thCentury>n.d.</a>),
Backus (<a href=#ref-backusHistoryFortranII1998>1998</a>); and its use at the
<a href=https://link.springer.com/chapter/10.1007%2F978-3-642-03757-3_16>University of
Iceland</a>¬†<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.
It is very liberating to be able to keep a public record of my reading
habits and fancies, however 20 hours of text and code consumed along
with ruminative thoughts is rather too much for a single weekly post,
might need to eventually step it up. Other interesting things which just
haven&rsquo;t made the cut for this post include finally going through the
<code>gfortran</code> implementation in some more detail and looking into the
linking and loading process via Levine
(<a href=#ref-levineLinkersLoaders2000>2000</a>).</p><p>The primary goal for next week shall remain implementing assumed length
character arrays and then continuing with the laundry list of <code>dftatom</code>
tests.</p><h2 id=references>References</h2><div id=refs class="references csl-bib-body hanging-indent"><div id=ref-backusHistoryFortranII1998 class=csl-entry><p>Backus, J. 1998. &ldquo;The History of Fortran I, II, and III.&rdquo; <em>IEEE Annals
of the History of Computing</em> 20 (4): 68&ndash;78.
<a href=https://doi.org/10.1109/85.728232>https://doi.org/10.1109/85.728232</a>.</p></div><div id=ref-cipraBest20thCentury class=csl-entry><p>Cipra, Barry A. n.d. &ldquo;The Best of the 20th Century: Editors Name Top 10
Algorithms,&rdquo; 2.</p></div><div id=ref-clermanModernFortranStyle2012 class=csl-entry><p>Clerman, Norman S., and Walter Spector. 2012. <em>Modern Fortran: Style and
Usage</em>. New York: Cambridge University Press.</p></div><div id=ref-levineLinkersLoaders2000 class=csl-entry><p>Levine, John R. 2000. <em>Linkers and Loaders</em>. San Francisco: Morgan
Kaufmann.</p></div></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>For example, this <a href=https://fortran-lang.discourse.group/t/poll-fortran-202x-conditional-expressions-syntax/1425/31>poll on conditional
expressions</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>The community discourse has <a href="https://fortran-lang.discourse.group/t/intel-releases-oneapi-toolkit-free-fortran-2018/471/14?u=rgoswami">historical
records</a>
too&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><hr><div class=post-series-bottom><h2>Series info</h2><h3>GSoC21: LFortran series</h3><ol><li><a href=https://rgoswami.me/posts/gsoc21-w1/>GSoC21 W1: LFortran Kickoff</a></li><li><a href=https://rgoswami.me/posts/gsoc21-w2/>GSoC21 W2: LFortran Unraveling</a></li><li><b>GSoC21 W3: Kind, Characters, and Standards</b> &lt;-- You are here!</li><li><a href=https://rgoswami.me/posts/gsoc21-w4/>GSoC21 W4: LFortran, Backends and Bugs</a></li><li><a href=https://rgoswami.me/posts/gsoc21-w5/>GSoC21 W5: LFortran Design Details and minidftatom</a></li><li><a href=https://rgoswami.me/posts/gsoc21-w6/>GSoC21 W6: LFortran ASR and Values</a></li><li><a href=https://rgoswami.me/posts/gsoc21-w7/>GSoC21 W7: LFortran Workflow Basics</a></li><li><a href=https://rgoswami.me/posts/gsoc21-w8/>GSoC21 W8: LFortran Refactors, and Compile Time Evaluations</a></li><li><a href=https://rgoswami.me/posts/gsoc21-w9/>GSoC21 W9: LFortran Bug Hunting Bonanza</a></li><li><a href=https://rgoswami.me/posts/gsoc21-w10/>GSoC21 W10: LFortran Runtime Library Design</a></li><li><a href=https://rgoswami.me/posts/gsoc21-fin-reprot/>GSoC21 LFortran and Computational Chemistry</a></li></ol></div></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/gsoc21>gsoc21</a></span><span class=tag><a href=/tags/fortran>fortran</a></span><span class=tag><a href=/tags/rambling>rambling</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1185 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Posted: <time class=dt-published>2021-06-26 00:28 +0000</time></p><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frgoswami.me%2fposts%2fgsoc21-w3%2f" target=_blank rel=noopener aria-label=Facebook><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15.84 9.5H13.5V8.48c0-.53.35-.65.6-.65h1.4v-2.3h-2.35c-2.3.0-2.65 1.7-2.65 2.8V9.5h-2v2h2v7h3v-7h2.1l.24-2z"/></svg></div>Facebook</div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=%22GSoC21%20W3%3a%20Kind%2c%20Characters%2c%20and%20Standards%22%20seems%20like%20an%20interesting%20read%20from%20%40rg0swami&amp;url=https%3a%2f%2frgoswami.me%2fposts%2fgsoc21-w3%2f" target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3.0 1 .4 1.7 1.2 2.2-.5.0-1 0-1.2-.3.0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8.0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="12" cy="12" r="11.5"/></svg></div>Twitter</div></a><a class=resp-sharing-button__link href="mailto:?subject=%22GSoC21%20W3%3a%20Kind%2c%20Characters%2c%20and%20Standards%22%20seems%20interesting...&amp;body=https%3a%2f%2frgoswami.me%2fposts%2fgsoc21-w3%2f" target=_self rel=noopener aria-label=E-Mail><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 16c0 .8-.7 1.5-1.5 1.5H6c-.8.0-1.5-.7-1.5-1.5V8c0-.8.7-1.5 1.5-1.5h12c.8.0 1.5.7 1.5 1.5v8zm-2-7.5L12 13 6.5 8.5m11 6-4-2.5m-7 2.5 4-2.5"/><circle cx="12" cy="12" r="11.5"/></svg></div>E-Mail</div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2frgoswami.me%2fposts%2fgsoc21-w3%2f&amp;title=%22GSoC21%20W3%3a%20Kind%2c%20Characters%2c%20and%20Standards%22%20seems%20interesting...&amp;summary=%22GSoC21%20W3%3a%20Kind%2c%20Characters%2c%20and%20Standards%22%20seems%20interesting...&amp;source=https%3a%2f%2frgoswami.me%2fposts%2fgsoc21-w3%2f" target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15 12.5c-.28.0-.5.22-.5.5v3.5h-3s.03-6.48.0-7h3v.83s.46-.75 1.7-.75c1.56.0 2.3 1.12 2.3 3.3v3.62h-3V13c0-.28-.23-.5-.5-.5zm-7.5-3h2v7h-2z"/><circle cx="8.5" cy="6.5" r="1"/></svg></div>LinkedIn</div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2frgoswami.me%2fposts%2fgsoc21-w3%2f&amp;resubmit=true&amp;title=%22GSoC21%20W3%3a%20Kind%2c%20Characters%2c%20and%20Standards%22%20seems%20interesting..." target=_blank rel=noopener aria-label=Reddit><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><ellipse cx="12" cy="14.37" rx="6.2" ry="4.24"/><path d="M14.3 16.25c-.62.36-1.42.57-2.3.57s-1.7-.2-2.32-.58"/><circle cx="14.61" cy="13.39" r=".98"/><circle cx="9.39" cy="13.39" r=".98"/><path d="M16.4 11.38c.26-.55.82-.92 1.47-.92.9.0 1.63.73 1.63 1.63.0.8-.6 1.47-1.38 1.6"/><circle cx="17.22" cy="7.52" r="1.63"/><path d="M7.6 11.38c-.26-.54-.82-.92-1.47-.92-.9.0-1.63.73-1.63 1.63.0.8.6 1.47 1.38 1.6M12 10.12s-.08-4.82 3.6-2.6"/></svg></div>Reddit</div></a><a class=resp-sharing-button__link href="whatsapp://send?text=%22GSoC21%20W3%3a%20Kind%2c%20Characters%2c%20and%20Standards%22%20seems%20interesting...%20https%3a%2f%2frgoswami.me%2fposts%2fgsoc21-w3%2f" target=_blank rel=noopener aria-label=WhatsApp><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle xmlns="http://www.w3.org/2000/svg" cx="12" cy="12" r="11.5"/><path stroke-width="1" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3.0-7.8 3.5-7.8 7.8.0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4.9 3.7.9 4.3.0 7.8-3.5 7.8-7.8.1-2-.7-3.9-2.2-5.4zm-5.5 11.9c-1.2.0-2.3-.3-3.3-.9l-.2-.1-2.4.6.7-2.4-.2-.2c-.6-1-1-2.2-1-3.4.0-3.6 2.9-6.5 6.5-6.5 1.7.0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.4-6.6 6.4zm3.5-4.8c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1s-.5.6-.6.8c-.1.1-.2.1-.4.0s-.8-.3-1.6-1c-.6-.5-1-1.2-1.1-1.3-.1-.2.0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.0-.2.0-.3s-.4-1.1-.6-1.4c-.2-.4-.3-.3-.4-.3h-.4s-.3.0-.5.2-.7.7-.7 1.6c0 1 .7 1.9.8 2s1.4 2.1 3.3 2.9c.5.2.8.3 1.1.4.5.1.9.1 1.2.1.4-.1 1.1-.5 1.3-.9.2-.5.2-.8.1-.9.0-.2-.2-.3-.4-.4z"/></svg></div>WhatsApp</div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://rgoswami.me/posts/iop-caps-webdev-2021-meta/><span class=button__icon>‚Üê</span>
<span class=button__text>Talk Supplements for IOP CAPS'21 Webdev Workshop</span>
</a></span><span class="button next"><a href=https://rgoswami.me/posts/gsoc21-w2/><span class=button__text>GSoC21 W2: LFortran Unraveling</span>
<span class=button__icon>‚Üí</span></a></span></div></div><div id=comments class=thin><div class=pagination__title><span class=pagination__title-h>Comments</span><hr></div><script src=https://utteranc.es/client.js repo=haozeke/haozeke.github.io issue-term=pathname theme=photon-dark label="Utterance üí¨" crossorigin=anonymous async></script></div></main><footer class=footer><p>&copy; 2023
<span><a href=https://rgoswami.me/>Rohit Goswami (HaoZeke)</a></span>
<a href=/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a><br><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br><script src=https://liberapay.com/rohit/widgets/button.js></script><noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript></p></footer></div><script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-109503488-16","auto"),ga("send","pageview")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","3z2xvwqu4u")</script><script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script><script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script><script async src=https://static.getclicky.com/js></script><script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script><script src=/js/codefold.min.f0790269b87613b3bcff64022840fe1991eee3ea384e874c78a24022c9936bd888a3c14a05a10955881eebb1558e4fcf37576dac120cd0bf4ebaf7aca27b35b1.js></script><script src=/js/copyClipboard.min.1c92539aea398296101add0e80508ad94cb59fb37f946f06ec9ca1c7558a961b8de0c5595a921aed70aa91eb94d24db35e5a01243bc625f8b1814b17928f478b.js></script></body></html>