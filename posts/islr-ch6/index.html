<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[Rohit Goswami]"><meta name=description content="Chapter VI - Linear Model Selection and Regularization All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&amp;#34;mlr3&amp;#34;,&amp;#34;data.table&amp;#34;,&amp;#34;mlr3viz&amp;#34;,&amp;#34;mlr3learners&amp;#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
Load ISLR and other libraries.
1libsUsed&amp;lt;-c(&amp;#34;dplyr&amp;#34;,&amp;#34;ggplot2&amp;#34;,&amp;#34;tidyverse&amp;#34;, 2&amp;#34;ISLR&amp;#34;,&amp;#34;caret&amp;#34;,&amp;#34;MASS&amp;#34;, &amp;#34;gridExtra&amp;#34;, 3&amp;#34;pls&amp;#34;,&amp;#34;latex2exp&amp;#34;,&amp;#34;data.table&amp;#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 6.8 - Page 262 In this exercise, we will generate simulated data, and will then use this data to perform best subset selection."><meta name=keywords content=",solutions,R,ISLR"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rgoswami.me/posts/islr-ch6/><title>ISLR :: Linear Model Selection and Regularization :: Rohit Goswami — Reflections</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.b6dbce0fdf6c61563a0c2226e857d5dadd8e5afa2c4f73ec9ea55abd831f9a72.css><meta itemprop=name content="ISLR :: Linear Model Selection and Regularization"><meta itemprop=description content="Chapter VI - Linear Model Selection and Regularization All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
Load ISLR and other libraries.
1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2&#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, 3&#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 6.8 - Page 262 In this exercise, we will generate simulated data, and will then use this data to perform best subset selection."><meta itemprop=datePublished content="2020-02-19T07:00:00+00:00"><meta itemprop=dateModified content="2020-02-19T07:00:00+00:00"><meta itemprop=wordCount content="11986"><meta itemprop=image content="https://rgoswami.me/images/RG.png"><meta itemprop=keywords content="solutions,R,ISLR,"><meta property="og:title" content="ISLR :: Linear Model Selection and Regularization"><meta property="og:description" content="Chapter VI - Linear Model Selection and Regularization All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
Load ISLR and other libraries.
1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2&#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, 3&#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 6.8 - Page 262 In this exercise, we will generate simulated data, and will then use this data to perform best subset selection."><meta property="og:type" content="article"><meta property="og:url" content="https://rgoswami.me/posts/islr-ch6/"><meta property="og:image" content="https://rgoswami.me/images/RG.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-19T07:00:00+00:00"><meta property="article:modified_time" content="2020-02-19T07:00:00+00:00"><meta property="og:site_name" content="Rohit Goswami"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rgoswami.me/images/RG.png"><meta name=twitter:title content="ISLR :: Linear Model Selection and Regularization"><meta name=twitter:description content="Chapter VI - Linear Model Selection and Regularization All the questions are as per the ISL seventh printing of the First edition1.
Common Instead of using the standard functions, we will leverage the mlr3 package2.
1#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;) Actually for R version 3.6.2, the steps to get it working were a bit more involved.
Load ISLR and other libraries.
1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2&#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, 3&#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 6.8 - Page 262 In this exercise, we will generate simulated data, and will then use this data to perform best subset selection."><meta property="article:section" content="programming"><meta property="article:published_time" content="2020-02-19 07:00:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><div class=header__inner><div class=header__left><div class=logo><a href=/ style=text-decoration:none><img src=/images/home.png alt></a></div></div><div class=header__mid><button class=button><div class=button__text><a href=https://rgoswami.me//search>Search</a></div></button></div><div class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://rgoswami.me/about>About</a></li><li><a href=https://rgoswami.me/posts>Blog</a></li></ul><ul class=menu__inner><li><a href=https://rgoswami.me/categories>Categories</a></li><li><a href=https://rgoswami.me/tags>Tags</a></li></ul></nav><button id=toggleMenu><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></div></button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></button></div></div></header><script src=https://rgoswami.me/js/mathjax-config.js></script>
<script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script><aside class=sidebar><div class=hideTOC><button id=tocTog>TOC</button><div class="sideTOC m-fadeOut"><nav id=TableOfContents><ul><li><a href=#chapter-vi---linear-model-selection-and-regularization>Chapter VI - Linear Model Selection and Regularization</a><ul><li><a href=#common>Common</a></li></ul></li><li><a href=#question-6.8---page-262>Question 6.8 - Page 262</a><ul><li><a href=#answer>Answer</a></li></ul></li><li><a href=#question-6.9---page-263>Question 6.9 - Page 263</a><ul><li><a href=#answer-1>Answer</a></li></ul></li><li><a href=#question-6.10---pages-263-264>Question 6.10 - Pages 263-264</a><ul><li><a href=#answer-2>Answer</a></li></ul></li><li><a href=#question-6.11---page-264>Question 6.11 - Page 264</a><ul><li><a href=#answer-3>Answer</a></li></ul></li></ul></nav></div></div></aside><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>57 minutes<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Written: 2020-02-19 07:00 +0000</p></p></div><article class=h-entry><h1 class="post-title p-name"><a class=u-url href=https://rgoswami.me/posts/islr-ch6/>ISLR :: Linear Model Selection and Regularization</a></h1><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pen-tool"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg><span class="author u-author p-author"><a href=https://rgoswami.me/author/rohit-goswami>Rohit Goswami</a></span></div><hr><aside id=toc class=sidebar><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#chapter-vi---linear-model-selection-and-regularization>Chapter VI - Linear Model Selection and Regularization</a><ul><li><a href=#common>Common</a></li></ul></li><li><a href=#question-6.8---page-262>Question 6.8 - Page 262</a><ul><li><a href=#answer>Answer</a></li></ul></li><li><a href=#question-6.9---page-263>Question 6.9 - Page 263</a><ul><li><a href=#answer-1>Answer</a></li></ul></li><li><a href=#question-6.10---pages-263-264>Question 6.10 - Pages 263-264</a><ul><li><a href=#answer-2>Answer</a></li></ul></li><li><a href=#question-6.11---page-264>Question 6.11 - Page 264</a><ul><li><a href=#answer-3>Answer</a></li></ul></li></ul></nav></aside><hr><div class="post-content e-content"><h2 id=chapter-vi---linear-model-selection-and-regularization>Chapter VI - Linear Model Selection and Regularization</h2><p>All the questions are as per the
<a href=https://www.statlearning.com/>ISL seventh
printing of the First edition</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><h3 id=common>Common</h3><p>Instead of using the standard functions, we will leverage the <code>mlr3</code>
package<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1>#install.packages(&#34;mlr3&#34;,&#34;data.table&#34;,&#34;mlr3viz&#34;,&#34;mlr3learners&#34;)</span>
</span></span></code></pre></div><p>Actually for <code>R</code> version <code>3.6.2</code>, the steps to get it working were a bit
more involved.</p><p>Load <code>ISLR</code> and other libraries.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>libsUsed</span><span class=o>&lt;-</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;dplyr&#34;</span><span class=p>,</span><span class=s>&#34;ggplot2&#34;</span><span class=p>,</span><span class=s>&#34;tidyverse&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>            <span class=s>&#34;ISLR&#34;</span><span class=p>,</span><span class=s>&#34;caret&#34;</span><span class=p>,</span><span class=s>&#34;MASS&#34;</span><span class=p>,</span> <span class=s>&#34;gridExtra&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>            <span class=s>&#34;pls&#34;</span><span class=p>,</span><span class=s>&#34;latex2exp&#34;</span><span class=p>,</span><span class=s>&#34;data.table&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>invisible</span><span class=p>(</span><span class=nf>lapply</span><span class=p>(</span><span class=n>libsUsed</span><span class=p>,</span> <span class=n>library</span><span class=p>,</span> <span class=n>character.only</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=question-6.8---page-262>Question 6.8 - Page 262</h2><p>In this exercise, we will generate simulated data, and will then use
this data to perform best subset selection.</p><p><strong>(a)</strong> Use the =rnorm()=function to generate a predictor \(X\) of length
\(n = 100\), as well as a noise vector \(\eta\) of length \(n = 100\).</p><p><strong>(b)</strong> Generate a response vector \(Y\) of length \(n = 100\) according to
the model \[Y = \beta_0 + \beta_1X + \beta2X^2 + \beta_3X^3 + \eta\],
where \(\beta_{0}\) , \(\beta_{1}\), \(\beta_{2}\), and \(\beta_{3}\) are
constants of your choice.</p><p><strong>(c)</strong> Use the <code>regsubsets()</code> function to perform best subset selection
in order to choose the best model containing the predictors \(X\),
\(X^{2}\), &mldr;, \(X^{10}\). What is the best model obtained according to
\(C_p\) , BIC, and adjusted \(R^2\) ? Show some plots to provide evidence
for your answer, and report the coefficients of the best model obtained.
Note you will need to use the <code>data.frame()</code> function to create a single
data set containing both \(X\) and \(Y\).</p><p><strong>(d)</strong> Repeat (c), using forward stepwise selection and also using
backwards stepwise selection. How does your answer compare to the
results in (c)?</p><p><strong>(e)</strong> Now fit a lasso model to the simulated data, again using \(X\),
\(X^{2}\), &mldr;, \(X^{10}\) as predictors. Use cross-validation to select the
optimal value of \(\lambda\). Create plots of the cross-validation error
as a function of \(\lambda\). Report the resulting coefficient estimates,
and discuss the results obtained.</p><p><strong>(f)</strong> Now generate a response vector Y according to the model
\[Y = \beta_{0} + \beta_{7}X^{7} + \eta,\] and perform best subset
selection and the lasso. Discuss the results obtained.</p><h3 id=answer>Answer</h3><h4 id=a-generate-model>a) Generate model</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>1984</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>x</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>noise</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=m>100</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=b-response-vector>b) Response vector</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>beta</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>43</span><span class=p>,</span><span class=m>5</span><span class=p>,</span><span class=m>3</span><span class=p>,</span><span class=m>6</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>y</span><span class=o>&lt;-</span><span class=n>beta[1]</span> <span class=o>+</span> <span class=n>beta[2]</span><span class=o>*</span><span class=n>x</span> <span class=o>+</span> <span class=n>beta[3]</span><span class=o>*</span><span class=n>x^2</span> <span class=o>+</span> <span class=n>beta[4]</span><span class=o>*</span><span class=n>x^3</span> <span class=o>+</span> <span class=n>noise</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>qplot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-4-1.png></figure><h4 id=c-subset-selection>c) Subset selection</h4><p>Since the question requires it, we will be using the <code>leaps</code> libraries.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>leaps</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>df</span><span class=o>&lt;-</span><span class=nf>data.frame</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>sets</span><span class=o>=</span><span class=nf>regsubsets</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>10</span><span class=p>,</span><span class=n>raw</span><span class=o>=</span><span class=bp>T</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>df</span><span class=p>,</span><span class=n>nvmax</span><span class=o>=</span><span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>sets</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Subset selection object
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: regsubsets.formula(y ~ poly(x, 10, raw = T), data = df, nvmax = 10)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 10 Variables  (and intercept)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##                        Forced in Forced out
</span></span><span class=line><span class=ln> 5</span><span class=cl>## poly(x, 10, raw = T)1      FALSE      FALSE
</span></span><span class=line><span class=ln> 6</span><span class=cl>## poly(x, 10, raw = T)2      FALSE      FALSE
</span></span><span class=line><span class=ln> 7</span><span class=cl>## poly(x, 10, raw = T)3      FALSE      FALSE
</span></span><span class=line><span class=ln> 8</span><span class=cl>## poly(x, 10, raw = T)4      FALSE      FALSE
</span></span><span class=line><span class=ln> 9</span><span class=cl>## poly(x, 10, raw = T)5      FALSE      FALSE
</span></span><span class=line><span class=ln>10</span><span class=cl>## poly(x, 10, raw = T)6      FALSE      FALSE
</span></span><span class=line><span class=ln>11</span><span class=cl>## poly(x, 10, raw = T)7      FALSE      FALSE
</span></span><span class=line><span class=ln>12</span><span class=cl>## poly(x, 10, raw = T)8      FALSE      FALSE
</span></span><span class=line><span class=ln>13</span><span class=cl>## poly(x, 10, raw = T)9      FALSE      FALSE
</span></span><span class=line><span class=ln>14</span><span class=cl>## poly(x, 10, raw = T)10     FALSE      FALSE
</span></span><span class=line><span class=ln>15</span><span class=cl>## 1 subsets of each size up to 10
</span></span><span class=line><span class=ln>16</span><span class=cl>## Selection Algorithm: exhaustive
</span></span><span class=line><span class=ln>17</span><span class=cl>##           poly(x, 10, raw = T)1 poly(x, 10, raw = T)2 poly(x, 10, raw = T)3
</span></span><span class=line><span class=ln>18</span><span class=cl>## 1  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>19</span><span class=cl>## 2  ( 1 )  &#34; &#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>20</span><span class=cl>## 3  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>21</span><span class=cl>## 4  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>22</span><span class=cl>## 5  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>23</span><span class=cl>## 6  ( 1 )  &#34;*&#34;                   &#34; &#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>24</span><span class=cl>## 7  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>25</span><span class=cl>## 8  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>26</span><span class=cl>## 9  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>27</span><span class=cl>## 10  ( 1 ) &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>28</span><span class=cl>##           poly(x, 10, raw = T)4 poly(x, 10, raw = T)5 poly(x, 10, raw = T)6
</span></span><span class=line><span class=ln>29</span><span class=cl>## 1  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>30</span><span class=cl>## 2  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>31</span><span class=cl>## 3  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>32</span><span class=cl>## 4  ( 1 )  &#34;*&#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>33</span><span class=cl>## 5  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>34</span><span class=cl>## 6  ( 1 )  &#34;*&#34;                   &#34; &#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>35</span><span class=cl>## 7  ( 1 )  &#34;*&#34;                   &#34; &#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>36</span><span class=cl>## 8  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>37</span><span class=cl>## 9  ( 1 )  &#34;*&#34;                   &#34; &#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>38</span><span class=cl>## 10  ( 1 ) &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>39</span><span class=cl>##           poly(x, 10, raw = T)7 poly(x, 10, raw = T)8 poly(x, 10, raw = T)9
</span></span><span class=line><span class=ln>40</span><span class=cl>## 1  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>41</span><span class=cl>## 2  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>42</span><span class=cl>## 3  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>43</span><span class=cl>## 4  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>44</span><span class=cl>## 5  ( 1 )  &#34; &#34;                   &#34; &#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>45</span><span class=cl>## 6  ( 1 )  &#34; &#34;                   &#34;*&#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>46</span><span class=cl>## 7  ( 1 )  &#34; &#34;                   &#34;*&#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>47</span><span class=cl>## 8  ( 1 )  &#34; &#34;                   &#34;*&#34;                   &#34; &#34;
</span></span><span class=line><span class=ln>48</span><span class=cl>## 9  ( 1 )  &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>49</span><span class=cl>## 10  ( 1 ) &#34;*&#34;                   &#34;*&#34;                   &#34;*&#34;
</span></span><span class=line><span class=ln>50</span><span class=cl>##           poly(x, 10, raw = T)10
</span></span><span class=line><span class=ln>51</span><span class=cl>## 1  ( 1 )  &#34; &#34;
</span></span><span class=line><span class=ln>52</span><span class=cl>## 2  ( 1 )  &#34; &#34;
</span></span><span class=line><span class=ln>53</span><span class=cl>## 3  ( 1 )  &#34; &#34;
</span></span><span class=line><span class=ln>54</span><span class=cl>## 4  ( 1 )  &#34; &#34;
</span></span><span class=line><span class=ln>55</span><span class=cl>## 5  ( 1 )  &#34;*&#34;
</span></span><span class=line><span class=ln>56</span><span class=cl>## 6  ( 1 )  &#34;*&#34;
</span></span><span class=line><span class=ln>57</span><span class=cl>## 7  ( 1 )  &#34;*&#34;
</span></span><span class=line><span class=ln>58</span><span class=cl>## 8  ( 1 )  &#34;*&#34;
</span></span><span class=line><span class=ln>59</span><span class=cl>## 9  ( 1 )  &#34;*&#34;
</span></span><span class=line><span class=ln>60</span><span class=cl>## 10  ( 1 ) &#34;*&#34;
</span></span></code></pre></div><p>We also want the best parameters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>summarySet</span><span class=o>&lt;-</span><span class=nf>summary</span><span class=p>(</span><span class=n>sets</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>which.min</span><span class=p>(</span><span class=n>summarySet</span><span class=o>$</span><span class=n>cp</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 3
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>which.min</span><span class=p>(</span><span class=n>summarySet</span><span class=o>$</span><span class=n>bic</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 3
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>which.max</span><span class=p>(</span><span class=n>summarySet</span><span class=o>$</span><span class=n>adjr2</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 7
</span></span></code></pre></div><p>We might want to see this as a plot.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>summarySet</span><span class=o>$</span><span class=n>cp</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span> <span class=s>&#34;Subset Size&#34;</span><span class=p>,</span> <span class=n>ylab</span> <span class=o>=</span> <span class=s>&#34;Cp&#34;</span><span class=p>,</span> <span class=n>pch</span> <span class=o>=</span> <span class=m>20</span><span class=p>,</span> <span class=n>type</span> <span class=o>=</span> <span class=s>&#34;l&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>points</span><span class=p>(</span><span class=m>3</span><span class=p>,</span><span class=n>summarySet</span><span class=o>$</span><span class=n>cp[3]</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#39;red&#39;</span><span class=p>,</span><span class=n>lwd</span><span class=o>=</span><span class=m>7</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-7-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>summarySet</span><span class=o>$</span><span class=n>bic</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span> <span class=s>&#34;Subset Size&#34;</span><span class=p>,</span> <span class=n>ylab</span> <span class=o>=</span> <span class=s>&#34;BIC&#34;</span><span class=p>,</span> <span class=n>pch</span> <span class=o>=</span> <span class=m>20</span><span class=p>,</span> <span class=n>type</span> <span class=o>=</span> <span class=s>&#34;l&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>points</span><span class=p>(</span><span class=m>3</span><span class=p>,</span><span class=n>summarySet</span><span class=o>$</span><span class=n>bic[3]</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#39;red&#39;</span><span class=p>,</span><span class=n>lwd</span><span class=o>=</span><span class=m>7</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-8-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>summarySet</span><span class=o>$</span><span class=n>adjr2</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span> <span class=s>&#34;Subset Size&#34;</span><span class=p>,</span> <span class=n>ylab</span> <span class=o>=</span> <span class=s>&#34;Adjusted R2&#34;</span><span class=p>,</span> <span class=n>pch</span> <span class=o>=</span> <span class=m>20</span><span class=p>,</span> <span class=n>type</span> <span class=o>=</span> <span class=s>&#34;l&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>points</span><span class=p>(</span><span class=m>3</span><span class=p>,</span><span class=n>summarySet</span><span class=o>$</span><span class=n>adjr2[3]</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>4</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#39;red&#39;</span><span class=p>,</span><span class=n>lwd</span><span class=o>=</span><span class=m>7</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-9-1.png></figure><p>Lets check the coefficients.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coefficients</span><span class=p>(</span><span class=n>sets</span><span class=p>,</span><span class=n>id</span><span class=o>=</span><span class=m>3</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##           (Intercept) poly(x, 10, raw = T)1 poly(x, 10, raw = T)2
</span></span><span class=line><span class=ln>2</span><span class=cl>##             42.895657              5.108094              3.034408
</span></span><span class=line><span class=ln>3</span><span class=cl>## poly(x, 10, raw = T)3
</span></span><span class=line><span class=ln>4</span><span class=cl>##              5.989367
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>beta</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 43  5  3  6
</span></span></code></pre></div><p>We see that we actually have a pretty good set of coefficients.</p><h4 id=d-forward-and-backward-stepwise-models>d) Forward and backward stepwise models</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelX</span><span class=o>&lt;-</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>10</span><span class=p>,</span><span class=n>raw</span><span class=o>=</span><span class=bp>T</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>forwardFit</span><span class=o>&lt;-</span><span class=nf>regsubsets</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>modelX</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>df</span><span class=p>,</span><span class=n>nvmax</span><span class=o>=</span><span class=m>10</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;forward&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>forwardFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Subset selection object
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: regsubsets.formula(y ~ modelX, data = df, nvmax = 10, method = &#34;forward&#34;)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 10 Variables  (and intercept)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##          Forced in Forced out
</span></span><span class=line><span class=ln> 5</span><span class=cl>## modelX1      FALSE      FALSE
</span></span><span class=line><span class=ln> 6</span><span class=cl>## modelX2      FALSE      FALSE
</span></span><span class=line><span class=ln> 7</span><span class=cl>## modelX3      FALSE      FALSE
</span></span><span class=line><span class=ln> 8</span><span class=cl>## modelX4      FALSE      FALSE
</span></span><span class=line><span class=ln> 9</span><span class=cl>## modelX5      FALSE      FALSE
</span></span><span class=line><span class=ln>10</span><span class=cl>## modelX6      FALSE      FALSE
</span></span><span class=line><span class=ln>11</span><span class=cl>## modelX7      FALSE      FALSE
</span></span><span class=line><span class=ln>12</span><span class=cl>## modelX8      FALSE      FALSE
</span></span><span class=line><span class=ln>13</span><span class=cl>## modelX9      FALSE      FALSE
</span></span><span class=line><span class=ln>14</span><span class=cl>## modelX10     FALSE      FALSE
</span></span><span class=line><span class=ln>15</span><span class=cl>## 1 subsets of each size up to 10
</span></span><span class=line><span class=ln>16</span><span class=cl>## Selection Algorithm: forward
</span></span><span class=line><span class=ln>17</span><span class=cl>##           modelX1 modelX2 modelX3 modelX4 modelX5 modelX6 modelX7 modelX8
</span></span><span class=line><span class=ln>18</span><span class=cl>## 1  ( 1 )  &#34; &#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>19</span><span class=cl>## 2  ( 1 )  &#34; &#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>20</span><span class=cl>## 3  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>21</span><span class=cl>## 4  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>22</span><span class=cl>## 5  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>23</span><span class=cl>## 6  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>24</span><span class=cl>## 7  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;
</span></span><span class=line><span class=ln>25</span><span class=cl>## 8  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>26</span><span class=cl>## 9  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>27</span><span class=cl>## 10  ( 1 ) &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>28</span><span class=cl>##           modelX9 modelX10
</span></span><span class=line><span class=ln>29</span><span class=cl>## 1  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>30</span><span class=cl>## 2  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>31</span><span class=cl>## 3  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>32</span><span class=cl>## 4  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>33</span><span class=cl>## 5  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>34</span><span class=cl>## 6  ( 1 )  &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>35</span><span class=cl>## 7  ( 1 )  &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>36</span><span class=cl>## 8  ( 1 )  &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>37</span><span class=cl>## 9  ( 1 )  &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>38</span><span class=cl>## 10  ( 1 ) &#34;*&#34;     &#34;*&#34;
</span></span></code></pre></div><p>We might want to take a look at these.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>forwardFit</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>forwardFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;Cp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>forwardFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;r2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>forwardFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;adjr2&#39;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-12-1.png></figure><p>I find these not as fun to look at, so we will do better.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln> 1</span><span class=cl><span class=n>plotLEAP</span><span class=o>=</span><span class=nf>function</span><span class=p>(</span><span class=n>leapObj</span><span class=p>){</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>  <span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=n>bar2</span><span class=o>=</span><span class=nf>which.max</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>adjr2</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=n>bbic</span><span class=o>=</span><span class=nf>which.min</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>bic</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=n>bcp</span><span class=o>=</span><span class=nf>which.min</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>cp</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>rss</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#34;RSS&#34;</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>adjr2</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=nf>TeX</span><span class=p>(</span><span class=s>&#34;Adjusted R^2&#34;</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=nf>points</span><span class=p>(</span><span class=n>bar2</span><span class=p>,</span><span class=n>leapObj</span><span class=o>$</span><span class=n>adjr2[bar2]</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#34;green&#34;</span><span class=p>,</span><span class=n>cex</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>bic</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=nf>TeX</span><span class=p>(</span><span class=s>&#34;BIC&#34;</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>  <span class=nf>points</span><span class=p>(</span><span class=n>bbic</span><span class=p>,</span><span class=n>leapObj</span><span class=o>$</span><span class=n>bic[bbic]</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>,</span><span class=n>cex</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>cp</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=nf>TeX</span><span class=p>(</span><span class=s>&#34;C_p&#34;</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  <span class=nf>points</span><span class=p>(</span><span class=n>bcp</span><span class=p>,</span><span class=n>leapObj</span><span class=o>$</span><span class=n>cp[bcp]</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>,</span><span class=n>cex</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plotLEAP</span><span class=p>(</span><span class=n>forwardFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-14-1.png></figure><p>Lets check the backward selection as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelX</span><span class=o>&lt;-</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>10</span><span class=p>,</span><span class=n>raw</span><span class=o>=</span><span class=bp>T</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>backwardFit</span><span class=o>&lt;-</span><span class=nf>regsubsets</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>modelX</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>df</span><span class=p>,</span><span class=n>nvmax</span><span class=o>=</span><span class=m>10</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;backward&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>backwardFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Subset selection object
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: regsubsets.formula(y ~ modelX, data = df, nvmax = 10, method = &#34;backward&#34;)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 10 Variables  (and intercept)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##          Forced in Forced out
</span></span><span class=line><span class=ln> 5</span><span class=cl>## modelX1      FALSE      FALSE
</span></span><span class=line><span class=ln> 6</span><span class=cl>## modelX2      FALSE      FALSE
</span></span><span class=line><span class=ln> 7</span><span class=cl>## modelX3      FALSE      FALSE
</span></span><span class=line><span class=ln> 8</span><span class=cl>## modelX4      FALSE      FALSE
</span></span><span class=line><span class=ln> 9</span><span class=cl>## modelX5      FALSE      FALSE
</span></span><span class=line><span class=ln>10</span><span class=cl>## modelX6      FALSE      FALSE
</span></span><span class=line><span class=ln>11</span><span class=cl>## modelX7      FALSE      FALSE
</span></span><span class=line><span class=ln>12</span><span class=cl>## modelX8      FALSE      FALSE
</span></span><span class=line><span class=ln>13</span><span class=cl>## modelX9      FALSE      FALSE
</span></span><span class=line><span class=ln>14</span><span class=cl>## modelX10     FALSE      FALSE
</span></span><span class=line><span class=ln>15</span><span class=cl>## 1 subsets of each size up to 10
</span></span><span class=line><span class=ln>16</span><span class=cl>## Selection Algorithm: backward
</span></span><span class=line><span class=ln>17</span><span class=cl>##           modelX1 modelX2 modelX3 modelX4 modelX5 modelX6 modelX7 modelX8
</span></span><span class=line><span class=ln>18</span><span class=cl>## 1  ( 1 )  &#34; &#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>19</span><span class=cl>## 2  ( 1 )  &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>20</span><span class=cl>## 3  ( 1 )  &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>21</span><span class=cl>## 4  ( 1 )  &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>22</span><span class=cl>## 5  ( 1 )  &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>23</span><span class=cl>## 6  ( 1 )  &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>24</span><span class=cl>## 7  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>25</span><span class=cl>## 8  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>26</span><span class=cl>## 9  ( 1 )  &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34; &#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>27</span><span class=cl>## 10  ( 1 ) &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>28</span><span class=cl>##           modelX9 modelX10
</span></span><span class=line><span class=ln>29</span><span class=cl>## 1  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>30</span><span class=cl>## 2  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>31</span><span class=cl>## 3  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>32</span><span class=cl>## 4  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>33</span><span class=cl>## 5  ( 1 )  &#34; &#34;     &#34; &#34;
</span></span><span class=line><span class=ln>34</span><span class=cl>## 6  ( 1 )  &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>35</span><span class=cl>## 7  ( 1 )  &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>36</span><span class=cl>## 8  ( 1 )  &#34; &#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>37</span><span class=cl>## 9  ( 1 )  &#34;*&#34;     &#34;*&#34;
</span></span><span class=line><span class=ln>38</span><span class=cl>## 10  ( 1 ) &#34;*&#34;     &#34;*&#34;
</span></span></code></pre></div><p>We might want to take a look at these.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>backwardFit</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>backwardFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;Cp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>backwardFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;r2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>backwardFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;adjr2&#39;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-16-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plotLEAP</span><span class=p>(</span><span class=n>backwardFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-17-1.png></figure><p>In spite of some slight variations, overall all methods converge to the
same <code>best</code> set of parameters, that of the third model.</p><h4 id=e-lasso-and-cross-validation>e) LASSO and Cross Validation</h4><p>For this, instead of using <code>glmnet</code> directly, we will use <code>caret</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>df</span><span class=o>&lt;-</span><span class=n>df</span> <span class=o>%&gt;%</span> <span class=nf>mutate</span><span class=p>(</span><span class=n>x2</span><span class=o>=</span><span class=n>x^2</span><span class=p>,</span><span class=n>x3</span><span class=o>=</span><span class=n>x^3</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                  <span class=n>x4</span><span class=o>=</span><span class=n>x^4</span><span class=p>,</span><span class=n>x5</span><span class=o>=</span><span class=n>x^5</span><span class=p>,</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                  <span class=n>x6</span><span class=o>=</span><span class=n>x^6</span><span class=p>,</span><span class=n>x7</span><span class=o>=</span><span class=n>x^7</span><span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>                  <span class=n>x8</span><span class=o>=</span><span class=n>x^8</span><span class=p>,</span><span class=n>x9</span><span class=o>=</span><span class=n>x^9</span><span class=p>,</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>                  <span class=n>x10</span><span class=o>=</span><span class=n>x^10</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lambda</span><span class=o>&lt;-</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=m>-3</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=n>length</span> <span class=o>=</span> <span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lassoCaret</span><span class=o>=</span> <span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>df</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span><span class=o>=</span><span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>,</span><span class=n>lambda</span><span class=o>=</span><span class=n>lambda</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCaret</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>  1</span><span class=cl>## glmnet
</span></span><span class=line><span class=ln>  2</span><span class=cl>##
</span></span><span class=line><span class=ln>  3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln>  4</span><span class=cl>##  10 predictor
</span></span><span class=line><span class=ln>  5</span><span class=cl>##
</span></span><span class=line><span class=ln>  6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln>  7</span><span class=cl>## Resampling: Bootstrapped (25 reps)
</span></span><span class=line><span class=ln>  8</span><span class=cl>## Summary of sample sizes: 100, 100, 100, 100, 100, 100, ...
</span></span><span class=line><span class=ln>  9</span><span class=cl>## Resampling results across tuning parameters:
</span></span><span class=line><span class=ln> 10</span><span class=cl>##
</span></span><span class=line><span class=ln> 11</span><span class=cl>##   lambda        RMSE       Rsquared   MAE
</span></span><span class=line><span class=ln> 12</span><span class=cl>##   1.000000e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 13</span><span class=cl>##   1.149757e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 14</span><span class=cl>##   1.321941e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 15</span><span class=cl>##   1.519911e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 16</span><span class=cl>##   1.747528e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 17</span><span class=cl>##   2.009233e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 18</span><span class=cl>##   2.310130e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 19</span><span class=cl>##   2.656088e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 20</span><span class=cl>##   3.053856e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 21</span><span class=cl>##   3.511192e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 22</span><span class=cl>##   4.037017e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 23</span><span class=cl>##   4.641589e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 24</span><span class=cl>##   5.336699e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 25</span><span class=cl>##   6.135907e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 26</span><span class=cl>##   7.054802e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 27</span><span class=cl>##   8.111308e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 28</span><span class=cl>##   9.326033e-03   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 29</span><span class=cl>##   1.072267e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 30</span><span class=cl>##   1.232847e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 31</span><span class=cl>##   1.417474e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 32</span><span class=cl>##   1.629751e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 33</span><span class=cl>##   1.873817e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 34</span><span class=cl>##   2.154435e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 35</span><span class=cl>##   2.477076e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 36</span><span class=cl>##   2.848036e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 37</span><span class=cl>##   3.274549e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 38</span><span class=cl>##   3.764936e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 39</span><span class=cl>##   4.328761e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 40</span><span class=cl>##   4.977024e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 41</span><span class=cl>##   5.722368e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 42</span><span class=cl>##   6.579332e-02   1.009696  0.9965632   0.8051425
</span></span><span class=line><span class=ln> 43</span><span class=cl>##   7.564633e-02   1.009637  0.9965632   0.8050666
</span></span><span class=line><span class=ln> 44</span><span class=cl>##   8.697490e-02   1.009216  0.9965637   0.8047862
</span></span><span class=line><span class=ln> 45</span><span class=cl>##   1.000000e-01   1.008901  0.9965636   0.8046468
</span></span><span class=line><span class=ln> 46</span><span class=cl>##   1.149757e-01   1.009470  0.9965616   0.8054790
</span></span><span class=line><span class=ln> 47</span><span class=cl>##   1.321941e-01   1.011206  0.9965561   0.8074253
</span></span><span class=line><span class=ln> 48</span><span class=cl>##   1.519911e-01   1.014475  0.9965476   0.8104930
</span></span><span class=line><span class=ln> 49</span><span class=cl>##   1.747528e-01   1.019202  0.9965383   0.8147296
</span></span><span class=line><span class=ln> 50</span><span class=cl>##   2.009233e-01   1.025943  0.9965259   0.8203974
</span></span><span class=line><span class=ln> 51</span><span class=cl>##   2.310130e-01   1.035374  0.9965094   0.8284187
</span></span><span class=line><span class=ln> 52</span><span class=cl>##   2.656088e-01   1.048294  0.9964878   0.8393282
</span></span><span class=line><span class=ln> 53</span><span class=cl>##   3.053856e-01   1.065717  0.9964592   0.8530952
</span></span><span class=line><span class=ln> 54</span><span class=cl>##   3.511192e-01   1.088903  0.9964215   0.8701072
</span></span><span class=line><span class=ln> 55</span><span class=cl>##   4.037017e-01   1.119433  0.9963715   0.8918217
</span></span><span class=line><span class=ln> 56</span><span class=cl>##   4.641589e-01   1.158919  0.9963053   0.9193677
</span></span><span class=line><span class=ln> 57</span><span class=cl>##   5.336699e-01   1.209841  0.9962136   0.9532842
</span></span><span class=line><span class=ln> 58</span><span class=cl>##   6.135907e-01   1.275467  0.9960778   0.9957151
</span></span><span class=line><span class=ln> 59</span><span class=cl>##   7.054802e-01   1.357247  0.9958966   1.0471169
</span></span><span class=line><span class=ln> 60</span><span class=cl>##   8.111308e-01   1.457886  0.9956561   1.1087362
</span></span><span class=line><span class=ln> 61</span><span class=cl>##   9.326033e-01   1.580743  0.9953362   1.1818188
</span></span><span class=line><span class=ln> 62</span><span class=cl>##   1.072267e+00   1.729330  0.9949070   1.2696235
</span></span><span class=line><span class=ln> 63</span><span class=cl>##   1.232847e+00   1.907599  0.9943306   1.3758463
</span></span><span class=line><span class=ln> 64</span><span class=cl>##   1.417474e+00   2.120178  0.9935518   1.5059031
</span></span><span class=line><span class=ln> 65</span><span class=cl>##   1.629751e+00   2.369642  0.9924954   1.6673393
</span></span><span class=line><span class=ln> 66</span><span class=cl>##   1.873817e+00   2.662906  0.9910539   1.8621728
</span></span><span class=line><span class=ln> 67</span><span class=cl>##   2.154435e+00   3.007271  0.9890638   2.0978907
</span></span><span class=line><span class=ln> 68</span><span class=cl>##   2.477076e+00   3.409377  0.9863097   2.3788439
</span></span><span class=line><span class=ln> 69</span><span class=cl>##   2.848036e+00   3.864727  0.9825900   2.7053428
</span></span><span class=line><span class=ln> 70</span><span class=cl>##   3.274549e+00   4.350785  0.9778541   3.0659309
</span></span><span class=line><span class=ln> 71</span><span class=cl>##   3.764936e+00   4.847045  0.9724311   3.4403210
</span></span><span class=line><span class=ln> 72</span><span class=cl>##   4.328761e+00   5.369017  0.9668240   3.8351441
</span></span><span class=line><span class=ln> 73</span><span class=cl>##   4.977024e+00   5.919492  0.9626812   4.2512694
</span></span><span class=line><span class=ln> 74</span><span class=cl>##   5.722368e+00   6.562134  0.9580843   4.7389049
</span></span><span class=line><span class=ln> 75</span><span class=cl>##   6.579332e+00   7.307112  0.9534537   5.2945905
</span></span><span class=line><span class=ln> 76</span><span class=cl>##   7.564633e+00   8.132296  0.9500300   5.8774541
</span></span><span class=line><span class=ln> 77</span><span class=cl>##   8.697490e+00   9.067321  0.9486589   6.4760997
</span></span><span class=line><span class=ln> 78</span><span class=cl>##   1.000000e+01  10.167822  0.9483195   7.1226569
</span></span><span class=line><span class=ln> 79</span><span class=cl>##   1.149757e+01  11.473284  0.9482975   7.8556639
</span></span><span class=line><span class=ln> 80</span><span class=cl>##   1.321941e+01  13.002703  0.9482975   8.6990451
</span></span><span class=line><span class=ln> 81</span><span class=cl>##   1.519911e+01  14.727852  0.9454119   9.6414650
</span></span><span class=line><span class=ln> 82</span><span class=cl>##   1.747528e+01  16.325210  0.9426796  10.5303097
</span></span><span class=line><span class=ln> 83</span><span class=cl>##   2.009233e+01  17.740599  0.9357286  11.3560865
</span></span><span class=line><span class=ln> 84</span><span class=cl>##   2.310130e+01  18.585795  0.9227167  11.8799668
</span></span><span class=line><span class=ln> 85</span><span class=cl>##   2.656088e+01  18.939596  0.9080584  12.1336575
</span></span><span class=line><span class=ln> 86</span><span class=cl>##   3.053856e+01  19.123568  0.9109065  12.2733471
</span></span><span class=line><span class=ln> 87</span><span class=cl>##   3.511192e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 88</span><span class=cl>##   4.037017e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 89</span><span class=cl>##   4.641589e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 90</span><span class=cl>##   5.336699e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 91</span><span class=cl>##   6.135907e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 92</span><span class=cl>##   7.054802e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 93</span><span class=cl>##   8.111308e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 94</span><span class=cl>##   9.326033e+01  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 95</span><span class=cl>##   1.072267e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 96</span><span class=cl>##   1.232847e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 97</span><span class=cl>##   1.417474e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 98</span><span class=cl>##   1.629751e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln> 99</span><span class=cl>##   1.873817e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>100</span><span class=cl>##   2.154435e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>101</span><span class=cl>##   2.477076e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>102</span><span class=cl>##   2.848036e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>103</span><span class=cl>##   3.274549e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>104</span><span class=cl>##   3.764936e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>105</span><span class=cl>##   4.328761e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>106</span><span class=cl>##   4.977024e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>107</span><span class=cl>##   5.722368e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>108</span><span class=cl>##   6.579332e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>109</span><span class=cl>##   7.564633e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>110</span><span class=cl>##   8.697490e+02  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>111</span><span class=cl>##   1.000000e+03  19.197966        NaN  12.3308613
</span></span><span class=line><span class=ln>112</span><span class=cl>##
</span></span><span class=line><span class=ln>113</span><span class=cl>## Tuning parameter &#39;alpha&#39; was held constant at a value of 1
</span></span><span class=line><span class=ln>114</span><span class=cl>## RMSE was used to select the optimal model using the smallest value.
</span></span><span class=line><span class=ln>115</span><span class=cl>## The final values used for the model were alpha = 1 and lambda = 0.1.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCaret</span>  <span class=o>%&gt;%</span> <span class=n>ggplot</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-20-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCaret</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-21-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>glmnet</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Loading required package: Matrix
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##
</span></span><span class=line><span class=ln>2</span><span class=cl>## Attaching package: &#39;Matrix&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## The following objects are masked from &#39;package:tidyr&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##
</span></span><span class=line><span class=ln>3</span><span class=cl>##     expand, pack, unpack
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Loaded glmnet 3.0-2
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>boot</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##
</span></span><span class=line><span class=ln>2</span><span class=cl>## Attaching package: &#39;boot&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## The following object is masked from &#39;package:lattice&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##
</span></span><span class=line><span class=ln>3</span><span class=cl>##     melanoma
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lasso.mod</span> <span class=o>&lt;-</span> <span class=nf>cv.glmnet</span><span class=p>(</span><span class=nf>as.matrix</span><span class=p>(</span><span class=n>df[</span><span class=m>-1</span><span class=n>]</span><span class=p>),</span> <span class=n>y</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lambda</span> <span class=o>&lt;-</span> <span class=n>lasso.mod</span><span class=o>$</span><span class=n>lambda.min</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>lasso.mod</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-22-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>predict</span><span class=p>(</span><span class=n>lasso.mod</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=n>lambda</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;coefficients&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 11 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                     1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept) 42.975240
</span></span><span class=line><span class=ln> 4</span><span class=cl>## x            5.005023
</span></span><span class=line><span class=ln> 5</span><span class=cl>## x2           2.947540
</span></span><span class=line><span class=ln> 6</span><span class=cl>## x3           5.989105
</span></span><span class=line><span class=ln> 7</span><span class=cl>## x4           .
</span></span><span class=line><span class=ln> 8</span><span class=cl>## x5           .
</span></span><span class=line><span class=ln> 9</span><span class=cl>## x6           .
</span></span><span class=line><span class=ln>10</span><span class=cl>## x7           .
</span></span><span class=line><span class=ln>11</span><span class=cl>## x8           .
</span></span><span class=line><span class=ln>12</span><span class=cl>## x9           .
</span></span><span class=line><span class=ln>13</span><span class=cl>## x10          .
</span></span></code></pre></div><p>Clearly, the only important variables are \(x\), \(x^2\) and \(x^3\).</p><h4 id=f-new-model>f) New model</h4><p>Our new model requires a newly expanded set of betas as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>y2</span><span class=o>&lt;-</span><span class=n>beta[1]</span><span class=m>+23</span><span class=o>*</span><span class=n>x^7</span><span class=o>+</span><span class=n>noise</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelX</span><span class=o>&lt;-</span><span class=nf>poly</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=m>10</span><span class=p>,</span><span class=n>raw</span><span class=o>=</span><span class=bp>T</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>newDF</span><span class=o>&lt;-</span><span class=nf>data.frame</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=nf>as.matrix</span><span class=p>(</span><span class=n>modelX</span><span class=p>),</span><span class=n>y</span><span class=o>=</span><span class=n>y2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>newSub</span><span class=o>&lt;-</span><span class=nf>regsubsets</span><span class=p>(</span><span class=n>y2</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>newDF</span><span class=p>,</span><span class=n>nvmax</span><span class=o>=</span><span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>newSub</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Subset selection object
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: regsubsets.formula(y2 ~ ., data = newDF, nvmax = 10)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 11 Variables  (and intercept)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##      Forced in Forced out
</span></span><span class=line><span class=ln> 5</span><span class=cl>## x.1      FALSE      FALSE
</span></span><span class=line><span class=ln> 6</span><span class=cl>## x.2      FALSE      FALSE
</span></span><span class=line><span class=ln> 7</span><span class=cl>## x.3      FALSE      FALSE
</span></span><span class=line><span class=ln> 8</span><span class=cl>## x.4      FALSE      FALSE
</span></span><span class=line><span class=ln> 9</span><span class=cl>## x.5      FALSE      FALSE
</span></span><span class=line><span class=ln>10</span><span class=cl>## x.6      FALSE      FALSE
</span></span><span class=line><span class=ln>11</span><span class=cl>## x.7      FALSE      FALSE
</span></span><span class=line><span class=ln>12</span><span class=cl>## x.8      FALSE      FALSE
</span></span><span class=line><span class=ln>13</span><span class=cl>## x.9      FALSE      FALSE
</span></span><span class=line><span class=ln>14</span><span class=cl>## x.10     FALSE      FALSE
</span></span><span class=line><span class=ln>15</span><span class=cl>## y        FALSE      FALSE
</span></span><span class=line><span class=ln>16</span><span class=cl>## 1 subsets of each size up to 10
</span></span><span class=line><span class=ln>17</span><span class=cl>## Selection Algorithm: exhaustive
</span></span><span class=line><span class=ln>18</span><span class=cl>##           x.1 x.2 x.3 x.4 x.5 x.6 x.7 x.8 x.9 x.10 y
</span></span><span class=line><span class=ln>19</span><span class=cl>## 1  ( 1 )  &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>20</span><span class=cl>## 2  ( 1 )  &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>21</span><span class=cl>## 3  ( 1 )  &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>22</span><span class=cl>## 4  ( 1 )  &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>23</span><span class=cl>## 5  ( 1 )  &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>24</span><span class=cl>## 6  ( 1 )  &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>25</span><span class=cl>## 7  ( 1 )  &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>26</span><span class=cl>## 8  ( 1 )  &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>27</span><span class=cl>## 9  ( 1 )  &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34; &#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>28</span><span class=cl>## 10  ( 1 ) &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plotLEAP</span><span class=p>(</span><span class=n>newSub</span> <span class=o>%&gt;%</span> <span class=n>summary</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-25-1.png></figure><p>Or in its more native look,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>newSub</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>newSub</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;Cp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>newSub</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;r2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>newSub</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;adjr2&#39;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-26-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>glmnet</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>boot</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>lasso.mod2</span> <span class=o>&lt;-</span> <span class=nf>cv.glmnet</span><span class=p>(</span><span class=nf>as.matrix</span><span class=p>(</span><span class=n>newDF[</span><span class=m>-1</span><span class=n>]</span><span class=p>),</span> <span class=n>y</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>lambda2</span> <span class=o>&lt;-</span> <span class=n>lasso.mod2</span><span class=o>$</span><span class=n>lambda.min</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>lasso.mod2</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-27-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>predict</span><span class=p>(</span><span class=n>lasso.mod2</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=n>lambda</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;coefficients&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 11 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                       1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept) 42.67982691
</span></span><span class=line><span class=ln> 4</span><span class=cl>## x.2          3.22521396
</span></span><span class=line><span class=ln> 5</span><span class=cl>## x.3          8.56699146
</span></span><span class=line><span class=ln> 6</span><span class=cl>## x.4          .
</span></span><span class=line><span class=ln> 7</span><span class=cl>## x.5         -0.10229572
</span></span><span class=line><span class=ln> 8</span><span class=cl>## x.6          .
</span></span><span class=line><span class=ln> 9</span><span class=cl>## x.7         -0.03184905
</span></span><span class=line><span class=ln>10</span><span class=cl>## x.8          .
</span></span><span class=line><span class=ln>11</span><span class=cl>## x.9          .
</span></span><span class=line><span class=ln>12</span><span class=cl>## x.10         .
</span></span><span class=line><span class=ln>13</span><span class=cl>## y            .
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lambda</span><span class=o>&lt;-</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=m>-3</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=n>length</span> <span class=o>=</span> <span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lassocaret2</span><span class=o>=</span> <span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>newDF</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span><span class=o>=</span><span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>,</span><span class=n>lambda</span><span class=o>=</span><span class=n>lambda</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassocaret2</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>  1</span><span class=cl>## glmnet
</span></span><span class=line><span class=ln>  2</span><span class=cl>##
</span></span><span class=line><span class=ln>  3</span><span class=cl>## 100 samples
</span></span><span class=line><span class=ln>  4</span><span class=cl>##  10 predictor
</span></span><span class=line><span class=ln>  5</span><span class=cl>##
</span></span><span class=line><span class=ln>  6</span><span class=cl>## No pre-processing
</span></span><span class=line><span class=ln>  7</span><span class=cl>## Resampling: Bootstrapped (25 reps)
</span></span><span class=line><span class=ln>  8</span><span class=cl>## Summary of sample sizes: 100, 100, 100, 100, 100, 100, ...
</span></span><span class=line><span class=ln>  9</span><span class=cl>## Resampling results across tuning parameters:
</span></span><span class=line><span class=ln> 10</span><span class=cl>##
</span></span><span class=line><span class=ln> 11</span><span class=cl>##   lambda        RMSE        Rsquared   MAE
</span></span><span class=line><span class=ln> 12</span><span class=cl>##   1.000000e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 13</span><span class=cl>##   1.149757e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 14</span><span class=cl>##   1.321941e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 15</span><span class=cl>##   1.519911e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 16</span><span class=cl>##   1.747528e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 17</span><span class=cl>##   2.009233e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 18</span><span class=cl>##   2.310130e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 19</span><span class=cl>##   2.656088e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 20</span><span class=cl>##   3.053856e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 21</span><span class=cl>##   3.511192e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 22</span><span class=cl>##   4.037017e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 23</span><span class=cl>##   4.641589e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 24</span><span class=cl>##   5.336699e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 25</span><span class=cl>##   6.135907e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 26</span><span class=cl>##   7.054802e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 27</span><span class=cl>##   8.111308e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 28</span><span class=cl>##   9.326033e-03    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 29</span><span class=cl>##   1.072267e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 30</span><span class=cl>##   1.232847e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 31</span><span class=cl>##   1.417474e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 32</span><span class=cl>##   1.629751e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 33</span><span class=cl>##   1.873817e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 34</span><span class=cl>##   2.154435e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 35</span><span class=cl>##   2.477076e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 36</span><span class=cl>##   2.848036e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 37</span><span class=cl>##   3.274549e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 38</span><span class=cl>##   3.764936e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 39</span><span class=cl>##   4.328761e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 40</span><span class=cl>##   4.977024e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 41</span><span class=cl>##   5.722368e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 42</span><span class=cl>##   6.579332e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 43</span><span class=cl>##   7.564633e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 44</span><span class=cl>##   8.697490e-02    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 45</span><span class=cl>##   1.000000e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 46</span><span class=cl>##   1.149757e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 47</span><span class=cl>##   1.321941e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 48</span><span class=cl>##   1.519911e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 49</span><span class=cl>##   1.747528e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 50</span><span class=cl>##   2.009233e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 51</span><span class=cl>##   2.310130e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 52</span><span class=cl>##   2.656088e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 53</span><span class=cl>##   3.053856e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 54</span><span class=cl>##   3.511192e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 55</span><span class=cl>##   4.037017e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 56</span><span class=cl>##   4.641589e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 57</span><span class=cl>##   5.336699e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 58</span><span class=cl>##   6.135907e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 59</span><span class=cl>##   7.054802e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 60</span><span class=cl>##   8.111308e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 61</span><span class=cl>##   9.326033e-01    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 62</span><span class=cl>##   1.072267e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 63</span><span class=cl>##   1.232847e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 64</span><span class=cl>##   1.417474e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 65</span><span class=cl>##   1.629751e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 66</span><span class=cl>##   1.873817e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 67</span><span class=cl>##   2.154435e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 68</span><span class=cl>##   2.477076e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 69</span><span class=cl>##   2.848036e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 70</span><span class=cl>##   3.274549e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 71</span><span class=cl>##   3.764936e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 72</span><span class=cl>##   4.328761e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 73</span><span class=cl>##   4.977024e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 74</span><span class=cl>##   5.722368e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 75</span><span class=cl>##   6.579332e+00    40.03231  0.9999955   14.48774
</span></span><span class=line><span class=ln> 76</span><span class=cl>##   7.564633e+00    40.43005  0.9999955   14.59881
</span></span><span class=line><span class=ln> 77</span><span class=cl>##   8.697490e+00    41.25214  0.9999955   14.81913
</span></span><span class=line><span class=ln> 78</span><span class=cl>##   1.000000e+01    42.30446  0.9999955   15.09937
</span></span><span class=line><span class=ln> 79</span><span class=cl>##   1.149757e+01    43.59429  0.9999955   15.44307
</span></span><span class=line><span class=ln> 80</span><span class=cl>##   1.321941e+01    45.43633  0.9999955   15.93255
</span></span><span class=line><span class=ln> 81</span><span class=cl>##   1.519911e+01    47.55425  0.9999955   16.49605
</span></span><span class=line><span class=ln> 82</span><span class=cl>##   1.747528e+01    49.98935  0.9999955   17.14447
</span></span><span class=line><span class=ln> 83</span><span class=cl>##   2.009233e+01    52.90533  0.9999955   17.91650
</span></span><span class=line><span class=ln> 84</span><span class=cl>##   2.310130e+01    57.57589  0.9999955   19.10125
</span></span><span class=line><span class=ln> 85</span><span class=cl>##   2.656088e+01    63.25484  0.9999955   20.53147
</span></span><span class=line><span class=ln> 86</span><span class=cl>##   3.053856e+01    70.51580  0.9999955   22.36400
</span></span><span class=line><span class=ln> 87</span><span class=cl>##   3.511192e+01    78.93391  0.9999955   24.49105
</span></span><span class=line><span class=ln> 88</span><span class=cl>##   4.037017e+01    88.61274  0.9999955   26.93830
</span></span><span class=line><span class=ln> 89</span><span class=cl>##   4.641589e+01    99.97831  0.9999955   29.83601
</span></span><span class=line><span class=ln> 90</span><span class=cl>##   5.336699e+01   113.48225  0.9999955   33.39320
</span></span><span class=line><span class=ln> 91</span><span class=cl>##   6.135907e+01   129.17536  0.9999955   37.58303
</span></span><span class=line><span class=ln> 92</span><span class=cl>##   7.054802e+01   147.76452  0.9999957   42.74333
</span></span><span class=line><span class=ln> 93</span><span class=cl>##   8.111308e+01   169.60027  0.9999961   48.98043
</span></span><span class=line><span class=ln> 94</span><span class=cl>##   9.326033e+01   194.94266  0.9999965   56.29001
</span></span><span class=line><span class=ln> 95</span><span class=cl>##   1.072267e+02   224.07631  0.9999969   64.70026
</span></span><span class=line><span class=ln> 96</span><span class=cl>##   1.232847e+02   257.56092  0.9999971   74.36989
</span></span><span class=line><span class=ln> 97</span><span class=cl>##   1.417474e+02   296.13382  0.9999971   85.51504
</span></span><span class=line><span class=ln> 98</span><span class=cl>##   1.629751e+02   340.49129  0.9999971   98.33212
</span></span><span class=line><span class=ln> 99</span><span class=cl>##   1.873817e+02   391.49185  0.9999971  113.06864
</span></span><span class=line><span class=ln>100</span><span class=cl>##   2.154435e+02   450.13031  0.9999971  130.01206
</span></span><span class=line><span class=ln>101</span><span class=cl>##   2.477076e+02   509.28329  0.9999970  147.15405
</span></span><span class=line><span class=ln>102</span><span class=cl>##   2.848036e+02   564.17558  0.9999969  163.34475
</span></span><span class=line><span class=ln>103</span><span class=cl>##   3.274549e+02   618.84080  0.9999969  179.85589
</span></span><span class=line><span class=ln>104</span><span class=cl>##   3.764936e+02   681.69265  0.9999969  198.83969
</span></span><span class=line><span class=ln>105</span><span class=cl>##   4.328761e+02   741.14452  0.9999967  217.28049
</span></span><span class=line><span class=ln>106</span><span class=cl>##   4.977024e+02   807.25385  0.9999967  237.88938
</span></span><span class=line><span class=ln>107</span><span class=cl>##   5.722368e+02   883.26360  0.9999967  261.58461
</span></span><span class=line><span class=ln>108</span><span class=cl>##   6.579332e+02   970.65640  0.9999967  288.82836
</span></span><span class=line><span class=ln>109</span><span class=cl>##   7.564633e+02  1037.84801  0.9999960  312.54099
</span></span><span class=line><span class=ln>110</span><span class=cl>##   8.697490e+02  1088.92551  0.9999960  334.04769
</span></span><span class=line><span class=ln>111</span><span class=cl>##   1.000000e+03  1131.46176  0.9999955  354.62317
</span></span><span class=line><span class=ln>112</span><span class=cl>##
</span></span><span class=line><span class=ln>113</span><span class=cl>## Tuning parameter &#39;alpha&#39; was held constant at a value of 1
</span></span><span class=line><span class=ln>114</span><span class=cl>## RMSE was used to select the optimal model using the smallest value.
</span></span><span class=line><span class=ln>115</span><span class=cl>## The final values used for the model were alpha = 1 and lambda = 6.579332.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassocaret2</span>  <span class=o>%&gt;%</span> <span class=n>ggplot</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-29-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassocaret2</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-30-1.png></figure><p>Clearly, the LASSO model has correctly reduced the model down to the
correct single variable form, though best subset seems to suggest using
more predictors, their coefficients are low enough to recognize that
they are noise.</p><h2 id=question-6.9---page-263>Question 6.9 - Page 263</h2><p>In this exercise, we will predict the number of applications received
using the other variables in the <code>College</code> data set.</p><p><strong>(a)</strong> Split the data set into a training set and a test set.</p><p><strong>(b)</strong> Fit a linear model using least squares on the training set, and
report the test error obtained.</p><p><strong>(c)</strong> Fit a ridge regression model on the training set, with \(\lambda\)
chosen by cross-validation. Report the test error obtained.</p><p><strong>(d)</strong> Fit a lasso model on the training set, with \(\lambda\) chosen by
crossvalidation. Report the test error obtained, along with the number
of non-zero coefficient estimates.</p><p><strong>(e)</strong> Fit a PCR model on the training set, with \(M\) chosen by
crossvalidation. Report the test error obtained, along with the value of
\(M\) selected by cross-validation.</p><p><strong>(f)</strong> Fit a PLS model on the training set, with M chosen by
crossvalidation. Report the test error obtained, along with the value of
M selected by cross-validation.</p><p><strong>(g)</strong> Comment on the results obtained. How accurately can we predict the
number of college applications received? Is there much difference among
the test errors resulting from these five approaches?</p><h3 id=answer-1>Answer</h3><p>We will use the <code>caret</code> package, since at the moment, <code>mlr3</code> does not
have learners for <code>PCR</code> and <code>PLS</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>colDat</span><span class=o>&lt;-</span><span class=n>ISLR</span><span class=o>::</span><span class=n>College</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##  Private        Apps           Accept          Enroll       Top10perc
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  No :212   Min.   :   81   Min.   :   72   Min.   :  35   Min.   : 1.00
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  Yes:565   1st Qu.:  776   1st Qu.:  604   1st Qu.: 242   1st Qu.:15.00
</span></span><span class=line><span class=ln> 4</span><span class=cl>##            Median : 1558   Median : 1110   Median : 434   Median :23.00
</span></span><span class=line><span class=ln> 5</span><span class=cl>##            Mean   : 3002   Mean   : 2019   Mean   : 780   Mean   :27.56
</span></span><span class=line><span class=ln> 6</span><span class=cl>##            3rd Qu.: 3624   3rd Qu.: 2424   3rd Qu.: 902   3rd Qu.:35.00
</span></span><span class=line><span class=ln> 7</span><span class=cl>##            Max.   :48094   Max.   :26330   Max.   :6392   Max.   :96.00
</span></span><span class=line><span class=ln> 8</span><span class=cl>##    Top25perc      F.Undergrad     P.Undergrad         Outstate
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  Min.   :  9.0   Min.   :  139   Min.   :    1.0   Min.   : 2340
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1st Qu.: 41.0   1st Qu.:  992   1st Qu.:   95.0   1st Qu.: 7320
</span></span><span class=line><span class=ln>11</span><span class=cl>##  Median : 54.0   Median : 1707   Median :  353.0   Median : 9990
</span></span><span class=line><span class=ln>12</span><span class=cl>##  Mean   : 55.8   Mean   : 3700   Mean   :  855.3   Mean   :10441
</span></span><span class=line><span class=ln>13</span><span class=cl>##  3rd Qu.: 69.0   3rd Qu.: 4005   3rd Qu.:  967.0   3rd Qu.:12925
</span></span><span class=line><span class=ln>14</span><span class=cl>##  Max.   :100.0   Max.   :31643   Max.   :21836.0   Max.   :21700
</span></span><span class=line><span class=ln>15</span><span class=cl>##    Room.Board       Books           Personal         PhD
</span></span><span class=line><span class=ln>16</span><span class=cl>##  Min.   :1780   Min.   :  96.0   Min.   : 250   Min.   :  8.00
</span></span><span class=line><span class=ln>17</span><span class=cl>##  1st Qu.:3597   1st Qu.: 470.0   1st Qu.: 850   1st Qu.: 62.00
</span></span><span class=line><span class=ln>18</span><span class=cl>##  Median :4200   Median : 500.0   Median :1200   Median : 75.00
</span></span><span class=line><span class=ln>19</span><span class=cl>##  Mean   :4358   Mean   : 549.4   Mean   :1341   Mean   : 72.66
</span></span><span class=line><span class=ln>20</span><span class=cl>##  3rd Qu.:5050   3rd Qu.: 600.0   3rd Qu.:1700   3rd Qu.: 85.00
</span></span><span class=line><span class=ln>21</span><span class=cl>##  Max.   :8124   Max.   :2340.0   Max.   :6800   Max.   :103.00
</span></span><span class=line><span class=ln>22</span><span class=cl>##     Terminal       S.F.Ratio      perc.alumni        Expend
</span></span><span class=line><span class=ln>23</span><span class=cl>##  Min.   : 24.0   Min.   : 2.50   Min.   : 0.00   Min.   : 3186
</span></span><span class=line><span class=ln>24</span><span class=cl>##  1st Qu.: 71.0   1st Qu.:11.50   1st Qu.:13.00   1st Qu.: 6751
</span></span><span class=line><span class=ln>25</span><span class=cl>##  Median : 82.0   Median :13.60   Median :21.00   Median : 8377
</span></span><span class=line><span class=ln>26</span><span class=cl>##  Mean   : 79.7   Mean   :14.09   Mean   :22.74   Mean   : 9660
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3rd Qu.: 92.0   3rd Qu.:16.50   3rd Qu.:31.00   3rd Qu.:10830
</span></span><span class=line><span class=ln>28</span><span class=cl>##  Max.   :100.0   Max.   :39.80   Max.   :64.00   Max.   :56233
</span></span><span class=line><span class=ln>29</span><span class=cl>##    Grad.Rate
</span></span><span class=line><span class=ln>30</span><span class=cl>##  Min.   : 10.00
</span></span><span class=line><span class=ln>31</span><span class=cl>##  1st Qu.: 53.00
</span></span><span class=line><span class=ln>32</span><span class=cl>##  Median : 65.00
</span></span><span class=line><span class=ln>33</span><span class=cl>##  Mean   : 65.46
</span></span><span class=line><span class=ln>34</span><span class=cl>##  3rd Qu.: 78.00
</span></span><span class=line><span class=ln>35</span><span class=cl>##  Max.   :118.00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    777 obs. of  18 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ Private    : Factor w/ 2 levels &#34;No&#34;,&#34;Yes&#34;: 2 2 2 2 2 2 2 2 2 2 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ Apps       : num  1660 2186 1428 417 193 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ Accept     : num  1232 1924 1097 349 146 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ Enroll     : num  721 512 336 137 55 158 103 489 227 172 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ Top10perc  : num  23 16 22 60 16 38 17 37 30 21 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ Top25perc  : num  52 29 50 89 44 62 45 68 63 44 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ F.Undergrad: num  2885 2683 1036 510 249 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ P.Undergrad: num  537 1227 99 63 869 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ Outstate   : num  7440 12280 11250 12960 7560 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ Room.Board : num  3300 6450 3750 5450 4120 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ Books      : num  450 750 400 450 800 500 500 450 300 660 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>##  $ Personal   : num  2200 1500 1165 875 1500 ...
</span></span><span class=line><span class=ln>14</span><span class=cl>##  $ PhD        : num  70 29 53 92 76 67 90 89 79 40 ...
</span></span><span class=line><span class=ln>15</span><span class=cl>##  $ Terminal   : num  78 30 66 97 72 73 93 100 84 41 ...
</span></span><span class=line><span class=ln>16</span><span class=cl>##  $ S.F.Ratio  : num  18.1 12.2 12.9 7.7 11.9 9.4 11.5 13.7 11.3 11.5 ...
</span></span><span class=line><span class=ln>17</span><span class=cl>##  $ perc.alumni: num  12 16 30 37 2 11 26 37 23 15 ...
</span></span><span class=line><span class=ln>18</span><span class=cl>##  $ Expend     : num  7041 10527 8735 19016 10922 ...
</span></span><span class=line><span class=ln>19</span><span class=cl>##  $ Grad.Rate  : num  60 56 54 59 15 55 63 73 80 52 ...
</span></span><span class=line><span class=ln>20</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>unique</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>length</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##     Private        Apps      Accept      Enroll   Top10perc   Top25perc
</span></span><span class=line><span class=ln>2</span><span class=cl>##           2         711         693         581          82          89
</span></span><span class=line><span class=ln>3</span><span class=cl>## F.Undergrad P.Undergrad    Outstate  Room.Board       Books    Personal
</span></span><span class=line><span class=ln>4</span><span class=cl>##         714         566         640         553         122         294
</span></span><span class=line><span class=ln>5</span><span class=cl>##         PhD    Terminal   S.F.Ratio perc.alumni      Expend   Grad.Rate
</span></span><span class=line><span class=ln>6</span><span class=cl>##          78          65         173          61         744          81
</span></span></code></pre></div><p>Clearly, there are no psuedo-factors which might have been converted at
this stage.</p><h4 id=a-train-test-split>a) Train-Test split</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_ind</span><span class=o>&lt;-</span><span class=nf>createDataPartition</span><span class=p>(</span><span class=n>colDat</span><span class=o>$</span><span class=n>Apps</span><span class=p>,</span><span class=n>p</span><span class=o>=</span><span class=m>0.8</span><span class=p>,</span><span class=n>times</span><span class=o>=</span><span class=m>1</span><span class=p>,</span><span class=n>list</span><span class=o>=</span><span class=kc>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>train_set</span><span class=o>&lt;-</span><span class=n>colDat[train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>test_set</span><span class=o>&lt;-</span><span class=n>colDat[</span><span class=o>-</span><span class=n>train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span></code></pre></div><h4 id=b-linear-least-squares>b) Linear least squares</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>linCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>Apps</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>linCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##     Min      1Q  Median      3Q     Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -5145.6  -414.8   -20.3   340.5  7526.8
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##               Estimate Std. Error t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept) -2.918e+02  4.506e+02  -0.648 0.517486
</span></span><span class=line><span class=ln>12</span><span class=cl>## PrivateYes  -5.351e+02  1.532e+02  -3.494 0.000511 ***
</span></span><span class=line><span class=ln>13</span><span class=cl>## Accept       1.617e+00  4.258e-02  37.983  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## Enroll      -1.012e+00  1.959e-01  -5.165 3.26e-07 ***
</span></span><span class=line><span class=ln>15</span><span class=cl>## Top10perc    5.379e+01  6.221e+00   8.647  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>16</span><span class=cl>## Top25perc   -1.632e+01  5.046e+00  -3.235 0.001282 **
</span></span><span class=line><span class=ln>17</span><span class=cl>## F.Undergrad  6.836e-02  3.457e-02   1.978 0.048410 *
</span></span><span class=line><span class=ln>18</span><span class=cl>## P.Undergrad  7.929e-02  3.367e-02   2.355 0.018854 *
</span></span><span class=line><span class=ln>19</span><span class=cl>## Outstate    -7.303e-02  2.098e-02  -3.481 0.000536 ***
</span></span><span class=line><span class=ln>20</span><span class=cl>## Room.Board   1.695e-01  5.367e-02   3.159 0.001663 **
</span></span><span class=line><span class=ln>21</span><span class=cl>## Books        9.998e-02  2.578e-01   0.388 0.698328
</span></span><span class=line><span class=ln>22</span><span class=cl>## Personal    -3.145e-03  6.880e-02  -0.046 0.963553
</span></span><span class=line><span class=ln>23</span><span class=cl>## PhD         -8.926e+00  5.041e+00  -1.771 0.077112 .
</span></span><span class=line><span class=ln>24</span><span class=cl>## Terminal    -2.298e+00  5.608e+00  -0.410 0.682152
</span></span><span class=line><span class=ln>25</span><span class=cl>## S.F.Ratio    6.038e+00  1.420e+01   0.425 0.670757
</span></span><span class=line><span class=ln>26</span><span class=cl>## perc.alumni -5.085e-01  4.560e+00  -0.112 0.911249
</span></span><span class=line><span class=ln>27</span><span class=cl>## Expend       4.668e-02  1.332e-02   3.505 0.000490 ***
</span></span><span class=line><span class=ln>28</span><span class=cl>## Grad.Rate    9.042e+00  3.379e+00   2.676 0.007653 **
</span></span><span class=line><span class=ln>29</span><span class=cl>## ---
</span></span><span class=line><span class=ln>30</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>31</span><span class=cl>##
</span></span><span class=line><span class=ln>32</span><span class=cl>## Residual standard error: 1042 on 606 degrees of freedom
</span></span><span class=line><span class=ln>33</span><span class=cl>## Multiple R-squared:  0.9332, Adjusted R-squared:  0.9313
</span></span><span class=line><span class=ln>34</span><span class=cl>## F-statistic: 497.7 on 17 and 606 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>linPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>linCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>linPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>Apps</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##         RMSE     Rsquared          MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1071.6360025    0.9017032  625.7827996
</span></span></code></pre></div><p>Do note that the
<a href=https://topepo.github.io/caret/measuring-performance.html#measures-for-regression>metrics
are calculated</a> in a manner to ensure no negative values are obtained.</p><h4 id=c-ridge-regression-with-cv-for-λ>c) Ridge regression with CV for λ</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L2Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>0</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>Apps</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L2Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0           100   -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        1700   dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df           100   -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim            2   -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda       100   -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio    100   -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev        1   -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses        1   -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr           1   -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset         1   -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call           5   -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs           1   -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt      1   -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames        17   -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType    1   -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue      2   data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels      1   -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param          0   -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>ridgCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>ridgCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 18 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                         1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept) -1.407775e+03
</span></span><span class=line><span class=ln> 4</span><span class=cl>## PrivateYes  -5.854245e+02
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Accept       1.042778e+00
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Enroll       3.511219e-01
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Top10perc    2.780211e+01
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Top25perc    2.883536e-02
</span></span><span class=line><span class=ln> 9</span><span class=cl>## F.Undergrad  6.825141e-02
</span></span><span class=line><span class=ln>10</span><span class=cl>## P.Undergrad  5.281320e-02
</span></span><span class=line><span class=ln>11</span><span class=cl>## Outstate    -2.011504e-02
</span></span><span class=line><span class=ln>12</span><span class=cl>## Room.Board   2.155224e-01
</span></span><span class=line><span class=ln>13</span><span class=cl>## Books        1.517585e-01
</span></span><span class=line><span class=ln>14</span><span class=cl>## Personal    -3.711406e-02
</span></span><span class=line><span class=ln>15</span><span class=cl>## PhD         -4.453155e+00
</span></span><span class=line><span class=ln>16</span><span class=cl>## Terminal    -3.783231e+00
</span></span><span class=line><span class=ln>17</span><span class=cl>## S.F.Ratio    6.897360e+00
</span></span><span class=line><span class=ln>18</span><span class=cl>## perc.alumni -9.301831e+00
</span></span><span class=line><span class=ln>19</span><span class=cl>## Expend       5.601144e-02
</span></span><span class=line><span class=ln>20</span><span class=cl>## Grad.Rate    1.259989e+01
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-38-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>ridgPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>Apps</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##         RMSE     Rsquared          MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1047.7545250    0.9051726  644.4535063
</span></span></code></pre></div><h4 id=d-lasso-with-cv-for-λ>d) LASSO with CV for λ</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L1Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>,</span> <span class=c1># for lasso</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>Apps</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L1Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0            81   -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        1377   dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df            81   -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim            2   -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda        81   -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio     81   -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev        1   -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses        1   -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr           1   -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset         1   -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call           5   -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs           1   -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt      1   -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames        17   -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType    1   -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue      2   data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels      1   -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param          0   -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>lassoCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>lassoCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 18 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                         1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept) -325.51554340
</span></span><span class=line><span class=ln> 4</span><span class=cl>## PrivateYes  -532.28956305
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Accept         1.60370798
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Enroll        -0.90158328
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Top10perc     51.96610325
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Top25perc    -14.87886847
</span></span><span class=line><span class=ln> 9</span><span class=cl>## F.Undergrad    0.05352324
</span></span><span class=line><span class=ln>10</span><span class=cl>## P.Undergrad    0.07832395
</span></span><span class=line><span class=ln>11</span><span class=cl>## Outstate      -0.07047302
</span></span><span class=line><span class=ln>12</span><span class=cl>## Room.Board     0.16783269
</span></span><span class=line><span class=ln>13</span><span class=cl>## Books          0.08836704
</span></span><span class=line><span class=ln>14</span><span class=cl>## Personal       .
</span></span><span class=line><span class=ln>15</span><span class=cl>## PhD           -8.67634519
</span></span><span class=line><span class=ln>16</span><span class=cl>## Terminal      -2.18494018
</span></span><span class=line><span class=ln>17</span><span class=cl>## S.F.Ratio      5.25050018
</span></span><span class=line><span class=ln>18</span><span class=cl>## perc.alumni   -0.67848535
</span></span><span class=line><span class=ln>19</span><span class=cl>## Expend         0.04597728
</span></span><span class=line><span class=ln>20</span><span class=cl>## Grad.Rate      8.67569015
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-43-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lassoPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>Apps</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##         RMSE     Rsquared          MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1068.9834769    0.9021268  622.7029418
</span></span></code></pre></div><h4 id=e-pcr-with-cv-for-m>e) PCR with CV for M</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>mGrid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>ncomp</span><span class=o>=</span><span class=nf>seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>1</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>20</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>10</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pcrCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>Apps</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;pcr&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>mGrid</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>pcrCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Data:    X dimension: 624 17
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Y dimension: 624 1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## Fit method: svdpc
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Number of components considered: 17
</span></span><span class=line><span class=ln> 5</span><span class=cl>## TRAINING: % variance explained
</span></span><span class=line><span class=ln> 6</span><span class=cl>##           1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps
</span></span><span class=line><span class=ln> 7</span><span class=cl>## X         48.2314    87.24    95.02    97.26    98.63    99.43    99.91
</span></span><span class=line><span class=ln> 8</span><span class=cl>## .outcome   0.2419    76.54    77.88    80.19    91.27    91.34    91.34
</span></span><span class=line><span class=ln> 9</span><span class=cl>##           8 comps  9 comps  10 comps  11 comps  12 comps  13 comps  14 comps
</span></span><span class=line><span class=ln>10</span><span class=cl>## X           99.96   100.00    100.00    100.00    100.00    100.00    100.00
</span></span><span class=line><span class=ln>11</span><span class=cl>## .outcome    91.65    91.66     92.26     92.65     92.66     92.67     92.76
</span></span><span class=line><span class=ln>12</span><span class=cl>##           15 comps  16 comps  17 comps
</span></span><span class=line><span class=ln>13</span><span class=cl>## X           100.00    100.00    100.00
</span></span><span class=line><span class=ln>14</span><span class=cl>## .outcome     93.17     93.18     93.32
</span></span><span class=line><span class=ln>15</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>pcrCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-47-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pcrPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>pcrCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>pcrPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>Apps</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##         RMSE     Rsquared          MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1071.6360025    0.9017032  625.7827996
</span></span></code></pre></div><h4 id=f-pls-with-cv-for-m>f) PLS with CV for M</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>plsCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>Apps</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;pls&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>mGrid</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>plsCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Data:    X dimension: 624 17
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Y dimension: 624 1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## Fit method: oscorespls
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Number of components considered: 17
</span></span><span class=line><span class=ln> 5</span><span class=cl>## TRAINING: % variance explained
</span></span><span class=line><span class=ln> 6</span><span class=cl>##           1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps
</span></span><span class=line><span class=ln> 7</span><span class=cl>## X           39.02     56.4    91.83    96.61    98.62    99.22    99.49
</span></span><span class=line><span class=ln> 8</span><span class=cl>## .outcome    78.04     84.1    86.88    91.09    91.38    91.49    91.66
</span></span><span class=line><span class=ln> 9</span><span class=cl>##           8 comps  9 comps  10 comps  11 comps  12 comps  13 comps  14 comps
</span></span><span class=line><span class=ln>10</span><span class=cl>## X           99.96    99.99    100.00    100.00    100.00    100.00    100.00
</span></span><span class=line><span class=ln>11</span><span class=cl>## .outcome    91.68    91.85     92.64     92.87     93.16     93.18     93.18
</span></span><span class=line><span class=ln>12</span><span class=cl>##           15 comps  16 comps  17 comps
</span></span><span class=line><span class=ln>13</span><span class=cl>## X           100.00    100.00    100.00
</span></span><span class=line><span class=ln>14</span><span class=cl>## .outcome     93.18     93.19     93.32
</span></span><span class=line><span class=ln>15</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>plsCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-50-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>plsPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>plsCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>plsPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>Apps</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##         RMSE     Rsquared          MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1071.6360039    0.9017032  625.7827987
</span></span></code></pre></div><h4 id=g-comments-and-comparison>g) Comments and Comparison</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>models</span> <span class=o>&lt;-</span> <span class=nf>list</span><span class=p>(</span><span class=n>ridge</span> <span class=o>=</span> <span class=n>ridgCol</span><span class=p>,</span> <span class=n>lasso</span> <span class=o>=</span> <span class=n>lassoCol</span><span class=p>,</span> <span class=n>pcr</span> <span class=o>=</span> <span class=n>pcrCol</span><span class=p>,</span> <span class=n>pls</span><span class=o>=</span><span class=n>plsCol</span><span class=p>,</span><span class=n>linear</span><span class=o>=</span><span class=n>linCol</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>resamples</span><span class=p>(</span><span class=n>models</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## summary.resamples(object = .)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Models: ridge, lasso, pcr, pls, linear
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Number of resamples: 25
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>## MAE
</span></span><span class=line><span class=ln> 9</span><span class=cl>##            Min.  1st Qu.   Median     Mean  3rd Qu.     Max. NA&#39;s
</span></span><span class=line><span class=ln>10</span><span class=cl>## ridge  536.9612 600.5398 623.2005 649.6713 707.4014 793.4972    0
</span></span><span class=line><span class=ln>11</span><span class=cl>## lasso  573.8563 616.3883 671.9453 655.8858 691.7620 732.2155    0
</span></span><span class=line><span class=ln>12</span><span class=cl>## pcr    576.1427 618.8694 650.0360 662.9040 714.8491 767.5535    0
</span></span><span class=line><span class=ln>13</span><span class=cl>## pls    553.3999 607.9757 637.1985 638.6619 668.5120 735.4479    0
</span></span><span class=line><span class=ln>14</span><span class=cl>## linear 556.5553 619.2395 654.1478 659.4635 686.7747 792.4912    0
</span></span><span class=line><span class=ln>15</span><span class=cl>##
</span></span><span class=line><span class=ln>16</span><span class=cl>## RMSE
</span></span><span class=line><span class=ln>17</span><span class=cl>##            Min.   1st Qu.   Median     Mean  3rd Qu.     Max. NA&#39;s
</span></span><span class=line><span class=ln>18</span><span class=cl>## ridge  882.2646  920.5934 1000.519 1168.603 1163.377 1939.541    0
</span></span><span class=line><span class=ln>19</span><span class=cl>## lasso  801.9415  990.0724 1168.234 1184.329 1302.221 1584.712    0
</span></span><span class=line><span class=ln>20</span><span class=cl>## pcr    828.1370  942.2678 1131.207 1144.071 1284.178 1544.078    0
</span></span><span class=line><span class=ln>21</span><span class=cl>## pls    786.7989 1038.3265 1167.764 1157.026 1274.041 1461.434    0
</span></span><span class=line><span class=ln>22</span><span class=cl>## linear 798.3771 1063.3690 1134.291 1135.977 1215.115 1403.576    0
</span></span><span class=line><span class=ln>23</span><span class=cl>##
</span></span><span class=line><span class=ln>24</span><span class=cl>## Rsquared
</span></span><span class=line><span class=ln>25</span><span class=cl>##             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA&#39;s
</span></span><span class=line><span class=ln>26</span><span class=cl>## ridge  0.8735756 0.8962010 0.9185736 0.9136429 0.9306819 0.9474913    0
</span></span><span class=line><span class=ln>27</span><span class=cl>## lasso  0.8851991 0.9132766 0.9217660 0.9191638 0.9284838 0.9398772    0
</span></span><span class=line><span class=ln>28</span><span class=cl>## pcr    0.8658504 0.9080179 0.9235117 0.9146884 0.9281892 0.9471991    0
</span></span><span class=line><span class=ln>29</span><span class=cl>## pls    0.8881249 0.9080786 0.9183968 0.9173632 0.9258994 0.9420894    0
</span></span><span class=line><span class=ln>30</span><span class=cl>## linear 0.8840049 0.8986452 0.9222319 0.9160913 0.9296275 0.9492198    0
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>resamples</span><span class=p>(</span><span class=n>models</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>bwplot</span><span class=p>(</span><span class=n>scales</span><span class=o>=</span><span class=s>&#34;free&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-53-1.png></figure><ul><li>Given the tighter spread of <code>PLS</code>, it seems more reliable than <code>PCR</code></li><li><code>Ridge</code> is just poor in every way</li><li><code>OLS</code> does well, but it also has a worrying outlier</li><li><code>LASSO</code> appears to be doing alright as well We also have kept track of
the performance on the <code>test_set</code></li></ul><p>We might want to see the variable significance values as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lgp</span><span class=o>&lt;-</span><span class=n>linCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;OLS Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>rgp</span><span class=o>&lt;-</span><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Ridge Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>lsgp</span><span class=o>&lt;-</span><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Lasso Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>pcgp</span><span class=o>&lt;-</span><span class=n>pcrCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;PCR Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=n>plgp</span><span class=o>&lt;-</span><span class=n>plsCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;PLS Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nf>grid.arrange</span><span class=p>(</span><span class=n>lgp</span><span class=p>,</span><span class=n>rgp</span><span class=p>,</span><span class=n>lsgp</span><span class=p>,</span><span class=n>pcgp</span><span class=p>,</span><span class=n>plgp</span><span class=p>,</span><span class=n>ncol</span><span class=o>=</span><span class=m>3</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-54-1.png></figure><h2 id=question-6.10---pages-263-264>Question 6.10 - Pages 263-264</h2><p>We have seen that as the number of features used in a model increases,
the training error will necessarily decrease, but the test error may
not. We will now explore this in a simulated data set.</p><p><strong>(a)</strong> Generate a data set with \(p = 20\) features, \(n = 1,000\)
observations, and an associated quantitative response vector generated
according to the model \[Y = X\beta + \eta,\] where \(\beta\) has some
elements that are exactly equal to zero.</p><p><strong>(b)</strong> Split your data set into a training set containing \(100\)
observations and a test set containing \(900\) observations.</p><p><strong>(c)</strong> Perform best subset selection on the training set, and plot the
training set MSE associated with the best model of each size.</p><p><strong>(d)</strong> Plot the test set MSE associated with the best model of each size.</p><p><strong>(e)</strong> For which model size does the test set MSE take on its minimum
value? Comment on your results. If it takes on its minimum value for a
model containing only an intercept or a model containing all of the
features, then play around with the way that you are generating the data
in (a) until you come up with a scenario in which the test set MSE is
minimized for an intermediate model size.</p><p><strong>(f)</strong> How does the model at which the test set MSE is minimized compare
to the true model used to generate the data? Comment on the coefficient
values.</p><p><strong>(g)</strong> Create a plot displaying
\(\sqrt{\Sum_{j=1}^{p}(\beta_{j}-\hat{\beta}_{j}^{r})^{2}}\) for a range
of values of \(r\), where \(\hat{\beta}_{j}^{r}\) is the $j$th coefficient
estimate for the best model containing \(r\) coefficients. Comment on what
you observe. How does this compare to the test MSE plot from (d)?</p><h3 id=answer-2>Answer</h3><h4 id=model-creation>Model creation</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>p</span><span class=o>=</span><span class=m>20</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>n</span><span class=o>=</span><span class=m>1000</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>noise</span><span class=o>&lt;-</span><span class=nf>rnorm</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>xmat</span><span class=o>&lt;-</span><span class=nf>matrix</span><span class=p>(</span><span class=nf>rnorm</span><span class=p>(</span><span class=n>n</span><span class=o>*</span><span class=n>p</span><span class=p>),</span><span class=n>nrow</span><span class=o>=</span><span class=n>n</span><span class=p>,</span><span class=n>ncol</span><span class=o>=</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=n>beta</span><span class=o>&lt;-</span><span class=nf>sample</span><span class=p>(</span><span class=m>-10</span><span class=o>:</span><span class=m>34</span><span class=p>,</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=n>beta</span><span class=nf>[sample</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>20</span><span class=p>,</span><span class=m>4</span><span class=p>)</span><span class=n>]</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=n>myY</span><span class=o>&lt;-</span><span class=n>xmat</span> <span class=o>%*%</span> <span class=n>beta</span> <span class=o>+</span> <span class=n>noise</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=n>modelDat</span><span class=o>&lt;-</span><span class=nf>data.frame</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=nf>as.matrix</span><span class=p>(</span><span class=n>xmat</span><span class=p>),</span><span class=n>y</span><span class=o>=</span><span class=n>myY</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>As always we will want to take a peak</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelDat</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    1000 obs. of  21 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ x.1 : num  -0.406 -1.375 0.858 -0.231 -0.601 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ x.2 : num  -0.129 -0.218 -0.17 0.573 -0.513 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ x.3 : num  0.127 -0.224 1.014 0.896 0.159 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ x.4 : num  0.499 -0.151 -0.488 -0.959 2.187 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ x.5 : num  -0.235 -0.345 -0.773 -0.346 0.773 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ x.6 : num  0.26 -0.429 -1.183 -1.159 0.959 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ x.7 : num  0.567 1.647 0.149 -0.593 -0.902 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ x.8 : num  -0.092 0.8391 -1.4835 0.0229 -0.1353 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ x.9 : num  -0.998 -1.043 -0.563 -0.377 0.324 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ x.10: num  -0.4401 -0.195 -0.5139 -0.0156 -0.9543 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ x.11: num  -0.147 0.829 0.165 0.101 -0.105 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>##  $ x.12: num  -0.0118 1.02 1.0794 1.3184 -2.2844 ...
</span></span><span class=line><span class=ln>14</span><span class=cl>##  $ x.13: num  -1.683 0.487 -1.142 -0.744 -0.175 ...
</span></span><span class=line><span class=ln>15</span><span class=cl>##  $ x.14: num  0.228 -1.031 -2.798 -0.646 0.56 ...
</span></span><span class=line><span class=ln>16</span><span class=cl>##  $ x.15: num  -0.718 0.508 0.637 -0.556 0.585 ...
</span></span><span class=line><span class=ln>17</span><span class=cl>##  $ x.16: num  -1.6378 0.581 -0.9939 0.0537 -0.5854 ...
</span></span><span class=line><span class=ln>18</span><span class=cl>##  $ x.17: num  1.758 -0.616 1.377 -0.876 -1.174 ...
</span></span><span class=line><span class=ln>19</span><span class=cl>##  $ x.18: num  -1.438 0.373 1.364 0.399 0.949 ...
</span></span><span class=line><span class=ln>20</span><span class=cl>##  $ x.19: num  -0.715 -0.731 1.142 0.149 0.916 ...
</span></span><span class=line><span class=ln>21</span><span class=cl>##  $ x.20: num  2.774 -2.024 1.316 0.138 0.187 ...
</span></span><span class=line><span class=ln>22</span><span class=cl>##  $ y   : num  77.5 -82.8 -38.9 -79.7 64.9 ...
</span></span><span class=line><span class=ln>23</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelDat</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##       x.1                x.2                x.3                x.4
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Min.   :-2.79766   Min.   :-3.13281   Min.   :-2.71232   Min.   :-4.29604
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  1st Qu.:-0.60516   1st Qu.:-0.66759   1st Qu.:-0.60561   1st Qu.:-0.66598
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  Median : 0.04323   Median : 0.03681   Median : 0.06556   Median : 0.06589
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  Mean   : 0.06879   Mean   : 0.01004   Mean   : 0.06443   Mean   : 0.02244
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  3rd Qu.: 0.74049   3rd Qu.: 0.68234   3rd Qu.: 0.70521   3rd Qu.: 0.71174
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  Max.   : 3.50354   Max.   : 3.47268   Max.   : 3.02817   Max.   : 3.27326
</span></span><span class=line><span class=ln> 8</span><span class=cl>##       x.5                 x.6                x.7                x.8
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  Min.   :-3.228376   Min.   :-4.24014   Min.   :-2.98577   Min.   :-3.27770
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1st Qu.:-0.698220   1st Qu.:-0.69448   1st Qu.:-0.59092   1st Qu.:-0.52939
</span></span><span class=line><span class=ln>11</span><span class=cl>##  Median :-0.058778   Median :-0.01141   Median : 0.01732   Median : 0.05703
</span></span><span class=line><span class=ln>12</span><span class=cl>##  Mean   : 0.000126   Mean   :-0.05158   Mean   : 0.04767   Mean   : 0.08231
</span></span><span class=line><span class=ln>13</span><span class=cl>##  3rd Qu.: 0.663570   3rd Qu.: 0.64217   3rd Qu.: 0.67438   3rd Qu.: 0.72849
</span></span><span class=line><span class=ln>14</span><span class=cl>##  Max.   : 3.036307   Max.   : 3.27572   Max.   : 2.72163   Max.   : 3.33409
</span></span><span class=line><span class=ln>15</span><span class=cl>##       x.9                x.10               x.11               x.12
</span></span><span class=line><span class=ln>16</span><span class=cl>##  Min.   :-3.08957   Min.   :-3.21268   Min.   :-3.00572   Min.   :-3.72016
</span></span><span class=line><span class=ln>17</span><span class=cl>##  1st Qu.:-0.65456   1st Qu.:-0.69401   1st Qu.:-0.68226   1st Qu.:-0.63043
</span></span><span class=line><span class=ln>18</span><span class=cl>##  Median :-0.04242   Median :-0.03069   Median :-0.04777   Median : 0.07079
</span></span><span class=line><span class=ln>19</span><span class=cl>##  Mean   : 0.02049   Mean   :-0.02400   Mean   :-0.03729   Mean   : 0.03769
</span></span><span class=line><span class=ln>20</span><span class=cl>##  3rd Qu.: 0.71209   3rd Qu.: 0.61540   3rd Qu.: 0.64873   3rd Qu.: 0.67155
</span></span><span class=line><span class=ln>21</span><span class=cl>##  Max.   : 3.23110   Max.   : 2.76059   Max.   : 2.87306   Max.   : 3.48569
</span></span><span class=line><span class=ln>22</span><span class=cl>##       x.13               x.14               x.15                x.16
</span></span><span class=line><span class=ln>23</span><span class=cl>##  Min.   :-3.20126   Min.   :-3.55432   Min.   :-2.857575   Min.   :-3.5383
</span></span><span class=line><span class=ln>24</span><span class=cl>##  1st Qu.:-0.68535   1st Qu.:-0.66752   1st Qu.:-0.658708   1st Qu.:-0.7813
</span></span><span class=line><span class=ln>25</span><span class=cl>##  Median :-0.01329   Median :-0.03302   Median : 0.020581   Median :-0.0740
</span></span><span class=line><span class=ln>26</span><span class=cl>##  Mean   : 0.01094   Mean   : 0.02113   Mean   : 0.007976   Mean   :-0.0883
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3rd Qu.: 0.64877   3rd Qu.: 0.74919   3rd Qu.: 0.670464   3rd Qu.: 0.5568
</span></span><span class=line><span class=ln>28</span><span class=cl>##  Max.   : 2.78973   Max.   : 3.47923   Max.   : 2.891527   Max.   : 3.0938
</span></span><span class=line><span class=ln>29</span><span class=cl>##       x.17               x.18               x.19              x.20
</span></span><span class=line><span class=ln>30</span><span class=cl>##  Min.   :-3.28570   Min.   :-4.06416   Min.   :-3.0443   Min.   :-4.06307
</span></span><span class=line><span class=ln>31</span><span class=cl>##  1st Qu.:-0.72302   1st Qu.:-0.72507   1st Qu.:-0.6684   1st Qu.:-0.70518
</span></span><span class=line><span class=ln>32</span><span class=cl>##  Median :-0.02439   Median :-0.04941   Median :-0.0610   Median :-0.07697
</span></span><span class=line><span class=ln>33</span><span class=cl>##  Mean   :-0.01459   Mean   :-0.03164   Mean   :-0.0414   Mean   :-0.05302
</span></span><span class=line><span class=ln>34</span><span class=cl>##  3rd Qu.: 0.62692   3rd Qu.: 0.68115   3rd Qu.: 0.6381   3rd Qu.: 0.58597
</span></span><span class=line><span class=ln>35</span><span class=cl>##  Max.   : 2.86446   Max.   : 3.32958   Max.   : 3.1722   Max.   : 3.01358
</span></span><span class=line><span class=ln>36</span><span class=cl>##        y
</span></span><span class=line><span class=ln>37</span><span class=cl>##  Min.   :-199.268
</span></span><span class=line><span class=ln>38</span><span class=cl>##  1st Qu.: -54.758
</span></span><span class=line><span class=ln>39</span><span class=cl>##  Median :  -1.607
</span></span><span class=line><span class=ln>40</span><span class=cl>##  Mean   :  -1.710
</span></span><span class=line><span class=ln>41</span><span class=cl>##  3rd Qu.:  49.367
</span></span><span class=line><span class=ln>42</span><span class=cl>##  Max.   : 278.244
</span></span></code></pre></div><h4 id=b-train-test-split>b) Train Test Split</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_ind</span> <span class=o>=</span> <span class=nf>sample</span><span class=p>(</span><span class=n>modelDat</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>,</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_ind</span> <span class=o>=</span> <span class=nf>setdiff</span><span class=p>(</span><span class=nf>seq_len</span><span class=p>(</span><span class=n>modelDat</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>),</span> <span class=n>train_set</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=best-subset-selection>Best subset selection</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_set</span><span class=o>&lt;-</span><span class=n>modelDat[train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_set</span><span class=o>&lt;-</span><span class=n>modelDat[</span><span class=o>-</span><span class=n>train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>linCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>linCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##      Min       1Q   Median       3Q      Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -2.12474 -0.53970 -0.00944  0.42398  2.21086
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##             Estimate Std. Error  t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept) -0.06052    0.09604   -0.630    0.530
</span></span><span class=line><span class=ln>12</span><span class=cl>## x.1         -0.02265    0.09198   -0.246    0.806
</span></span><span class=line><span class=ln>13</span><span class=cl>## x.2         28.91650    0.09879  292.719   &lt;2e-16 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## x.3         14.16532    0.09343  151.610   &lt;2e-16 ***
</span></span><span class=line><span class=ln>15</span><span class=cl>## x.4         28.16256    0.09828  286.564   &lt;2e-16 ***
</span></span><span class=line><span class=ln>16</span><span class=cl>## x.5          0.13742    0.09658    1.423    0.159
</span></span><span class=line><span class=ln>17</span><span class=cl>## x.6         27.01497    0.08540  316.341   &lt;2e-16 ***
</span></span><span class=line><span class=ln>18</span><span class=cl>## x.7         31.15917    0.09003  346.092   &lt;2e-16 ***
</span></span><span class=line><span class=ln>19</span><span class=cl>## x.8         -9.66308    0.11095  -87.094   &lt;2e-16 ***
</span></span><span class=line><span class=ln>20</span><span class=cl>## x.9          0.11641    0.10768    1.081    0.283
</span></span><span class=line><span class=ln>21</span><span class=cl>## x.10        19.06687    0.09662  197.344   &lt;2e-16 ***
</span></span><span class=line><span class=ln>22</span><span class=cl>## x.11        -9.09956    0.08627 -105.472   &lt;2e-16 ***
</span></span><span class=line><span class=ln>23</span><span class=cl>## x.12        -8.01933    0.10198  -78.633   &lt;2e-16 ***
</span></span><span class=line><span class=ln>24</span><span class=cl>## x.13         4.26852    0.09888   43.170   &lt;2e-16 ***
</span></span><span class=line><span class=ln>25</span><span class=cl>## x.14        20.22366    0.09853  205.247   &lt;2e-16 ***
</span></span><span class=line><span class=ln>26</span><span class=cl>## x.15        -0.16607    0.10466   -1.587    0.117
</span></span><span class=line><span class=ln>27</span><span class=cl>## x.16         7.95594    0.11250   70.721   &lt;2e-16 ***
</span></span><span class=line><span class=ln>28</span><span class=cl>## x.17        10.89851    0.11157   97.684   &lt;2e-16 ***
</span></span><span class=line><span class=ln>29</span><span class=cl>## x.18        -1.09760    0.09391  -11.688   &lt;2e-16 ***
</span></span><span class=line><span class=ln>30</span><span class=cl>## x.19        22.05197    0.08697  253.553   &lt;2e-16 ***
</span></span><span class=line><span class=ln>31</span><span class=cl>## x.20        20.88796    0.09274  225.221   &lt;2e-16 ***
</span></span><span class=line><span class=ln>32</span><span class=cl>## ---
</span></span><span class=line><span class=ln>33</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>34</span><span class=cl>##
</span></span><span class=line><span class=ln>35</span><span class=cl>## Residual standard error: 0.8583 on 79 degrees of freedom
</span></span><span class=line><span class=ln>36</span><span class=cl>## Multiple R-squared:  0.9999, Adjusted R-squared:  0.9999
</span></span><span class=line><span class=ln>37</span><span class=cl>## F-statistic: 4.71e+04 on 20 and 79 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>linPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>linCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>linPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1.2151815 0.9997265 0.9638378
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L2Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>0</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L2Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0           100   -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        2000   dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df           100   -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim            2   -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda       100   -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio    100   -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev        1   -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses        1   -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr           1   -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset         1   -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call           5   -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs           1   -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt      1   -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames        20   -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType    1   -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue      2   data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels      1   -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param          0   -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>ridgCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>ridgCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 21 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                       1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept)  0.03898376
</span></span><span class=line><span class=ln> 4</span><span class=cl>## x.1         -0.12140945
</span></span><span class=line><span class=ln> 5</span><span class=cl>## x.2         27.63771674
</span></span><span class=line><span class=ln> 6</span><span class=cl>## x.3         13.46853844
</span></span><span class=line><span class=ln> 7</span><span class=cl>## x.4         26.54402352
</span></span><span class=line><span class=ln> 8</span><span class=cl>## x.5         -0.13838118
</span></span><span class=line><span class=ln> 9</span><span class=cl>## x.6         25.87706885
</span></span><span class=line><span class=ln>10</span><span class=cl>## x.7         29.90687677
</span></span><span class=line><span class=ln>11</span><span class=cl>## x.8         -9.42088971
</span></span><span class=line><span class=ln>12</span><span class=cl>## x.9         -0.08983349
</span></span><span class=line><span class=ln>13</span><span class=cl>## x.10        17.45444598
</span></span><span class=line><span class=ln>14</span><span class=cl>## x.11        -8.33991071
</span></span><span class=line><span class=ln>15</span><span class=cl>## x.12        -7.23653865
</span></span><span class=line><span class=ln>16</span><span class=cl>## x.13         3.35145521
</span></span><span class=line><span class=ln>17</span><span class=cl>## x.14        19.42178898
</span></span><span class=line><span class=ln>18</span><span class=cl>## x.15        -0.02794731
</span></span><span class=line><span class=ln>19</span><span class=cl>## x.16         7.63951382
</span></span><span class=line><span class=ln>20</span><span class=cl>## x.17        11.08083907
</span></span><span class=line><span class=ln>21</span><span class=cl>## x.18        -1.36872894
</span></span><span class=line><span class=ln>22</span><span class=cl>## x.19        20.90257005
</span></span><span class=line><span class=ln>23</span><span class=cl>## x.20        20.07494414
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-64-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>ridgPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 3.7554417 0.9994231 3.0184859
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L1Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>,</span> <span class=c1># for lasso</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L1Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0           47    -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        940    dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df           47    -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim           2    -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda       47    -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio    47    -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev       1    -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses       1    -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr          1    -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset        1    -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call          5    -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs          1    -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt     1    -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames       20    -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType   1    -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue     2    data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels     1    -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param         0    -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>lassoCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>lassoCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 21 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                      1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept)  0.1158884
</span></span><span class=line><span class=ln> 4</span><span class=cl>## x.1          .
</span></span><span class=line><span class=ln> 5</span><span class=cl>## x.2         28.5897869
</span></span><span class=line><span class=ln> 6</span><span class=cl>## x.3         13.3637110
</span></span><span class=line><span class=ln> 7</span><span class=cl>## x.4         27.2558797
</span></span><span class=line><span class=ln> 8</span><span class=cl>## x.5          .
</span></span><span class=line><span class=ln> 9</span><span class=cl>## x.6         26.6625588
</span></span><span class=line><span class=ln>10</span><span class=cl>## x.7         30.6841774
</span></span><span class=line><span class=ln>11</span><span class=cl>## x.8         -9.1388677
</span></span><span class=line><span class=ln>12</span><span class=cl>## x.9          .
</span></span><span class=line><span class=ln>13</span><span class=cl>## x.10        17.9220939
</span></span><span class=line><span class=ln>14</span><span class=cl>## x.11        -8.2461257
</span></span><span class=line><span class=ln>15</span><span class=cl>## x.12        -7.0603651
</span></span><span class=line><span class=ln>16</span><span class=cl>## x.13         3.2052101
</span></span><span class=line><span class=ln>17</span><span class=cl>## x.14        19.7219890
</span></span><span class=line><span class=ln>18</span><span class=cl>## x.15         .
</span></span><span class=line><span class=ln>19</span><span class=cl>## x.16         7.2082509
</span></span><span class=line><span class=ln>20</span><span class=cl>## x.17        10.4137411
</span></span><span class=line><span class=ln>21</span><span class=cl>## x.18        -0.6693664
</span></span><span class=line><span class=ln>22</span><span class=cl>## x.19        21.5357460
</span></span><span class=line><span class=ln>23</span><span class=cl>## x.20        20.5226071
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-69-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lassoPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 2.7289452 0.9992454 2.2029482
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>mGrid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>ncomp</span><span class=o>=</span><span class=nf>seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>1</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>20</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>10</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pcrCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;pcr&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>mGrid</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>pcrCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Data:    X dimension: 100 20
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Y dimension: 100 1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## Fit method: svdpc
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Number of components considered: 20
</span></span><span class=line><span class=ln> 5</span><span class=cl>## TRAINING: % variance explained
</span></span><span class=line><span class=ln> 6</span><span class=cl>##           1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps
</span></span><span class=line><span class=ln> 7</span><span class=cl>## X          10.040    18.46    26.62    34.56    41.87    48.54    54.56
</span></span><span class=line><span class=ln> 8</span><span class=cl>## .outcome    8.425    34.90    41.09    43.12    45.06    48.09    66.44
</span></span><span class=line><span class=ln> 9</span><span class=cl>##           8 comps  9 comps  10 comps  11 comps  12 comps  13 comps  14 comps
</span></span><span class=line><span class=ln>10</span><span class=cl>## X           60.33    65.37     70.01     74.46     78.72     82.32     85.67
</span></span><span class=line><span class=ln>11</span><span class=cl>## .outcome    85.76    88.81     89.93     91.66     91.91     92.04     92.08
</span></span><span class=line><span class=ln>12</span><span class=cl>##           15 comps  16 comps  17 comps  18 comps  19 comps  20 comps
</span></span><span class=line><span class=ln>13</span><span class=cl>## X            88.85     91.94     94.59     96.73     98.51    100.00
</span></span><span class=line><span class=ln>14</span><span class=cl>## .outcome     92.15     94.96     99.51     99.57     99.76     99.99
</span></span><span class=line><span class=ln>15</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>pcrCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-73-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pcrPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>pcrCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>pcrPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1.2151815 0.9997265 0.9638378
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>plsCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;pls&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>mGrid</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>plsCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Data:    X dimension: 100 20
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Y dimension: 100 1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## Fit method: oscorespls
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Number of components considered: 20
</span></span><span class=line><span class=ln> 5</span><span class=cl>## TRAINING: % variance explained
</span></span><span class=line><span class=ln> 6</span><span class=cl>##           1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps
</span></span><span class=line><span class=ln> 7</span><span class=cl>## X           7.762    14.79    21.01    26.89    31.55    36.13    41.12
</span></span><span class=line><span class=ln> 8</span><span class=cl>## .outcome   92.765    98.81    99.75    99.96    99.98    99.99    99.99
</span></span><span class=line><span class=ln> 9</span><span class=cl>##           8 comps  9 comps  10 comps  11 comps  12 comps  13 comps  14 comps
</span></span><span class=line><span class=ln>10</span><span class=cl>## X           46.35    51.21     56.12     60.34     65.63     71.57     76.16
</span></span><span class=line><span class=ln>11</span><span class=cl>## .outcome    99.99    99.99     99.99     99.99     99.99     99.99     99.99
</span></span><span class=line><span class=ln>12</span><span class=cl>##           15 comps  16 comps  17 comps  18 comps  19 comps  20 comps
</span></span><span class=line><span class=ln>13</span><span class=cl>## X            80.72     84.69     88.98     92.69     96.71    100.00
</span></span><span class=line><span class=ln>14</span><span class=cl>## .outcome     99.99     99.99     99.99     99.99     99.99     99.99
</span></span><span class=line><span class=ln>15</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>plsCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-76-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>plsPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>plsCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>plsPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 1.2151815 0.9997265 0.9638378
</span></span></code></pre></div><h4 id=d-test-mse-for-best-models>d) Test MSE for best models</h4><ul><li>All the models have the same R² but Ridge does the worst followed by
LASSO</li></ul><p>For the rest of the question, we will consider the <code>OLS</code> model.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelFit</span><span class=o>&lt;-</span><span class=nf>regsubsets</span><span class=p>(</span><span class=n>y</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>modelDat</span><span class=p>,</span><span class=n>nvmax</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>modelFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Subset selection object
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: regsubsets.formula(y ~ ., data = modelDat, nvmax = 20)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 20 Variables  (and intercept)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##      Forced in Forced out
</span></span><span class=line><span class=ln> 5</span><span class=cl>## x.1      FALSE      FALSE
</span></span><span class=line><span class=ln> 6</span><span class=cl>## x.2      FALSE      FALSE
</span></span><span class=line><span class=ln> 7</span><span class=cl>## x.3      FALSE      FALSE
</span></span><span class=line><span class=ln> 8</span><span class=cl>## x.4      FALSE      FALSE
</span></span><span class=line><span class=ln> 9</span><span class=cl>## x.5      FALSE      FALSE
</span></span><span class=line><span class=ln>10</span><span class=cl>## x.6      FALSE      FALSE
</span></span><span class=line><span class=ln>11</span><span class=cl>## x.7      FALSE      FALSE
</span></span><span class=line><span class=ln>12</span><span class=cl>## x.8      FALSE      FALSE
</span></span><span class=line><span class=ln>13</span><span class=cl>## x.9      FALSE      FALSE
</span></span><span class=line><span class=ln>14</span><span class=cl>## x.10     FALSE      FALSE
</span></span><span class=line><span class=ln>15</span><span class=cl>## x.11     FALSE      FALSE
</span></span><span class=line><span class=ln>16</span><span class=cl>## x.12     FALSE      FALSE
</span></span><span class=line><span class=ln>17</span><span class=cl>## x.13     FALSE      FALSE
</span></span><span class=line><span class=ln>18</span><span class=cl>## x.14     FALSE      FALSE
</span></span><span class=line><span class=ln>19</span><span class=cl>## x.15     FALSE      FALSE
</span></span><span class=line><span class=ln>20</span><span class=cl>## x.16     FALSE      FALSE
</span></span><span class=line><span class=ln>21</span><span class=cl>## x.17     FALSE      FALSE
</span></span><span class=line><span class=ln>22</span><span class=cl>## x.18     FALSE      FALSE
</span></span><span class=line><span class=ln>23</span><span class=cl>## x.19     FALSE      FALSE
</span></span><span class=line><span class=ln>24</span><span class=cl>## x.20     FALSE      FALSE
</span></span><span class=line><span class=ln>25</span><span class=cl>## 1 subsets of each size up to 20
</span></span><span class=line><span class=ln>26</span><span class=cl>## Selection Algorithm: exhaustive
</span></span><span class=line><span class=ln>27</span><span class=cl>##           x.1 x.2 x.3 x.4 x.5 x.6 x.7 x.8 x.9 x.10 x.11 x.12 x.13 x.14 x.15
</span></span><span class=line><span class=ln>28</span><span class=cl>## 1  ( 1 )  &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>29</span><span class=cl>## 2  ( 1 )  &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>30</span><span class=cl>## 3  ( 1 )  &#34; &#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>31</span><span class=cl>## 4  ( 1 )  &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>32</span><span class=cl>## 5  ( 1 )  &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>33</span><span class=cl>## 6  ( 1 )  &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>34</span><span class=cl>## 7  ( 1 )  &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>35</span><span class=cl>## 8  ( 1 )  &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>36</span><span class=cl>## 9  ( 1 )  &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>37</span><span class=cl>## 10  ( 1 ) &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>38</span><span class=cl>## 11  ( 1 ) &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>39</span><span class=cl>## 12  ( 1 ) &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>40</span><span class=cl>## 13  ( 1 ) &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>41</span><span class=cl>## 14  ( 1 ) &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>42</span><span class=cl>## 15  ( 1 ) &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>43</span><span class=cl>## 16  ( 1 ) &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>44</span><span class=cl>## 17  ( 1 ) &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34; &#34;
</span></span><span class=line><span class=ln>45</span><span class=cl>## 18  ( 1 ) &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>46</span><span class=cl>## 19  ( 1 ) &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>47</span><span class=cl>## 20  ( 1 ) &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>48</span><span class=cl>##           x.16 x.17 x.18 x.19 x.20
</span></span><span class=line><span class=ln>49</span><span class=cl>## 1  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>50</span><span class=cl>## 2  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>51</span><span class=cl>## 3  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>52</span><span class=cl>## 4  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>53</span><span class=cl>## 5  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34; &#34;
</span></span><span class=line><span class=ln>54</span><span class=cl>## 6  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>55</span><span class=cl>## 7  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>56</span><span class=cl>## 8  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>57</span><span class=cl>## 9  ( 1 )  &#34; &#34;  &#34; &#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>58</span><span class=cl>## 10  ( 1 ) &#34; &#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>59</span><span class=cl>## 11  ( 1 ) &#34; &#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>60</span><span class=cl>## 12  ( 1 ) &#34; &#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>61</span><span class=cl>## 13  ( 1 ) &#34; &#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>62</span><span class=cl>## 14  ( 1 ) &#34;*&#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>63</span><span class=cl>## 15  ( 1 ) &#34;*&#34;  &#34;*&#34;  &#34; &#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>64</span><span class=cl>## 16  ( 1 ) &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>65</span><span class=cl>## 17  ( 1 ) &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>66</span><span class=cl>## 18  ( 1 ) &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>67</span><span class=cl>## 19  ( 1 ) &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span><span class=line><span class=ln>68</span><span class=cl>## 20  ( 1 ) &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;  &#34;*&#34;
</span></span></code></pre></div><p>We might want to take a look at these.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;Cp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;r2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;adjr2&#39;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-79-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plotLEAP</span><span class=p>(</span><span class=n>modelFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-80-1.png></figure><p>It would appear that 16 variables would be a good bet. We note that the
lasso model did void out 4 parameters, namely x₁,x₃,x₁₃ and x₁₇.</p><p>Lets take a quick look at the various model variable significance
values.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lgp</span><span class=o>&lt;-</span><span class=n>linCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;OLS Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>rgp</span><span class=o>&lt;-</span><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Ridge Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>lsgp</span><span class=o>&lt;-</span><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Lasso Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>pcgp</span><span class=o>&lt;-</span><span class=n>pcrCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;PCR Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=n>plgp</span><span class=o>&lt;-</span><span class=n>plsCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;PLS Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nf>grid.arrange</span><span class=p>(</span><span class=n>lgp</span><span class=p>,</span><span class=n>rgp</span><span class=p>,</span><span class=n>lsgp</span><span class=p>,</span><span class=n>pcgp</span><span class=p>,</span><span class=n>plgp</span><span class=p>,</span><span class=n>ncol</span><span class=o>=</span><span class=m>3</span><span class=p>,</span><span class=n>bottom</span><span class=o>=</span><span class=s>&#34;Effective Importance, scaled&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-81-1.png></figure><h4 id=e-model-size>e) Model size</h4><p>The test set numeric minimum RMSE is a tie between OLS and PCR, and this
was achieved for the (effective) 16 variable OLS model, as well as the
18 variable PCR model.</p><h4 id=f-best-model>f) Best model</h4><p>We will consider the OLS and PCR models and its parameters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>linCol</span><span class=o>$</span><span class=n>finalModel</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln> 6</span><span class=cl>## (Intercept)          x.1          x.2          x.3          x.4          x.5
</span></span><span class=line><span class=ln> 7</span><span class=cl>##    -0.06052     -0.02265     28.91650     14.16532     28.16256      0.13742
</span></span><span class=line><span class=ln> 8</span><span class=cl>##         x.6          x.7          x.8          x.9         x.10         x.11
</span></span><span class=line><span class=ln> 9</span><span class=cl>##    27.01497     31.15917     -9.66308      0.11641     19.06687     -9.09956
</span></span><span class=line><span class=ln>10</span><span class=cl>##        x.12         x.13         x.14         x.15         x.16         x.17
</span></span><span class=line><span class=ln>11</span><span class=cl>##    -8.01933      4.26852     20.22366     -0.16607      7.95594     10.89851
</span></span><span class=line><span class=ln>12</span><span class=cl>##        x.18         x.19         x.20
</span></span><span class=line><span class=ln>13</span><span class=cl>##    -1.09760     22.05197     20.88796
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pcrCol</span><span class=o>$</span><span class=n>bestTune</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##    ncomp
</span></span><span class=line><span class=ln>2</span><span class=cl>## 10    20
</span></span></code></pre></div><p>Now to compare this to the original.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>beta</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##  [1]   0  29  14  28   0  27  31 -10   0  19  -9  -8   4  20   0   8  11  -1  22
</span></span><span class=line><span class=ln>2</span><span class=cl>## [20]  21
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>t</span><span class=o>=</span><span class=nf>data.frame</span><span class=p>(</span><span class=n>linCol</span><span class=o>$</span><span class=n>finalModel</span><span class=o>$</span><span class=n>coefficients[</span><span class=m>-1</span><span class=n>]</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>rename</span><span class=p>(</span><span class=s>&#34;Model_Coeffs&#34;</span><span class=o>=</span><span class=m>1</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>add_column</span><span class=p>(</span><span class=n>beta</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>rename</span><span class=p>(</span><span class=s>&#34;Original_Coeffs&#34;</span><span class=o>=</span><span class=m>2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##      Model_Coeffs Original_Coeffs
</span></span><span class=line><span class=ln> 2</span><span class=cl>## x.1   -0.02265289               0
</span></span><span class=line><span class=ln> 3</span><span class=cl>## x.2   28.91649699              29
</span></span><span class=line><span class=ln> 4</span><span class=cl>## x.3   14.16532050              14
</span></span><span class=line><span class=ln> 5</span><span class=cl>## x.4   28.16255937              28
</span></span><span class=line><span class=ln> 6</span><span class=cl>## x.5    0.13741621               0
</span></span><span class=line><span class=ln> 7</span><span class=cl>## x.6   27.01497459              27
</span></span><span class=line><span class=ln> 8</span><span class=cl>## x.7   31.15917172              31
</span></span><span class=line><span class=ln> 9</span><span class=cl>## x.8   -9.66308362             -10
</span></span><span class=line><span class=ln>10</span><span class=cl>## x.9    0.11641282               0
</span></span><span class=line><span class=ln>11</span><span class=cl>## x.10  19.06687041              19
</span></span><span class=line><span class=ln>12</span><span class=cl>## x.11  -9.09955826              -9
</span></span><span class=line><span class=ln>13</span><span class=cl>## x.12  -8.01932598              -8
</span></span><span class=line><span class=ln>14</span><span class=cl>## x.13   4.26852334               4
</span></span><span class=line><span class=ln>15</span><span class=cl>## x.14  20.22366153              20
</span></span><span class=line><span class=ln>16</span><span class=cl>## x.15  -0.16606531               0
</span></span><span class=line><span class=ln>17</span><span class=cl>## x.16   7.95593559               8
</span></span><span class=line><span class=ln>18</span><span class=cl>## x.17  10.89851353              11
</span></span><span class=line><span class=ln>19</span><span class=cl>## x.18  -1.09759687              -1
</span></span><span class=line><span class=ln>20</span><span class=cl>## x.19  22.05196537              22
</span></span><span class=line><span class=ln>21</span><span class=cl>## x.20  20.88795623              21
</span></span></code></pre></div><p>We see that the coefficients are pretty similar.</p><h4 id=g-plotting-differences>g) Plotting differences</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln> 1</span><span class=cl><span class=n>val.errors</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NaN</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NaN</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NaN</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=n>x_cols</span> <span class=o>=</span> <span class=nf>colnames</span><span class=p>(</span><span class=n>xmat</span><span class=p>,</span> <span class=n>do.NULL</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=n>prefix</span> <span class=o>=</span> <span class=s>&#34;x.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=n>coefi</span> <span class=o>=</span> <span class=nf>coef</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span> <span class=n>id</span> <span class=o>=</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=n>a[i]</span> <span class=o>=</span> <span class=nf>length</span><span class=p>(</span><span class=n>coefi</span><span class=p>)</span> <span class=o>-</span> <span class=m>1</span> <span class=c1>## Not counting the intercept</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=n>b[i]</span> <span class=o>=</span> <span class=nf>sqrt</span><span class=p>(</span><span class=nf>sum</span><span class=p>((</span><span class=n>beta[x_cols</span> <span class=o>%in%</span> <span class=nf>names</span><span class=p>(</span><span class=n>coefi</span><span class=p>)</span><span class=n>]</span> <span class=o>-</span> <span class=n>coefi</span><span class=nf>[names</span><span class=p>(</span><span class=n>coefi</span><span class=p>)</span> <span class=o>%in%</span> <span class=n>x_cols]</span><span class=p>)</span><span class=n>^2</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>        <span class=nf>sum</span><span class=p>(</span><span class=n>beta[</span><span class=o>!</span><span class=p>(</span><span class=n>x_cols</span> <span class=o>%in%</span> <span class=nf>names</span><span class=p>(</span><span class=n>coefi</span><span class=p>))</span><span class=n>]</span><span class=p>)</span><span class=n>^2</span><span class=p>)</span> <span class=c1>## Handling the intercept</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>b</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span> <span class=s>&#34;Number of Coefficients&#34;</span><span class=p>,</span> <span class=n>ylab</span> <span class=o>=</span> <span class=s>&#34;Relative Error&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-84-1.png></figure><h2 id=question-6.11---page-264>Question 6.11 - Page 264</h2><p>We will now try to predict per capita crime rate in the Boston data set.</p><p><strong>(a)</strong> Try out some of the regression methods explored in this chapter,
such as best subset selection, the lasso, ridge regression, and PCR.
Present and discuss results for the approaches that you consider.</p><p><strong>(b)</strong> Propose a model (or set of models) that seem to perform well on
this data set, and justify your answer. Make sure that you are
evaluating model performance using validation set error,
crossvalidation, or some other reasonable alternative, as opposed to
using training error.</p><p><strong>(c)</strong> Does your chosen model involve all of the features in the data
set? Why or why not?</p><h3 id=answer-3>Answer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>&lt;-</span><span class=n>MASS</span><span class=o>::</span><span class=n>Boston</span>
</span></span></code></pre></div><ul><li>Summarize</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    506 obs. of  14 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>##  $ black  : num  397 397 393 395 397 ...
</span></span><span class=line><span class=ln>14</span><span class=cl>##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
</span></span><span class=line><span class=ln>15</span><span class=cl>##  $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...
</span></span><span class=line><span class=ln>16</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##       crim                zn             indus            chas
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  1st Qu.: 0.08204   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000
</span></span><span class=line><span class=ln> 8</span><span class=cl>##       nox               rm             age              dis
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100
</span></span><span class=line><span class=ln>11</span><span class=cl>##  Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207
</span></span><span class=line><span class=ln>12</span><span class=cl>##  Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795
</span></span><span class=line><span class=ln>13</span><span class=cl>##  3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188
</span></span><span class=line><span class=ln>14</span><span class=cl>##  Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127
</span></span><span class=line><span class=ln>15</span><span class=cl>##       rad              tax           ptratio          black
</span></span><span class=line><span class=ln>16</span><span class=cl>##  Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32
</span></span><span class=line><span class=ln>17</span><span class=cl>##  1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38
</span></span><span class=line><span class=ln>18</span><span class=cl>##  Median : 5.000   Median :330.0   Median :19.05   Median :391.44
</span></span><span class=line><span class=ln>19</span><span class=cl>##  Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67
</span></span><span class=line><span class=ln>20</span><span class=cl>##  3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23
</span></span><span class=line><span class=ln>21</span><span class=cl>##  Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90
</span></span><span class=line><span class=ln>22</span><span class=cl>##      lstat            medv
</span></span><span class=line><span class=ln>23</span><span class=cl>##  Min.   : 1.73   Min.   : 5.00
</span></span><span class=line><span class=ln>24</span><span class=cl>##  1st Qu.: 6.95   1st Qu.:17.02
</span></span><span class=line><span class=ln>25</span><span class=cl>##  Median :11.36   Median :21.20
</span></span><span class=line><span class=ln>26</span><span class=cl>##  Mean   :12.65   Mean   :22.53
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3rd Qu.:16.95   3rd Qu.:25.00
</span></span><span class=line><span class=ln>28</span><span class=cl>##  Max.   :37.97   Max.   :50.00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>unique</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>length</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##    crim      zn   indus    chas     nox      rm     age     dis     rad     tax
</span></span><span class=line><span class=ln>2</span><span class=cl>##     504      26      76       2      81     446     356     412       9      66
</span></span><span class=line><span class=ln>3</span><span class=cl>## ptratio   black   lstat    medv
</span></span><span class=line><span class=ln>4</span><span class=cl>##      46     357     455     229
</span></span></code></pre></div><h4 id=a-test-regression-models>a) Test regression models</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_ind</span> <span class=o>=</span> <span class=nf>sample</span><span class=p>(</span><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>,</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_ind</span> <span class=o>=</span> <span class=nf>setdiff</span><span class=p>(</span><span class=nf>seq_len</span><span class=p>(</span><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>),</span> <span class=n>train_set</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_set</span><span class=o>&lt;-</span><span class=n>boston[train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_set</span><span class=o>&lt;-</span><span class=n>boston[</span><span class=o>-</span><span class=n>train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>linCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>crim</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;lm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>linCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = .outcome ~ ., data = dat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##     Min      1Q  Median      3Q     Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -6.2431 -1.0344 -0.0563  0.8187  8.1318
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##               Estimate Std. Error t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept)  0.9339246  7.6508393   0.122   0.9031
</span></span><span class=line><span class=ln>12</span><span class=cl>## zn           0.0046819  0.0157375   0.297   0.7668
</span></span><span class=line><span class=ln>13</span><span class=cl>## indus        0.0276209  0.0875254   0.316   0.7531
</span></span><span class=line><span class=ln>14</span><span class=cl>## chas        -1.1602278  1.2386869  -0.937   0.3516
</span></span><span class=line><span class=ln>15</span><span class=cl>## nox         -7.5024503  5.0207818  -1.494   0.1388
</span></span><span class=line><span class=ln>16</span><span class=cl>## rm           1.1240874  0.7462340   1.506   0.1356
</span></span><span class=line><span class=ln>17</span><span class=cl>## age          0.0020182  0.0137404   0.147   0.8836
</span></span><span class=line><span class=ln>18</span><span class=cl>## dis         -0.3934753  0.2454365  -1.603   0.1126
</span></span><span class=line><span class=ln>19</span><span class=cl>## rad          0.4540613  0.0791580   5.736 1.41e-07 ***
</span></span><span class=line><span class=ln>20</span><span class=cl>## tax          0.0008469  0.0052593   0.161   0.8724
</span></span><span class=line><span class=ln>21</span><span class=cl>## ptratio     -0.2978204  0.1637629  -1.819   0.0725 .
</span></span><span class=line><span class=ln>22</span><span class=cl>## black        0.0030642  0.0045281   0.677   0.5004
</span></span><span class=line><span class=ln>23</span><span class=cl>## lstat        0.1322779  0.0626485   2.111   0.0376 *
</span></span><span class=line><span class=ln>24</span><span class=cl>## medv        -0.0841382  0.0590700  -1.424   0.1580
</span></span><span class=line><span class=ln>25</span><span class=cl>## ---
</span></span><span class=line><span class=ln>26</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>27</span><span class=cl>##
</span></span><span class=line><span class=ln>28</span><span class=cl>## Residual standard error: 2.362 on 86 degrees of freedom
</span></span><span class=line><span class=ln>29</span><span class=cl>## Multiple R-squared:  0.775,  Adjusted R-squared:  0.741
</span></span><span class=line><span class=ln>30</span><span class=cl>## F-statistic: 22.78 on 13 and 86 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>linPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>linCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>linPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>crim</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 7.3794735 0.4056002 2.6774969
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L2Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>0</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>crim</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L2Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0           100   -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        1300   dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df           100   -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim            2   -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda       100   -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio    100   -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev        1   -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses        1   -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr           1   -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset         1   -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call           5   -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs           1   -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt      1   -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames        13   -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType    1   -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue      2   data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels      1   -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param          0   -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>ridgCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>ridgCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 14 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                        1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept) -3.881166065
</span></span><span class=line><span class=ln> 4</span><span class=cl>## zn           0.002597790
</span></span><span class=line><span class=ln> 5</span><span class=cl>## indus       -0.005103517
</span></span><span class=line><span class=ln> 6</span><span class=cl>## chas        -0.674764337
</span></span><span class=line><span class=ln> 7</span><span class=cl>## nox         -0.053645732
</span></span><span class=line><span class=ln> 8</span><span class=cl>## rm           0.600064844
</span></span><span class=line><span class=ln> 9</span><span class=cl>## age          0.001153570
</span></span><span class=line><span class=ln>10</span><span class=cl>## dis         -0.179295384
</span></span><span class=line><span class=ln>11</span><span class=cl>## rad          0.267082956
</span></span><span class=line><span class=ln>12</span><span class=cl>## tax          0.006447932
</span></span><span class=line><span class=ln>13</span><span class=cl>## ptratio     -0.075885753
</span></span><span class=line><span class=ln>14</span><span class=cl>## black       -0.001650403
</span></span><span class=line><span class=ln>15</span><span class=cl>## lstat        0.086462700
</span></span><span class=line><span class=ln>16</span><span class=cl>## medv        -0.027519270
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-94-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>ridgPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>crim</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 7.5065916 0.4017056 2.4777547
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L1Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>,</span> <span class=c1># for lasso</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>crim</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L1Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0            78   -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        1014   dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df            78   -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim            2   -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda        78   -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio     78   -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev        1   -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses        1   -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr           1   -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset         1   -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call           5   -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs           1   -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt      1   -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames        13   -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType    1   -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue      2   data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels      1   -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param          0   -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>lassoCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>lassoCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 14 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                        1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept) -2.024006430
</span></span><span class=line><span class=ln> 4</span><span class=cl>## zn           .
</span></span><span class=line><span class=ln> 5</span><span class=cl>## indus        .
</span></span><span class=line><span class=ln> 6</span><span class=cl>## chas         .
</span></span><span class=line><span class=ln> 7</span><span class=cl>## nox          .
</span></span><span class=line><span class=ln> 8</span><span class=cl>## rm           .
</span></span><span class=line><span class=ln> 9</span><span class=cl>## age          .
</span></span><span class=line><span class=ln>10</span><span class=cl>## dis         -0.008506188
</span></span><span class=line><span class=ln>11</span><span class=cl>## rad          0.386379255
</span></span><span class=line><span class=ln>12</span><span class=cl>## tax          0.001779579
</span></span><span class=line><span class=ln>13</span><span class=cl>## ptratio      .
</span></span><span class=line><span class=ln>14</span><span class=cl>## black        .
</span></span><span class=line><span class=ln>15</span><span class=cl>## lstat        0.040788606
</span></span><span class=line><span class=ln>16</span><span class=cl>## medv         .
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-99-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lassoPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>crim</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 7.5868293 0.3859121 2.4892258
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>mGrid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>ncomp</span><span class=o>=</span><span class=nf>seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>1</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>20</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>10</span><span class=p>))</span>
</span></span></code></pre></div><ul><li>All the models have the same R² but Ridge does the worst followed by
LASSO</li></ul><p>For the rest of the question, we will consider the <code>OLS</code> model.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelFit</span><span class=o>&lt;-</span><span class=nf>regsubsets</span><span class=p>(</span><span class=n>crim</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>boston</span><span class=p>,</span><span class=n>nvmax</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>modelFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Subset selection object
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: regsubsets.formula(crim ~ ., data = boston, nvmax = 20)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 13 Variables  (and intercept)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##         Forced in Forced out
</span></span><span class=line><span class=ln> 5</span><span class=cl>## zn          FALSE      FALSE
</span></span><span class=line><span class=ln> 6</span><span class=cl>## indus       FALSE      FALSE
</span></span><span class=line><span class=ln> 7</span><span class=cl>## chas        FALSE      FALSE
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nox         FALSE      FALSE
</span></span><span class=line><span class=ln> 9</span><span class=cl>## rm          FALSE      FALSE
</span></span><span class=line><span class=ln>10</span><span class=cl>## age         FALSE      FALSE
</span></span><span class=line><span class=ln>11</span><span class=cl>## dis         FALSE      FALSE
</span></span><span class=line><span class=ln>12</span><span class=cl>## rad         FALSE      FALSE
</span></span><span class=line><span class=ln>13</span><span class=cl>## tax         FALSE      FALSE
</span></span><span class=line><span class=ln>14</span><span class=cl>## ptratio     FALSE      FALSE
</span></span><span class=line><span class=ln>15</span><span class=cl>## black       FALSE      FALSE
</span></span><span class=line><span class=ln>16</span><span class=cl>## lstat       FALSE      FALSE
</span></span><span class=line><span class=ln>17</span><span class=cl>## medv        FALSE      FALSE
</span></span><span class=line><span class=ln>18</span><span class=cl>## 1 subsets of each size up to 13
</span></span><span class=line><span class=ln>19</span><span class=cl>## Selection Algorithm: exhaustive
</span></span><span class=line><span class=ln>20</span><span class=cl>##           zn  indus chas nox rm  age dis rad tax ptratio black lstat medv
</span></span><span class=line><span class=ln>21</span><span class=cl>## 1  ( 1 )  &#34; &#34; &#34; &#34;   &#34; &#34;  &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34; &#34;     &#34; &#34;   &#34; &#34;   &#34; &#34;
</span></span><span class=line><span class=ln>22</span><span class=cl>## 2  ( 1 )  &#34; &#34; &#34; &#34;   &#34; &#34;  &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34; &#34;     &#34; &#34;   &#34;*&#34;   &#34; &#34;
</span></span><span class=line><span class=ln>23</span><span class=cl>## 3  ( 1 )  &#34; &#34; &#34; &#34;   &#34; &#34;  &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34; &#34; &#34; &#34;     &#34;*&#34;   &#34;*&#34;   &#34; &#34;
</span></span><span class=line><span class=ln>24</span><span class=cl>## 4  ( 1 )  &#34;*&#34; &#34; &#34;   &#34; &#34;  &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34;     &#34; &#34;   &#34; &#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>25</span><span class=cl>## 5  ( 1 )  &#34;*&#34; &#34; &#34;   &#34; &#34;  &#34; &#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34;     &#34;*&#34;   &#34; &#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>26</span><span class=cl>## 6  ( 1 )  &#34;*&#34; &#34; &#34;   &#34; &#34;  &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34; &#34;     &#34;*&#34;   &#34; &#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>27</span><span class=cl>## 7  ( 1 )  &#34;*&#34; &#34; &#34;   &#34; &#34;  &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;     &#34;*&#34;   &#34; &#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>28</span><span class=cl>## 8  ( 1 )  &#34;*&#34; &#34; &#34;   &#34; &#34;  &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;     &#34;*&#34;   &#34;*&#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>29</span><span class=cl>## 9  ( 1 )  &#34;*&#34; &#34;*&#34;   &#34; &#34;  &#34;*&#34; &#34; &#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;     &#34;*&#34;   &#34;*&#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>30</span><span class=cl>## 10  ( 1 ) &#34;*&#34; &#34;*&#34;   &#34; &#34;  &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34;     &#34;*&#34;   &#34;*&#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>31</span><span class=cl>## 11  ( 1 ) &#34;*&#34; &#34;*&#34;   &#34; &#34;  &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34;     &#34;*&#34;   &#34;*&#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>32</span><span class=cl>## 12  ( 1 ) &#34;*&#34; &#34;*&#34;   &#34;*&#34;  &#34;*&#34; &#34;*&#34; &#34; &#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34;     &#34;*&#34;   &#34;*&#34;   &#34;*&#34;
</span></span><span class=line><span class=ln>33</span><span class=cl>## 13  ( 1 ) &#34;*&#34; &#34;*&#34;   &#34;*&#34;  &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34; &#34;*&#34;     &#34;*&#34;   &#34;*&#34;   &#34;*&#34;
</span></span></code></pre></div><p>We might want to take a look at these.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;Cp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;r2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;adjr2&#39;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-103-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plotLEAP</span><span class=p>(</span><span class=n>modelFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-104-1.png></figure><p>It would appear that 16 variables would be a good bet. We note that the
lasso model did void out 4 parameters, namely x₁,x₃,x₁₃ and x₁₇.</p><p>Lets take a quick look at the various model variable significance
values.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lgp</span><span class=o>&lt;-</span><span class=n>linCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;OLS Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>rgp</span><span class=o>&lt;-</span><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Ridge Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>lsgp</span><span class=o>&lt;-</span><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Lasso Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>grid.arrange</span><span class=p>(</span><span class=n>lgp</span><span class=p>,</span><span class=n>rgp</span><span class=p>,</span><span class=n>lsgp</span><span class=p>,</span><span class=n>ncol</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>bottom</span><span class=o>=</span><span class=s>&#34;Effective Importance, scaled&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-105-1.png></figure><h4 id=b-propose-a-model>b) Propose a model</h4><ul><li><p>Given the data and plots, I would probably end up using the Ridge
regression model</p></li><li><p>Clearly, LASSO is not working very well since it seems to have taken
mainly 3 variables, one of which is largely categorical (9 levels)</p></li></ul><h4 id=c-model-properties>c) Model properties</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    506 obs. of  14 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>##  $ black  : num  397 397 393 395 397 ...
</span></span><span class=line><span class=ln>14</span><span class=cl>##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
</span></span><span class=line><span class=ln>15</span><span class=cl>##  $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...
</span></span><span class=line><span class=ln>16</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##       crim                zn             indus            chas
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  1st Qu.: 0.08204   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000
</span></span><span class=line><span class=ln> 8</span><span class=cl>##       nox               rm             age              dis
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100
</span></span><span class=line><span class=ln>11</span><span class=cl>##  Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207
</span></span><span class=line><span class=ln>12</span><span class=cl>##  Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795
</span></span><span class=line><span class=ln>13</span><span class=cl>##  3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188
</span></span><span class=line><span class=ln>14</span><span class=cl>##  Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127
</span></span><span class=line><span class=ln>15</span><span class=cl>##       rad              tax           ptratio          black
</span></span><span class=line><span class=ln>16</span><span class=cl>##  Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32
</span></span><span class=line><span class=ln>17</span><span class=cl>##  1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38
</span></span><span class=line><span class=ln>18</span><span class=cl>##  Median : 5.000   Median :330.0   Median :19.05   Median :391.44
</span></span><span class=line><span class=ln>19</span><span class=cl>##  Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67
</span></span><span class=line><span class=ln>20</span><span class=cl>##  3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23
</span></span><span class=line><span class=ln>21</span><span class=cl>##  Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90
</span></span><span class=line><span class=ln>22</span><span class=cl>##      lstat            medv
</span></span><span class=line><span class=ln>23</span><span class=cl>##  Min.   : 1.73   Min.   : 5.00
</span></span><span class=line><span class=ln>24</span><span class=cl>##  1st Qu.: 6.95   1st Qu.:17.02
</span></span><span class=line><span class=ln>25</span><span class=cl>##  Median :11.36   Median :21.20
</span></span><span class=line><span class=ln>26</span><span class=cl>##  Mean   :12.65   Mean   :22.53
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3rd Qu.:16.95   3rd Qu.:25.00
</span></span><span class=line><span class=ln>28</span><span class=cl>##  Max.   :37.97   Max.   :50.00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>unique</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>length</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##    crim      zn   indus    chas     nox      rm     age     dis     rad     tax
</span></span><span class=line><span class=ln>2</span><span class=cl>##     504      26      76       2      81     446     356     412       9      66
</span></span><span class=line><span class=ln>3</span><span class=cl>## ptratio   black   lstat    medv
</span></span><span class=line><span class=ln>4</span><span class=cl>##      46     357     455     229
</span></span></code></pre></div><ul><li>A good idea would be removing <code>rad</code> and <code>chas</code> from the regression</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>&lt;-</span><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=nf>subset</span><span class=p>(</span><span class=n>select</span><span class=o>=-</span><span class=nf>c</span><span class=p>(</span><span class=n>rad</span><span class=p>,</span><span class=n>chas</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_ind</span> <span class=o>=</span> <span class=nf>sample</span><span class=p>(</span><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>,</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_ind</span> <span class=o>=</span> <span class=nf>setdiff</span><span class=p>(</span><span class=nf>seq_len</span><span class=p>(</span><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>),</span> <span class=n>train_set</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_set</span><span class=o>&lt;-</span><span class=n>boston[train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_set</span><span class=o>&lt;-</span><span class=n>boston[</span><span class=o>-</span><span class=n>train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L2Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>0</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>crim</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L2Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0           100   -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        1100   dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df           100   -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim            2   -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda       100   -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio    100   -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev        1   -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses        1   -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr           1   -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset         1   -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call           5   -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs           1   -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt      1   -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames        11   -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType    1   -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue      2   data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels      1   -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param          0   -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>ridgCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>ridgCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 12 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                       1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept)  0.23015398
</span></span><span class=line><span class=ln> 4</span><span class=cl>## zn           0.01595378
</span></span><span class=line><span class=ln> 5</span><span class=cl>## indus       -0.01006683
</span></span><span class=line><span class=ln> 6</span><span class=cl>## nox          3.42104450
</span></span><span class=line><span class=ln> 7</span><span class=cl>## rm          -0.05904911
</span></span><span class=line><span class=ln> 8</span><span class=cl>## age          0.01419585
</span></span><span class=line><span class=ln> 9</span><span class=cl>## dis         -0.16724715
</span></span><span class=line><span class=ln>10</span><span class=cl>## tax          0.01021790
</span></span><span class=line><span class=ln>11</span><span class=cl>## ptratio      0.05741508
</span></span><span class=line><span class=ln>12</span><span class=cl>## black       -0.01414707
</span></span><span class=line><span class=ln>13</span><span class=cl>## lstat        0.15519923
</span></span><span class=line><span class=ln>14</span><span class=cl>## medv        -0.04483670
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-113-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>ridgPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>ridgCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>ridgPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>crim</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 6.9365371 0.3619974 2.8570012
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>L1Grid</span> <span class=o>&lt;-</span> <span class=nf>expand.grid</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=m>1</span><span class=p>,</span> <span class=c1># for lasso</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>lambda</span><span class=o>=</span><span class=m>10</span><span class=nf>^seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=m>-3</span><span class=p>,</span><span class=n>to</span><span class=o>=</span><span class=m>30</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=m>100</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span><span class=o>&lt;-</span><span class=nf>train</span><span class=p>(</span><span class=n>crim</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>train_set</span><span class=p>,</span><span class=n>method</span><span class=o>=</span><span class=s>&#34;glmnet&#34;</span><span class=p>,</span><span class=n>tuneGrid</span> <span class=o>=</span> <span class=n>L1Grid</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## There were missing values in resampled performance measures.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##             Length Class      Mode
</span></span><span class=line><span class=ln> 2</span><span class=cl>## a0           74    -none-     numeric
</span></span><span class=line><span class=ln> 3</span><span class=cl>## beta        814    dgCMatrix  S4
</span></span><span class=line><span class=ln> 4</span><span class=cl>## df           74    -none-     numeric
</span></span><span class=line><span class=ln> 5</span><span class=cl>## dim           2    -none-     numeric
</span></span><span class=line><span class=ln> 6</span><span class=cl>## lambda       74    -none-     numeric
</span></span><span class=line><span class=ln> 7</span><span class=cl>## dev.ratio    74    -none-     numeric
</span></span><span class=line><span class=ln> 8</span><span class=cl>## nulldev       1    -none-     numeric
</span></span><span class=line><span class=ln> 9</span><span class=cl>## npasses       1    -none-     numeric
</span></span><span class=line><span class=ln>10</span><span class=cl>## jerr          1    -none-     numeric
</span></span><span class=line><span class=ln>11</span><span class=cl>## offset        1    -none-     logical
</span></span><span class=line><span class=ln>12</span><span class=cl>## call          5    -none-     call
</span></span><span class=line><span class=ln>13</span><span class=cl>## nobs          1    -none-     numeric
</span></span><span class=line><span class=ln>14</span><span class=cl>## lambdaOpt     1    -none-     numeric
</span></span><span class=line><span class=ln>15</span><span class=cl>## xNames       11    -none-     character
</span></span><span class=line><span class=ln>16</span><span class=cl>## problemType   1    -none-     character
</span></span><span class=line><span class=ln>17</span><span class=cl>## tuneValue     2    data.frame list
</span></span><span class=line><span class=ln>18</span><span class=cl>## obsLevels     1    -none-     logical
</span></span><span class=line><span class=ln>19</span><span class=cl>## param         0    -none-     list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coef</span><span class=p>(</span><span class=n>lassoCol</span><span class=o>$</span><span class=n>finalModel</span><span class=p>,</span> <span class=n>lassoCol</span><span class=o>$</span><span class=n>bestTune</span><span class=o>$</span><span class=n>lambda</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## 12 x 1 sparse Matrix of class &#34;dgCMatrix&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>##                       1
</span></span><span class=line><span class=ln> 3</span><span class=cl>## (Intercept)  0.86635621
</span></span><span class=line><span class=ln> 4</span><span class=cl>## zn           .
</span></span><span class=line><span class=ln> 5</span><span class=cl>## indus        .
</span></span><span class=line><span class=ln> 6</span><span class=cl>## nox          .
</span></span><span class=line><span class=ln> 7</span><span class=cl>## rm           .
</span></span><span class=line><span class=ln> 8</span><span class=cl>## age          .
</span></span><span class=line><span class=ln> 9</span><span class=cl>## dis          .
</span></span><span class=line><span class=ln>10</span><span class=cl>## tax          0.01402174
</span></span><span class=line><span class=ln>11</span><span class=cl>## ptratio      .
</span></span><span class=line><span class=ln>12</span><span class=cl>## black       -0.01454496
</span></span><span class=line><span class=ln>13</span><span class=cl>## lstat        0.15290845
</span></span><span class=line><span class=ln>14</span><span class=cl>## medv         .
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-118-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>lassoPred</span><span class=o>&lt;-</span><span class=nf>predict</span><span class=p>(</span><span class=n>lassoCol</span><span class=p>,</span><span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lassoPred</span> <span class=o>%&gt;%</span> <span class=nf>postResample</span><span class=p>(</span><span class=n>obs</span> <span class=o>=</span> <span class=n>test_set</span><span class=o>$</span><span class=n>crim</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##      RMSE  Rsquared       MAE
</span></span><span class=line><span class=ln>2</span><span class=cl>## 6.9630616 0.3693364 2.6767742
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>rgp</span><span class=o>&lt;-</span><span class=n>ridgCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Ridge Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>lsgp</span><span class=o>&lt;-</span><span class=n>lassoCol</span> <span class=o>%&gt;%</span> <span class=n>varImp</span> <span class=o>%&gt;%</span> <span class=n>ggplot</span> <span class=o>+</span> <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;Lasso Variable Importance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>grid.arrange</span><span class=p>(</span><span class=n>rgp</span><span class=p>,</span><span class=n>lsgp</span><span class=p>,</span><span class=n>ncol</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>bottom</span><span class=o>=</span><span class=s>&#34;Effective Importance, scaled&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol4/unnamed-chunk-120-1.png></figure><p>None of these models are actually any good apparently, given that we
have an R² of 0.3619974 for the L2 regularization and 0.3693364 for the
L1.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>James, G., Witten, D., Hastie, T., & Tibshirani, R. (2013). An
Introduction to Statistical Learning: with Applications in R.
Berlin, Germany: Springer Science & Business Media.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Lang et al., (2019). mlr3: A modern object-oriented machine
learning framework in R. Journal of Open Source Software, 4(44),
1903, <a href=https://doi.org/10.21105/joss.01903>https://doi.org/10.21105/joss.01903</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://rgoswami.me/tags/solutions>solutions</a></span><span class=tag><a href=https://rgoswami.me/tags/r>R</a></span><span class=tag><a href=https://rgoswami.me/tags/islr>ISLR</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>11986 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Posted: <time class=dt-published>2020-02-19 07:00 +0000</time></p><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch6%2f" target=_blank rel=noopener aria-label=Facebook><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15.84 9.5H13.5V8.48c0-.53.35-.65.6-.65h1.4v-2.3h-2.35c-2.3.0-2.65 1.7-2.65 2.8V9.5h-2v2h2v7h3v-7h2.1l.24-2z"/></svg></div>Facebook</div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=%22ISLR%20%3a%3a%20Linear%20Model%20Selection%20and%20Regularization%22%20seems%20like%20an%20interesting%20read%20from%20%40rg0swami&url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch6%2f" target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3.0 1 .4 1.7 1.2 2.2-.5.0-1 0-1.2-.3.0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8.0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="12" cy="12" r="11.5"/></svg></div>Twitter</div></a><a class=resp-sharing-button__link href="mailto:?subject=%22ISLR%20%3a%3a%20Linear%20Model%20Selection%20and%20Regularization%22%20seems%20interesting...&body=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch6%2f" target=_self rel=noopener aria-label=E-Mail><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 16c0 .8-.7 1.5-1.5 1.5H6c-.8.0-1.5-.7-1.5-1.5V8c0-.8.7-1.5 1.5-1.5h12c.8.0 1.5.7 1.5 1.5v8zm-2-7.5L12 13 6.5 8.5m11 6-4-2.5m-7 2.5 4-2.5"/><circle cx="12" cy="12" r="11.5"/></svg></div>E-Mail</div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch6%2f&title=%22ISLR%20%3a%3a%20Linear%20Model%20Selection%20and%20Regularization%22%20seems%20interesting...&summary=%22ISLR%20%3a%3a%20Linear%20Model%20Selection%20and%20Regularization%22%20seems%20interesting...&source=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch6%2f" target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15 12.5c-.28.0-.5.22-.5.5v3.5h-3s.03-6.48.0-7h3v.83s.46-.75 1.7-.75c1.56.0 2.3 1.12 2.3 3.3v3.62h-3V13c0-.28-.23-.5-.5-.5zm-7.5-3h2v7h-2z"/><circle cx="8.5" cy="6.5" r="1"/></svg></div>LinkedIn</div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch6%2f&resubmit=true&title=%22ISLR%20%3a%3a%20Linear%20Model%20Selection%20and%20Regularization%22%20seems%20interesting..." target=_blank rel=noopener aria-label=Reddit><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><ellipse cx="12" cy="14.37" rx="6.2" ry="4.24"/><path d="M14.3 16.25c-.62.36-1.42.57-2.3.57s-1.7-.2-2.32-.58"/><circle cx="14.61" cy="13.39" r=".98"/><circle cx="9.39" cy="13.39" r=".98"/><path d="M16.4 11.38c.26-.55.82-.92 1.47-.92.9.0 1.63.73 1.63 1.63.0.8-.6 1.47-1.38 1.6"/><circle cx="17.22" cy="7.52" r="1.63"/><path d="M7.6 11.38c-.26-.54-.82-.92-1.47-.92-.9.0-1.63.73-1.63 1.63.0.8.6 1.47 1.38 1.6M12 10.12s-.08-4.82 3.6-2.6"/></svg></div>Reddit</div></a><a class=resp-sharing-button__link href="whatsapp://send?text=%22ISLR%20%3a%3a%20Linear%20Model%20Selection%20and%20Regularization%22%20seems%20interesting...%20https%3a%2f%2frgoswami.me%2fposts%2fislr-ch6%2f" target=_blank rel=noopener aria-label=WhatsApp><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle xmlns="http://www.w3.org/2000/svg" cx="12" cy="12" r="11.5"/><path stroke-width="1" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3.0-7.8 3.5-7.8 7.8.0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4.9 3.7.9 4.3.0 7.8-3.5 7.8-7.8.1-2-.7-3.9-2.2-5.4zm-5.5 11.9c-1.2.0-2.3-.3-3.3-.9l-.2-.1-2.4.6.7-2.4-.2-.2c-.6-1-1-2.2-1-3.4.0-3.6 2.9-6.5 6.5-6.5 1.7.0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.4-6.6 6.4zm3.5-4.8c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1s-.5.6-.6.8c-.1.1-.2.1-.4.0s-.8-.3-1.6-1c-.6-.5-1-1.2-1.1-1.3-.1-.2.0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.0-.2.0-.3s-.4-1.1-.6-1.4c-.2-.4-.3-.3-.4-.3h-.4s-.3.0-.5.2-.7.7-.7 1.6c0 1 .7 1.9.8 2s1.4 2.1 3.3 2.9c.5.2.8.3 1.1.4.5.1.9.1 1.2.1.4-.1 1.1-.5 1.3-.9.2-.5.2-.8.1-.9.0-.2-.2-.3-.4-.4z"/></svg></div>WhatsApp</div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://rgoswami.me/posts/islr-ch7/><span class=button__icon>←</span>
<span class=button__text>ISLR :: Moving Beyond Linearity</span></a></span>
<span class="button next"><a href=https://rgoswami.me/posts/islr-ch5/><span class=button__text>ISLR :: Resampling Methods</span>
<span class=button__icon>→</span></a></span></div></div><div id=comments class=thin><div class=pagination__title><span class=pagination__title-h>Comments</span><hr></div><script src=https://utteranc.es/client.js repo=haozeke/haozeke.github.io issue-term=pathname theme=photon-dark label="Utterance 💬" crossorigin=anonymous async></script></div></main><footer class=footer><p>&copy; 2022
<span><a href=https://rgoswami.me/>Rohit Goswami (HaoZeke)</a></span>
<a href=https://rgoswami.me/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a><br><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br><script src=https://liberapay.com/rohit/widgets/button.js></script><noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript></p></footer></div><script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script>
<script>(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-109503488-16","auto"),ga("send","pageview")</script><script type=text/javascript>(function(e,o,t,i,a,n,s){e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},n=o.createElement(i),n.async=1,n.src="https://www.clarity.ms/tag/"+a,s=o.getElementsByTagName(i)[0],s.parentNode.insertBefore(n,s)})(window,document,"clarity","script","3z2xvwqu4u")</script><script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script><script async src=https://static.getclicky.com/js></script>
<script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script>
<script src=/js/codefold.min.d0515ab08b3615633a8e8628e085c3c753ffc806b6d58bc2221083be6e9ab17a7a86ac9b4fc772c93a44f5d665dc13e87de3bc389b27c736e2a6a46e0df12f9c.js></script></body></html>