<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[  &#34;Rohit Goswami&#34;
  ]"><meta name=description content="Chapter VII - Moving Beyond Linearity All the questions are as per the ISL seventh printing of the First edition1.
Common 1libsUsed&amp;lt;-c(&amp;#34;dplyr&amp;#34;,&amp;#34;ggplot2&amp;#34;,&amp;#34;tidyverse&amp;#34;, 2 &amp;#34;ISLR&amp;#34;,&amp;#34;caret&amp;#34;,&amp;#34;MASS&amp;#34;, &amp;#34;gridExtra&amp;#34;, 3 &amp;#34;pls&amp;#34;,&amp;#34;latex2exp&amp;#34;,&amp;#34;data.table&amp;#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 7.6 - Page 299 In this exercise, you will further analyze the Wage data set considered throughout this chapter.
(a) Perform polynomial regression to predict wage using age. Use cross-validation to select the optimal degree d for the polynomial."><meta name=keywords content="personal,solutions,R,ISLR"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rgoswami.me/posts/islr-ch7/><meta name=generator content="Wooframework"><title>"ISLR :: Moving Beyond Linearity"
:: Rohit Goswami â€” Reflections</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.054e30538b054b321af6575a7659f551cec63e1cef6bbd674acccadf856d3aff.css><meta itemprop=name content="  &#34;ISLR :: Moving Beyond Linearity&#34;
  "><meta itemprop=description content="Chapter VII - Moving Beyond Linearity All the questions are as per the ISL seventh printing of the First edition1.
Common 1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2 &#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, 3 &#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 7.6 - Page 299 In this exercise, you will further analyze the Wage data set considered throughout this chapter.
(a) Perform polynomial regression to predict wage using age. Use cross-validation to select the optimal degree d for the polynomial."><meta itemprop=datePublished content="2020-02-19T09:47:00+00:00"><meta itemprop=dateModified content="2020-02-19T09:47:00+00:00"><meta itemprop=wordCount content="5913"><meta itemprop=image content="https://rgoswami.me/images/RG.png"><meta itemprop=keywords content="solutions,R,ISLR,"><meta property="og:title" content="  &#34;ISLR :: Moving Beyond Linearity&#34;
  "><meta property="og:description" content="Chapter VII - Moving Beyond Linearity All the questions are as per the ISL seventh printing of the First edition1.
Common 1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2 &#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, 3 &#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 7.6 - Page 299 In this exercise, you will further analyze the Wage data set considered throughout this chapter.
(a) Perform polynomial regression to predict wage using age. Use cross-validation to select the optimal degree d for the polynomial."><meta property="og:type" content="article"><meta property="og:url" content="https://rgoswami.me/posts/islr-ch7/"><meta property="og:image" content="https://rgoswami.me/images/RG.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-19T09:47:00+00:00"><meta property="article:modified_time" content="2020-02-19T09:47:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rgoswami.me/images/RG.png"><meta name=twitter:title content="  &#34;ISLR :: Moving Beyond Linearity&#34;
  "><meta name=twitter:description content="Chapter VII - Moving Beyond Linearity All the questions are as per the ISL seventh printing of the First edition1.
Common 1libsUsed<-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, 2 &#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, 3 &#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) 4invisible(lapply(libsUsed, library, character.only = TRUE)) Question 7.6 - Page 299 In this exercise, you will further analyze the Wage data set considered throughout this chapter.
(a) Perform polynomial regression to predict wage using age. Use cross-validation to select the optimal degree d for the polynomial."><meta property="article:section" content="programming"><meta property="article:published_time" content="2020-02-19 09:47:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><div class=header__inner><div class=header__left><div class=logo><a href=/ style=text-decoration:none><img src=/images/home.png alt></a></div></div><div class=header__mid><button class=button><div class=button__text><a href=https://rgoswami.me//search>Search</a></div></button></div><div class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>Blog</a></li><li><a href=/series>Series</a></li></ul><ul class=menu__inner><li><a href=/categories>Categories</a></li><li><a href=/snippets>Snippets</a></li><li><a href=/tags>Tags</a></li></ul></nav><button id=toggleMenu><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></div></button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></button></div></div></header><script src=/js/mathjax-config.js></script>
<script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script><aside class=sidebar><div class=hideTOC><button id=tocTog>TOC</button><div class="sideTOC m-fadeOut"><nav id=TableOfContents><ul><li><a href=#chapter-vii---linear-model-selection-and-regularization>Chapter VII - Moving Beyond Linearity</a><ul><li><a href=#common>Common</a></li></ul></li><li><a href=#question-7.6---page-299>Question 7.6 - Page 299</a><ul><li><a href=#answer>Answer</a></li></ul></li><li><a href=#question-7.8---page-299>Question 7.8 - Page 299</a><ul><li><a href=#answer-1>Answer</a></li></ul></li><li><a href=#question-7.9---pages-299-300>Question 7.9 - Pages 299-300</a><ul><li><a href=#answer-2>Answer</a></li></ul></li><li><a href=#question-10---page-300>Question 10 - Page 300</a><ul><li><a href=#answer-3>Answer</a></li></ul></li></ul></nav></div></div></aside><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>28 minutes<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Written: 2020-02-19 09:47 +0000</p></p></div><article class=h-entry><h1 class="post-title p-name"><a class=u-url href=https://rgoswami.me/posts/islr-ch7/>&ldquo;ISLR :: Moving Beyond Linearity&rdquo;</a></h1><div class=post-info><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pen-tool"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg><span class="author u-author p-author"><a href=/author/rohit-goswami>"Rohit Goswami"</a></span></div><hr><aside id=toc class=sidebar><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#chapter-vii---linear-model-selection-and-regularization>Chapter VII - Moving Beyond Linearity</a><ul><li><a href=#common>Common</a></li></ul></li><li><a href=#question-7.6---page-299>Question 7.6 - Page 299</a><ul><li><a href=#answer>Answer</a></li></ul></li><li><a href=#question-7.8---page-299>Question 7.8 - Page 299</a><ul><li><a href=#answer-1>Answer</a></li></ul></li><li><a href=#question-7.9---pages-299-300>Question 7.9 - Pages 299-300</a><ul><li><a href=#answer-2>Answer</a></li></ul></li><li><a href=#question-10---page-300>Question 10 - Page 300</a><ul><li><a href=#answer-3>Answer</a></li></ul></li></ul></nav></aside><hr><div class="post-content e-content"><h2 id=chapter-vii---linear-model-selection-and-regularization>Chapter VII - Moving Beyond Linearity</h2><p>All the questions are as per the
<a href=https://www.statlearning.com/>ISL seventh
printing of the First edition</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><h3 id=common>Common</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>libsUsed</span><span class=o>&lt;-</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;dplyr&#34;</span><span class=p>,</span><span class=s>&#34;ggplot2&#34;</span><span class=p>,</span><span class=s>&#34;tidyverse&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>            <span class=s>&#34;ISLR&#34;</span><span class=p>,</span><span class=s>&#34;caret&#34;</span><span class=p>,</span><span class=s>&#34;MASS&#34;</span><span class=p>,</span> <span class=s>&#34;gridExtra&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>            <span class=s>&#34;pls&#34;</span><span class=p>,</span><span class=s>&#34;latex2exp&#34;</span><span class=p>,</span><span class=s>&#34;data.table&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>invisible</span><span class=p>(</span><span class=nf>lapply</span><span class=p>(</span><span class=n>libsUsed</span><span class=p>,</span> <span class=n>library</span><span class=p>,</span> <span class=n>character.only</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=question-7.6---page-299>Question 7.6 - Page 299</h2><p>In this exercise, you will further analyze the <code>Wage</code> data set
considered throughout this chapter.</p><p><strong>(a)</strong> Perform polynomial regression to predict <code>wage</code> using <code>age</code>. Use
cross-validation to select the optimal degree <em>d</em> for the polynomial.
What degree was chosen, and how does this compare to the results of
hypothesis testing using ANOVA? Make a plot of the resulting polynomial
fit to the data.</p><p><strong>(b)</strong> Fit a step function to predict <code>wage</code> using <code>age</code>, and perform
cross-validation to choose the optimal number of cuts. Make a plot of
the fit obtained. In this exercise, we will generate simulated data, and
will then use this data to perform best subset selection.</p><h3 id=answer>Answer</h3><p>Lets get the data.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>1984</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>wageDat</span><span class=o>&lt;-</span><span class=n>ISLR</span><span class=o>::</span><span class=n>Wage</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>wageDat</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    3000 obs. of  11 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ year      : int  2006 2004 2003 2003 2005 2008 2009 2008 2006 2004 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ age       : int  18 24 45 43 50 54 44 30 41 52 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ maritl    : Factor w/ 5 levels &#34;1. Never Married&#34;,..: 1 1 2 2 4 2 2 1 1 2 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ race      : Factor w/ 4 levels &#34;1. White&#34;,&#34;2. Black&#34;,..: 1 1 1 3 1 1 4 3 2 1 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ education : Factor w/ 5 levels &#34;1. &lt; HS Grad&#34;,..: 1 4 3 4 2 4 3 3 3 2 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ region    : Factor w/ 9 levels &#34;1. New England&#34;,..: 2 2 2 2 2 2 2 2 2 2 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ jobclass  : Factor w/ 2 levels &#34;1. Industrial&#34;,..: 1 2 1 2 2 2 1 2 2 2 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ health    : Factor w/ 2 levels &#34;1. &lt;=Good&#34;,&#34;2. &gt;=Very Good&#34;: 1 2 1 2 1 2 2 1 2 2 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ health_ins: Factor w/ 2 levels &#34;1. Yes&#34;,&#34;2. No&#34;: 2 2 1 1 1 1 1 1 1 1 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ logwage   : num  4.32 4.26 4.88 5.04 4.32 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ wage      : num  75 70.5 131 154.7 75 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>wageDat</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##       year           age                     maritl           race
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Min.   :2003   Min.   :18.00   1. Never Married: 648   1. White:2480
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  1st Qu.:2004   1st Qu.:33.75   2. Married      :2074   2. Black: 293
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  Median :2006   Median :42.00   3. Widowed      :  19   3. Asian: 190
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  Mean   :2006   Mean   :42.41   4. Divorced     : 204   4. Other:  37
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  3rd Qu.:2008   3rd Qu.:51.00   5. Separated    :  55
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  Max.   :2009   Max.   :80.00
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>##               education                     region               jobclass
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1. &lt; HS Grad      :268   2. Middle Atlantic   :3000   1. Industrial :1544
</span></span><span class=line><span class=ln>11</span><span class=cl>##  2. HS Grad        :971   1. New England       :   0   2. Information:1456
</span></span><span class=line><span class=ln>12</span><span class=cl>##  3. Some College   :650   3. East North Central:   0
</span></span><span class=line><span class=ln>13</span><span class=cl>##  4. College Grad   :685   4. West North Central:   0
</span></span><span class=line><span class=ln>14</span><span class=cl>##  5. Advanced Degree:426   5. South Atlantic    :   0
</span></span><span class=line><span class=ln>15</span><span class=cl>##                           6. East South Central:   0
</span></span><span class=line><span class=ln>16</span><span class=cl>##                           (Other)              :   0
</span></span><span class=line><span class=ln>17</span><span class=cl>##             health      health_ins      logwage           wage
</span></span><span class=line><span class=ln>18</span><span class=cl>##  1. &lt;=Good     : 858   1. Yes:2083   Min.   :3.000   Min.   : 20.09
</span></span><span class=line><span class=ln>19</span><span class=cl>##  2. &gt;=Very Good:2142   2. No : 917   1st Qu.:4.447   1st Qu.: 85.38
</span></span><span class=line><span class=ln>20</span><span class=cl>##                                      Median :4.653   Median :104.92
</span></span><span class=line><span class=ln>21</span><span class=cl>##                                      Mean   :4.654   Mean   :111.70
</span></span><span class=line><span class=ln>22</span><span class=cl>##                                      3rd Qu.:4.857   3rd Qu.:128.68
</span></span><span class=line><span class=ln>23</span><span class=cl>##                                      Max.   :5.763   Max.   :318.34
</span></span><span class=line><span class=ln>24</span><span class=cl>##
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>wageDat</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>unique</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>length</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##       year        age     maritl       race  education     region   jobclass
</span></span><span class=line><span class=ln>2</span><span class=cl>##          7         61          5          4          5          1          2
</span></span><span class=line><span class=ln>3</span><span class=cl>##     health health_ins    logwage       wage
</span></span><span class=line><span class=ln>4</span><span class=cl>##          2          2        508        508
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>boot</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##
</span></span><span class=line><span class=ln>2</span><span class=cl>## Attaching package: &#39;boot&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## The following object is masked from &#39;package:lattice&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##
</span></span><span class=line><span class=ln>3</span><span class=cl>##     melanoma
</span></span></code></pre></div><h4 id=a-polynomial-regression>a) Polynomial regression</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln> 1</span><span class=cl><span class=n>all.deltas</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=n>glm.fit</span> <span class=o>=</span> <span class=nf>glm</span><span class=p>(</span><span class=n>wage</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>age</span><span class=p>,</span> <span class=n>i</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>Wage</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=n>all.deltas[i]</span> <span class=o>=</span> <span class=nf>cv.glm</span><span class=p>(</span><span class=n>Wage</span><span class=p>,</span> <span class=n>glm.fit</span><span class=p>,</span> <span class=n>K</span><span class=o>=</span><span class=m>10</span><span class=p>)</span><span class=o>$</span><span class=n>delta[2]</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>10</span><span class=p>,</span> <span class=n>all.deltas</span><span class=p>,</span> <span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Degree&#34;</span><span class=p>,</span> <span class=n>ylab</span><span class=o>=</span><span class=s>&#34;CV error&#34;</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;l&#34;</span><span class=p>,</span> <span class=n>pch</span><span class=o>=</span><span class=m>20</span><span class=p>,</span> <span class=n>lwd</span><span class=o>=</span><span class=m>2</span><span class=p>,</span> <span class=n>ylim</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>1590</span><span class=p>,</span> <span class=m>1700</span><span class=p>))</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=n>min.point</span> <span class=o>=</span> <span class=nf>min</span><span class=p>(</span><span class=n>all.deltas</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=n>sd.points</span> <span class=o>=</span> <span class=nf>sd</span><span class=p>(</span><span class=n>all.deltas</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=nf>abline</span><span class=p>(</span><span class=n>h</span><span class=o>=</span><span class=n>min.point</span> <span class=o>+</span> <span class=m>0.2</span> <span class=o>*</span> <span class=n>sd.points</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>,</span> <span class=n>lty</span><span class=o>=</span><span class=s>&#34;dashed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=nf>abline</span><span class=p>(</span><span class=n>h</span><span class=o>=</span><span class=n>min.point</span> <span class=o>-</span> <span class=m>0.2</span> <span class=o>*</span> <span class=n>sd.points</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>,</span> <span class=n>lty</span><span class=o>=</span><span class=s>&#34;dashed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=nf>legend</span><span class=p>(</span><span class=s>&#34;topright&#34;</span><span class=p>,</span> <span class=s>&#34;0.2-standard deviation lines&#34;</span><span class=p>,</span> <span class=n>lty</span><span class=o>=</span><span class=s>&#34;dashed&#34;</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-4-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1># ANOVA</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>fits</span><span class=o>=</span><span class=nf>list</span><span class=p>()</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=n>fits[[i]]</span><span class=o>=</span><span class=nf>glm</span><span class=p>(</span><span class=n>wage</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>age</span><span class=p>,</span><span class=n>i</span><span class=p>),</span><span class=n>data</span><span class=o>=</span><span class=n>wageDat</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nf>anova</span><span class=p>(</span><span class=n>fits[[1]]</span><span class=p>,</span><span class=n>fits[[2]]</span><span class=p>,</span><span class=n>fits[[3]]</span><span class=p>,</span><span class=n>fits[[4]]</span><span class=p>,</span><span class=n>fits[[5]]</span><span class=p>,</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>  <span class=n>fits[[6]]</span><span class=p>,</span><span class=n>fits[[7]]</span><span class=p>,</span><span class=n>fits[[8]]</span><span class=p>,</span><span class=n>fits[[9]]</span><span class=p>,</span><span class=n>fits[[10]]</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Analysis of Deviance Table
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## Model  1: wage ~ poly(age, i)
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Model  2: wage ~ poly(age, i)
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Model  3: wage ~ poly(age, i)
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Model  4: wage ~ poly(age, i)
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Model  5: wage ~ poly(age, i)
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Model  6: wage ~ poly(age, i)
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Model  7: wage ~ poly(age, i)
</span></span><span class=line><span class=ln>10</span><span class=cl>## Model  8: wage ~ poly(age, i)
</span></span><span class=line><span class=ln>11</span><span class=cl>## Model  9: wage ~ poly(age, i)
</span></span><span class=line><span class=ln>12</span><span class=cl>## Model 10: wage ~ poly(age, i)
</span></span><span class=line><span class=ln>13</span><span class=cl>##    Resid. Df Resid. Dev Df Deviance
</span></span><span class=line><span class=ln>14</span><span class=cl>## 1       2998    5022216
</span></span><span class=line><span class=ln>15</span><span class=cl>## 2       2997    4793430  1   228786
</span></span><span class=line><span class=ln>16</span><span class=cl>## 3       2996    4777674  1    15756
</span></span><span class=line><span class=ln>17</span><span class=cl>## 4       2995    4771604  1     6070
</span></span><span class=line><span class=ln>18</span><span class=cl>## 5       2994    4770322  1     1283
</span></span><span class=line><span class=ln>19</span><span class=cl>## 6       2993    4766389  1     3932
</span></span><span class=line><span class=ln>20</span><span class=cl>## 7       2992    4763834  1     2555
</span></span><span class=line><span class=ln>21</span><span class=cl>## 8       2991    4763707  1      127
</span></span><span class=line><span class=ln>22</span><span class=cl>## 9       2990    4756703  1     7004
</span></span><span class=line><span class=ln>23</span><span class=cl>## 10      2989    4756701  1        3
</span></span></code></pre></div><ul><li>The 4th degree looks the best at the moment</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1># 3rd or 4th degrees look best based on ANOVA test</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=c1># let&#39;s go with 4th degree fit</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>wage</span><span class=o>~</span><span class=n>age</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>wageDat</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;darkgrey&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>agelims</span> <span class=o>=</span> <span class=nf>range</span><span class=p>(</span><span class=n>wageDat</span><span class=o>$</span><span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=n>age.grid</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=n>from</span><span class=o>=</span><span class=n>agelims[1]</span><span class=p>,</span> <span class=n>to</span><span class=o>=</span><span class=n>agelims[2]</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=n>lm.fit</span> <span class=o>=</span> <span class=nf>lm</span><span class=p>(</span><span class=n>wage</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>age</span><span class=p>,</span> <span class=m>4</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>wageDat</span><span class=p>)</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=n>lm.pred</span> <span class=o>=</span> <span class=nf>predict</span><span class=p>(</span><span class=n>lm.fit</span><span class=p>,</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>age</span><span class=o>=</span><span class=n>age.grid</span><span class=p>))</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=nf>lines</span><span class=p>(</span><span class=n>age.grid</span><span class=p>,</span> <span class=n>lm.pred</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>,</span> <span class=n>lwd</span><span class=o>=</span><span class=m>2</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-6-1.png></figure><h4 id=b-step-function-and-cross-validation>b) Step function and cross-validation</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1># cross-validation</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>cv.error</span> <span class=o>&lt;-</span> <span class=nf>rep</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>9</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>2</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=n>wageDat</span><span class=o>$</span><span class=n>age.cut</span> <span class=o>&lt;-</span> <span class=nf>cut</span><span class=p>(</span><span class=n>wageDat</span><span class=o>$</span><span class=n>age</span><span class=p>,</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>  <span class=n>glm.fit</span> <span class=o>&lt;-</span> <span class=nf>glm</span><span class=p>(</span><span class=n>wage</span><span class=o>~</span><span class=n>age.cut</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>wageDat</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>  <span class=n>cv.error[i</span><span class=m>-1</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=nf>cv.glm</span><span class=p>(</span><span class=n>wageDat</span><span class=p>,</span> <span class=n>glm.fit</span><span class=p>,</span> <span class=n>K</span><span class=o>=</span><span class=m>10</span><span class=p>)</span><span class=o>$</span><span class=n>delta[1]</span>  <span class=c1># [1]:std, [2]:bias-corrected</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=n>cv.error</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 1732.337 1682.978 1636.736 1635.600 1624.174 1610.688 1604.081 1612.005
</span></span><span class=line><span class=ln>2</span><span class=cl>## [9] 1607.022
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>cv.error</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 1732.337 1682.978 1636.736 1635.600 1624.174 1610.688 1604.081 1612.005
</span></span><span class=line><span class=ln>2</span><span class=cl>## [9] 1607.022
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=m>2</span><span class=o>:</span><span class=m>10</span><span class=p>,</span> <span class=n>cv.error</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-7-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>cut.fit</span> <span class=o>&lt;-</span> <span class=nf>glm</span><span class=p>(</span><span class=n>wage</span><span class=o>~</span><span class=nf>cut</span><span class=p>(</span><span class=n>age</span><span class=p>,</span><span class=m>8</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>wageDat</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>preds</span> <span class=o>&lt;-</span> <span class=nf>predict</span><span class=p>(</span><span class=n>cut.fit</span><span class=p>,</span> <span class=n>newdata</span><span class=o>=</span><span class=nf>list</span><span class=p>(</span><span class=n>age</span><span class=o>=</span><span class=n>age.grid</span><span class=p>),</span> <span class=n>se</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>se.bands</span> <span class=o>&lt;-</span> <span class=n>preds</span><span class=o>$</span><span class=n>fit</span> <span class=o>+</span> <span class=nf>cbind</span><span class=p>(</span><span class=m>2</span><span class=o>*</span><span class=n>preds</span><span class=o>$</span><span class=n>se.fit</span><span class=p>,</span> <span class=m>-2</span><span class=o>*</span><span class=n>preds</span><span class=o>$</span><span class=n>se.fit</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>wageDat</span><span class=o>$</span><span class=n>age</span><span class=p>,</span> <span class=n>wageDat</span><span class=o>$</span><span class=n>wage</span><span class=p>,</span> <span class=n>xlim</span><span class=o>=</span><span class=n>agelims</span><span class=p>,</span> <span class=n>cex</span><span class=o>=</span><span class=m>0.5</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;darkgrey&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>title</span><span class=p>(</span><span class=s>&#34;Fit with 8 Age Bands&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nf>lines</span><span class=p>(</span><span class=n>age.grid</span><span class=p>,</span> <span class=n>preds</span><span class=o>$</span><span class=n>fit</span><span class=p>,</span> <span class=n>lwd</span><span class=o>=</span><span class=m>2</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=nf>matlines</span><span class=p>(</span><span class=n>age.grid</span><span class=p>,</span> <span class=n>se.bands</span><span class=p>,</span> <span class=n>lwd</span><span class=o>=</span><span class=m>1</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>,</span> <span class=n>lty</span><span class=o>=</span><span class=m>3</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-8-1.png></figure><h2 id=question-7.8---page-299>Question 7.8 - Page 299</h2><p>Fit some of the non-linear models investigated in this chapter to the
<code>Auto</code> data set. Is there evidence for non-linear relationships in this
data set? Create some informative plots to justify your answer.</p><h3 id=answer-1>Answer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>autoDat</span><span class=o>&lt;-</span><span class=n>ISLR</span><span class=o>::</span><span class=n>Auto</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>autoDat</span> <span class=o>%&gt;%</span> <span class=nf>pivot_longer</span><span class=p>(</span><span class=o>-</span><span class=nf>c</span><span class=p>(</span><span class=n>mpg</span><span class=p>,</span><span class=n>name</span><span class=p>),</span><span class=n>names_to</span><span class=o>=</span><span class=s>&#34;Params&#34;</span><span class=p>,</span><span class=n>values_to</span><span class=o>=</span><span class=s>&#34;Value&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>mpg</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=n>Value</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nf>geom_point</span><span class=p>()</span> <span class=o>+</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=nf>facet_wrap</span><span class=p>(</span><span class=o>~</span> <span class=n>Params</span><span class=p>,</span> <span class=n>scales</span> <span class=o>=</span> <span class=s>&#34;free_y&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-10-1.png></figure><p>Very clearly there is a lot of non-linearity in the <code>mpg</code> data,
especially for <code>acceleration</code>, <code>weight</code>, <code>displacement</code>, <code>horsepower</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>rss</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>fits</span> <span class=o>=</span> <span class=nf>list</span><span class=p>()</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>d</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=n>fits[[d]]</span> <span class=o>=</span> <span class=nf>lm</span><span class=p>(</span><span class=n>mpg</span> <span class=o>~</span> <span class=nf>poly</span><span class=p>(</span><span class=n>displacement</span><span class=p>,</span> <span class=n>d</span><span class=p>),</span> <span class=n>data</span> <span class=o>=</span> <span class=n>autoDat</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=n>rss[d]</span> <span class=o>=</span> <span class=nf>deviance</span><span class=p>(</span><span class=n>fits[[d]]</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=n>rss</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##  [1] 8378.822 7412.263 7392.322 7391.722 7380.838 7270.746 7089.716 6917.401
</span></span><span class=line><span class=ln>2</span><span class=cl>##  [9] 6737.801 6610.190
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>anova</span><span class=p>(</span><span class=n>fits[[1]]</span><span class=p>,</span><span class=n>fits[[2]]</span><span class=p>,</span><span class=n>fits[[3]]</span><span class=p>,</span><span class=n>fits[[4]]</span><span class=p>,</span><span class=n>fits[[5]]</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=n>fits[[6]]</span><span class=p>,</span><span class=n>fits[[7]]</span><span class=p>,</span><span class=n>fits[[8]]</span><span class=p>,</span><span class=n>fits[[9]]</span><span class=p>,</span><span class=n>fits[[10]]</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Analysis of Variance Table
</span></span><span class=line><span class=ln> 2</span><span class=cl>##
</span></span><span class=line><span class=ln> 3</span><span class=cl>## Model  1: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Model  2: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Model  3: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Model  4: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Model  5: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Model  6: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Model  7: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln>10</span><span class=cl>## Model  8: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln>11</span><span class=cl>## Model  9: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln>12</span><span class=cl>## Model 10: mpg ~ poly(displacement, d)
</span></span><span class=line><span class=ln>13</span><span class=cl>##    Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)
</span></span><span class=line><span class=ln>14</span><span class=cl>## 1     390 8378.8
</span></span><span class=line><span class=ln>15</span><span class=cl>## 2     389 7412.3  1    966.56 55.7108 5.756e-13 ***
</span></span><span class=line><span class=ln>16</span><span class=cl>## 3     388 7392.3  1     19.94  1.1494  0.284364
</span></span><span class=line><span class=ln>17</span><span class=cl>## 4     387 7391.7  1      0.60  0.0346  0.852549
</span></span><span class=line><span class=ln>18</span><span class=cl>## 5     386 7380.8  1     10.88  0.6273  0.428823
</span></span><span class=line><span class=ln>19</span><span class=cl>## 6     385 7270.7  1    110.09  6.3455  0.012177 *
</span></span><span class=line><span class=ln>20</span><span class=cl>## 7     384 7089.7  1    181.03 10.4343  0.001344 **
</span></span><span class=line><span class=ln>21</span><span class=cl>## 8     383 6917.4  1    172.31  9.9319  0.001753 **
</span></span><span class=line><span class=ln>22</span><span class=cl>## 9     382 6737.8  1    179.60 10.3518  0.001404 **
</span></span><span class=line><span class=ln>23</span><span class=cl>## 10    381 6610.2  1    127.61  7.3553  0.006990 **
</span></span><span class=line><span class=ln>24</span><span class=cl>## ---
</span></span><span class=line><span class=ln>25</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span></code></pre></div><p>Confirming our visual indications, we see that the second degree models
work well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>glmnet</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Loading required package: Matrix
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##
</span></span><span class=line><span class=ln>2</span><span class=cl>## Attaching package: &#39;Matrix&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## The following objects are masked from &#39;package:tidyr&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##
</span></span><span class=line><span class=ln>3</span><span class=cl>##     expand, pack, unpack
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Loaded glmnet 3.0-2
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>boot</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>cv.errs</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=m>15</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>d</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=m>15</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=n>fit</span> <span class=o>=</span> <span class=nf>glm</span><span class=p>(</span><span class=n>mpg</span> <span class=o>~</span> <span class=nf>poly</span><span class=p>(</span><span class=n>displacement</span><span class=p>,</span> <span class=n>d</span><span class=p>),</span> <span class=n>data</span> <span class=o>=</span> <span class=n>Auto</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=n>cv.errs[d]</span> <span class=o>=</span> <span class=nf>cv.glm</span><span class=p>(</span><span class=n>Auto</span><span class=p>,</span> <span class=n>fit</span><span class=p>,</span> <span class=n>K</span> <span class=o>=</span> <span class=m>15</span><span class=p>)</span><span class=o>$</span><span class=n>delta[2]</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nf>which.min</span><span class=p>(</span><span class=n>cv.errs</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 10
</span></span></code></pre></div><p>Strangely, we seem to have ended up with a ten variable model here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1># Step functions</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>cv.errs</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>c</span> <span class=n>in</span> <span class=m>2</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=n>Auto</span><span class=o>$</span><span class=n>dis.cut</span> <span class=o>=</span> <span class=nf>cut</span><span class=p>(</span><span class=n>Auto</span><span class=o>$</span><span class=n>displacement</span><span class=p>,</span> <span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=n>fit</span> <span class=o>=</span> <span class=nf>glm</span><span class=p>(</span><span class=n>mpg</span> <span class=o>~</span> <span class=n>dis.cut</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>Auto</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>    <span class=n>cv.errs[c]</span> <span class=o>=</span> <span class=nf>cv.glm</span><span class=p>(</span><span class=n>Auto</span><span class=p>,</span> <span class=n>fit</span><span class=p>,</span> <span class=n>K</span> <span class=o>=</span> <span class=m>10</span><span class=p>)</span><span class=o>$</span><span class=n>delta[2]</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=nf>which.min</span><span class=p>(</span><span class=n>cv.errs</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 9
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>splines</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>cv.errs</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>df</span> <span class=n>in</span> <span class=m>3</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=n>fit</span> <span class=o>=</span> <span class=nf>glm</span><span class=p>(</span><span class=n>mpg</span> <span class=o>~</span> <span class=nf>ns</span><span class=p>(</span><span class=n>displacement</span><span class=p>,</span> <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>),</span> <span class=n>data</span> <span class=o>=</span> <span class=n>Auto</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=n>cv.errs[df]</span> <span class=o>=</span> <span class=nf>cv.glm</span><span class=p>(</span><span class=n>Auto</span><span class=p>,</span> <span class=n>fit</span><span class=p>,</span> <span class=n>K</span> <span class=o>=</span> <span class=m>10</span><span class=p>)</span><span class=o>$</span><span class=n>delta[2]</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=nf>which.min</span><span class=p>(</span><span class=n>cv.errs</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 10
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>gam</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Loading required package: foreach
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##
</span></span><span class=line><span class=ln>2</span><span class=cl>## Attaching package: &#39;foreach&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## The following objects are masked from &#39;package:purrr&#39;:
</span></span><span class=line><span class=ln>2</span><span class=cl>##
</span></span><span class=line><span class=ln>3</span><span class=cl>##     accumulate, when
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Loaded gam 1.16.1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1># GAMs</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>fit</span> <span class=o>=</span> <span class=nf>gam</span><span class=p>(</span><span class=n>mpg</span> <span class=o>~</span> <span class=nf>s</span><span class=p>(</span><span class=n>displacement</span><span class=p>,</span> <span class=m>4</span><span class=p>)</span> <span class=o>+</span> <span class=nf>s</span><span class=p>(</span><span class=n>horsepower</span><span class=p>,</span> <span class=m>4</span><span class=p>),</span> <span class=n>data</span> <span class=o>=</span> <span class=n>Auto</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
</span></span><span class=line><span class=ln>2</span><span class=cl>## ignored
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>summary</span><span class=p>(</span><span class=n>fit</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: gam(formula = mpg ~ s(displacement, 4) + s(horsepower, 4), data = Auto)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## Deviance Residuals:
</span></span><span class=line><span class=ln> 4</span><span class=cl>##      Min       1Q   Median       3Q      Max
</span></span><span class=line><span class=ln> 5</span><span class=cl>## -11.2982  -2.1592  -0.4394   2.1247  17.0946
</span></span><span class=line><span class=ln> 6</span><span class=cl>##
</span></span><span class=line><span class=ln> 7</span><span class=cl>## (Dispersion Parameter for gaussian family taken to be 15.3543)
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>##     Null Deviance: 23818.99 on 391 degrees of freedom
</span></span><span class=line><span class=ln>10</span><span class=cl>## Residual Deviance: 5880.697 on 382.9999 degrees of freedom
</span></span><span class=line><span class=ln>11</span><span class=cl>## AIC: 2194.05
</span></span><span class=line><span class=ln>12</span><span class=cl>##
</span></span><span class=line><span class=ln>13</span><span class=cl>## Number of Local Scoring Iterations: 2
</span></span><span class=line><span class=ln>14</span><span class=cl>##
</span></span><span class=line><span class=ln>15</span><span class=cl>## Anova for Parametric Effects
</span></span><span class=line><span class=ln>16</span><span class=cl>##                     Df  Sum Sq Mean Sq F value  Pr(&gt;F)
</span></span><span class=line><span class=ln>17</span><span class=cl>## s(displacement, 4)   1 15254.9 15254.9 993.524 &lt; 2e-16 ***
</span></span><span class=line><span class=ln>18</span><span class=cl>## s(horsepower, 4)     1  1038.4  1038.4  67.632 3.1e-15 ***
</span></span><span class=line><span class=ln>19</span><span class=cl>## Residuals          383  5880.7    15.4
</span></span><span class=line><span class=ln>20</span><span class=cl>## ---
</span></span><span class=line><span class=ln>21</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>22</span><span class=cl>##
</span></span><span class=line><span class=ln>23</span><span class=cl>## Anova for Nonparametric Effects
</span></span><span class=line><span class=ln>24</span><span class=cl>##                    Npar Df Npar F     Pr(F)
</span></span><span class=line><span class=ln>25</span><span class=cl>## (Intercept)
</span></span><span class=line><span class=ln>26</span><span class=cl>## s(displacement, 4)       3 13.613 1.863e-08 ***
</span></span><span class=line><span class=ln>27</span><span class=cl>## s(horsepower, 4)         3 15.606 1.349e-09 ***
</span></span><span class=line><span class=ln>28</span><span class=cl>## ---
</span></span><span class=line><span class=ln>29</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span></code></pre></div><h2 id=question-7.9---pages-299-300>Question 7.9 - Pages 299-300</h2><p>This question uses the variables <code>dis</code> (the weighted mean of distances
to five <code>Boston</code> employment centers) and <code>nox</code> (nitrogen oxides
concentration in parts per 10 million) from the <code>Boston</code> data. We will
treat <code>dis</code> as the predictor and <code>nox</code> as the response.</p><p><strong>(a)</strong> Use the <code>poly()</code> function to fit a cubic polynomial regression to
predict <code>nox</code> using <code>dis</code>. Report the regression output, and plot the
resulting data and polynomial fits.</p><p><strong>(b)</strong> Plot the polynomial fits for a range of different polynomial
degrees (say, from 1 to 10), and report the associated residual sum of
squares.</p><p><strong>(c)</strong> Perform cross-validation or another approach to select the optimal
degree for the polynomial, and explain your results.</p><p><strong>(d)</strong> Use the <code>bs()</code> function to fit a regression spline to predict nox
using <code>dis</code>. Report the output for the fit using four degrees of
freedom. How did you choose the knots? Plot the resulting fit.</p><p><strong>(e)</strong> Now fit a regression spline for a range of degrees of freedom, and
plot the resulting fits and report the resulting RSS. Describe the
results obtained.</p><p><strong>(f)</strong> Perform cross-validation or another approach in order to select
the best degrees of freedom for a regression spline on this data.
Describe your results.</p><h3 id=answer-2>Answer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span><span class=o>&lt;-</span><span class=n>MASS</span><span class=o>::</span><span class=n>Boston</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    506 obs. of  14 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>##  $ black  : num  397 397 393 395 397 ...
</span></span><span class=line><span class=ln>14</span><span class=cl>##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
</span></span><span class=line><span class=ln>15</span><span class=cl>##  $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...
</span></span><span class=line><span class=ln>16</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##       crim                zn             indus            chas
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  1st Qu.: 0.08204   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000
</span></span><span class=line><span class=ln> 8</span><span class=cl>##       nox               rm             age              dis
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100
</span></span><span class=line><span class=ln>11</span><span class=cl>##  Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207
</span></span><span class=line><span class=ln>12</span><span class=cl>##  Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795
</span></span><span class=line><span class=ln>13</span><span class=cl>##  3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188
</span></span><span class=line><span class=ln>14</span><span class=cl>##  Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127
</span></span><span class=line><span class=ln>15</span><span class=cl>##       rad              tax           ptratio          black
</span></span><span class=line><span class=ln>16</span><span class=cl>##  Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32
</span></span><span class=line><span class=ln>17</span><span class=cl>##  1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38
</span></span><span class=line><span class=ln>18</span><span class=cl>##  Median : 5.000   Median :330.0   Median :19.05   Median :391.44
</span></span><span class=line><span class=ln>19</span><span class=cl>##  Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67
</span></span><span class=line><span class=ln>20</span><span class=cl>##  3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23
</span></span><span class=line><span class=ln>21</span><span class=cl>##  Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90
</span></span><span class=line><span class=ln>22</span><span class=cl>##      lstat            medv
</span></span><span class=line><span class=ln>23</span><span class=cl>##  Min.   : 1.73   Min.   : 5.00
</span></span><span class=line><span class=ln>24</span><span class=cl>##  1st Qu.: 6.95   1st Qu.:17.02
</span></span><span class=line><span class=ln>25</span><span class=cl>##  Median :11.36   Median :21.20
</span></span><span class=line><span class=ln>26</span><span class=cl>##  Mean   :12.65   Mean   :22.53
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3rd Qu.:16.95   3rd Qu.:25.00
</span></span><span class=line><span class=ln>28</span><span class=cl>##  Max.   :37.97   Max.   :50.00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>boston</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>unique</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>length</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##    crim      zn   indus    chas     nox      rm     age     dis     rad     tax
</span></span><span class=line><span class=ln>2</span><span class=cl>##     504      26      76       2      81     446     356     412       9      66
</span></span><span class=line><span class=ln>3</span><span class=cl>## ptratio   black   lstat    medv
</span></span><span class=line><span class=ln>4</span><span class=cl>##      46     357     455     229
</span></span></code></pre></div><h4 id=a-polynomial>a) Polynomial</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln> 1</span><span class=cl><span class=n>fit.03</span> <span class=o>&lt;-</span> <span class=nf>lm</span><span class=p>(</span><span class=n>nox</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>dis</span><span class=p>,</span><span class=m>3</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>boston</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=n>dislims</span> <span class=o>&lt;-</span> <span class=nf>range</span><span class=p>(</span><span class=n>boston</span><span class=o>$</span><span class=n>dis</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=n>dis.grid</span> <span class=o>&lt;-</span> <span class=nf>seq</span><span class=p>(</span><span class=n>dislims[1]</span><span class=p>,</span> <span class=n>dislims[2]</span><span class=p>,</span> <span class=m>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=n>preds</span> <span class=o>&lt;-</span> <span class=nf>predict</span><span class=p>(</span><span class=n>fit.03</span><span class=p>,</span> <span class=n>newdata</span><span class=o>=</span><span class=nf>list</span><span class=p>(</span><span class=n>dis</span><span class=o>=</span><span class=n>dis.grid</span><span class=p>),</span> <span class=n>se</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=n>se.bands</span> <span class=o>&lt;-</span> <span class=n>preds</span><span class=o>$</span><span class=n>fit</span> <span class=o>+</span> <span class=nf>cbind</span><span class=p>(</span><span class=m>2</span><span class=o>*</span><span class=n>preds</span><span class=o>$</span><span class=n>se.fit</span><span class=p>,</span> <span class=m>-2</span><span class=o>*</span><span class=n>preds</span><span class=o>$</span><span class=n>se.fit</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=m>1</span><span class=p>),</span> <span class=n>mar</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>4.5</span><span class=p>,</span><span class=m>4.5</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>1</span><span class=p>),</span> <span class=n>oma</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>4</span><span class=p>,</span><span class=m>0</span><span class=p>))</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>boston</span><span class=o>$</span><span class=n>dis</span><span class=p>,</span> <span class=n>boston</span><span class=o>$</span><span class=n>nox</span><span class=p>,</span> <span class=n>xlim</span><span class=o>=</span><span class=n>dislims</span><span class=p>,</span> <span class=n>cex</span><span class=o>=</span><span class=m>0.5</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;darkgrey&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=nf>title</span><span class=p>(</span><span class=s>&#34;Degree 3 Polynomial Fit&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=nf>lines</span><span class=p>(</span><span class=n>dis.grid</span><span class=p>,</span> <span class=n>preds</span><span class=o>$</span><span class=n>fit</span><span class=p>,</span> <span class=n>lwd</span><span class=o>=</span><span class=m>2</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=nf>matlines</span><span class=p>(</span><span class=n>dis.grid</span><span class=p>,</span> <span class=n>se.bands</span><span class=p>,</span> <span class=n>lwd</span><span class=o>=</span><span class=m>1</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>,</span> <span class=n>lty</span><span class=o>=</span><span class=m>3</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-20-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>summary</span><span class=p>(</span><span class=n>fit.03</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call:
</span></span><span class=line><span class=ln> 3</span><span class=cl>## lm(formula = nox ~ poly(dis, 3), data = boston)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##       Min        1Q    Median        3Q       Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -0.121130 -0.040619 -0.009738  0.023385  0.194904
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Coefficients:
</span></span><span class=line><span class=ln>10</span><span class=cl>##                Estimate Std. Error t value Pr(&gt;|t|)
</span></span><span class=line><span class=ln>11</span><span class=cl>## (Intercept)    0.554695   0.002759 201.021  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>12</span><span class=cl>## poly(dis, 3)1 -2.003096   0.062071 -32.271  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>13</span><span class=cl>## poly(dis, 3)2  0.856330   0.062071  13.796  &lt; 2e-16 ***
</span></span><span class=line><span class=ln>14</span><span class=cl>## poly(dis, 3)3 -0.318049   0.062071  -5.124 4.27e-07 ***
</span></span><span class=line><span class=ln>15</span><span class=cl>## ---
</span></span><span class=line><span class=ln>16</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>17</span><span class=cl>##
</span></span><span class=line><span class=ln>18</span><span class=cl>## Residual standard error: 0.06207 on 502 degrees of freedom
</span></span><span class=line><span class=ln>19</span><span class=cl>## Multiple R-squared:  0.7148, Adjusted R-squared:  0.7131
</span></span><span class=line><span class=ln>20</span><span class=cl>## F-statistic: 419.3 on 3 and 502 DF,  p-value: &lt; 2.2e-16
</span></span></code></pre></div><h4 id=b-multiple-polynomials>b) Multiple Polynomials</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>rss.error</span> <span class=o>&lt;-</span> <span class=nf>rep</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=n>lm.fit</span> <span class=o>&lt;-</span> <span class=nf>lm</span><span class=p>(</span><span class=n>nox</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>dis</span><span class=p>,</span><span class=n>i</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>boston</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=n>rss.error[i]</span> <span class=o>&lt;-</span> <span class=nf>sum</span><span class=p>(</span><span class=n>lm.fit</span><span class=o>$</span><span class=n>residuals^2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=n>rss.error</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##  [1] 2.768563 2.035262 1.934107 1.932981 1.915290 1.878257 1.849484 1.835630
</span></span><span class=line><span class=ln>2</span><span class=cl>##  [9] 1.833331 1.832171
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>rss.error</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-21-1.png></figure><h4 id=c-cross-validation-and-polynomial-selection>c) Cross validation and polynomial selection</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>require</span><span class=p>(</span><span class=n>boot</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>cv.error</span> <span class=o>&lt;-</span> <span class=nf>rep</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>10</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>  <span class=n>glm.fit</span> <span class=o>&lt;-</span> <span class=nf>glm</span><span class=p>(</span><span class=n>nox</span><span class=o>~</span><span class=nf>poly</span><span class=p>(</span><span class=n>dis</span><span class=p>,</span><span class=n>i</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>boston</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>  <span class=n>cv.error[i]</span> <span class=o>&lt;-</span> <span class=nf>cv.glm</span><span class=p>(</span><span class=n>boston</span><span class=p>,</span> <span class=n>glm.fit</span><span class=p>,</span> <span class=n>K</span><span class=o>=</span><span class=m>10</span><span class=p>)</span><span class=o>$</span><span class=n>delta[1]</span>  <span class=c1># [1]:std, [2]:bias-corrected</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=n>cv.error</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##  [1] 0.005558263 0.004085706 0.003876521 0.003863342 0.004237452 0.005686862
</span></span><span class=line><span class=ln>2</span><span class=cl>##  [7] 0.010278897 0.006810868 0.033308607 0.004075599
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>cv.error</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-22-1.png></figure><ul><li>I feel like the second degree fit would be the most reasonable, though
the fourth degree seems to be doing well.</li></ul><h4 id=d-regression-spline>d) Regression spline</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>fit.sp</span> <span class=o>&lt;-</span> <span class=nf>lm</span><span class=p>(</span><span class=n>nox</span><span class=o>~</span><span class=nf>bs</span><span class=p>(</span><span class=n>dis</span><span class=p>,</span> <span class=n>df</span><span class=o>=</span><span class=m>4</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>boston</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>pred</span> <span class=o>&lt;-</span> <span class=nf>predict</span><span class=p>(</span><span class=n>fit.sp</span><span class=p>,</span> <span class=n>newdata</span><span class=o>=</span><span class=nf>list</span><span class=p>(</span><span class=n>dis</span><span class=o>=</span><span class=n>dis.grid</span><span class=p>),</span> <span class=n>se</span><span class=o>=</span><span class=bp>T</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>boston</span><span class=o>$</span><span class=n>dis</span><span class=p>,</span> <span class=n>boston</span><span class=o>$</span><span class=n>nox</span><span class=p>,</span> <span class=n>col</span><span class=o>=</span><span class=s>&#34;gray&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>lines</span><span class=p>(</span><span class=n>dis.grid</span><span class=p>,</span> <span class=n>pred</span><span class=o>$</span><span class=n>fit</span><span class=p>,</span> <span class=n>lwd</span><span class=o>=</span><span class=m>2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>lines</span><span class=p>(</span><span class=n>dis.grid</span><span class=p>,</span> <span class=n>pred</span><span class=o>$</span><span class=n>fit</span><span class=m>+2</span><span class=o>*</span><span class=n>pred</span><span class=o>$</span><span class=n>se</span><span class=p>,</span> <span class=n>lty</span><span class=o>=</span><span class=s>&#34;dashed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nf>lines</span><span class=p>(</span><span class=n>dis.grid</span><span class=p>,</span> <span class=n>pred</span><span class=o>$</span><span class=n>fit</span><span class=m>-2</span><span class=o>*</span><span class=n>pred</span><span class=o>$</span><span class=n>se</span><span class=p>,</span> <span class=n>lty</span><span class=o>=</span><span class=s>&#34;dashed&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-23-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=c1># set df to select knots at uniform quantiles of `dis`</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>attr</span><span class=p>(</span><span class=nf>bs</span><span class=p>(</span><span class=n>boston</span><span class=o>$</span><span class=n>dis</span><span class=p>,</span><span class=n>df</span><span class=o>=</span><span class=m>4</span><span class=p>),</span><span class=s>&#34;knots&#34;</span><span class=p>)</span>  <span class=c1># only 1 knot at 50th percentile</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##     50%
</span></span><span class=line><span class=ln>2</span><span class=cl>## 3.20745
</span></span></code></pre></div><h4 id=e-range-of-regression-splines>e) Range of regression splines</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>rss.error</span> <span class=o>&lt;-</span> <span class=nf>rep</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>7</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>4</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=n>fit.sp</span> <span class=o>&lt;-</span> <span class=nf>lm</span><span class=p>(</span><span class=n>nox</span><span class=o>~</span><span class=nf>bs</span><span class=p>(</span><span class=n>dis</span><span class=p>,</span> <span class=n>df</span><span class=o>=</span><span class=n>i</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>boston</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=n>rss.error[i</span><span class=m>-3</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=nf>sum</span><span class=p>(</span><span class=n>fit.sp</span><span class=o>$</span><span class=n>residuals^2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=n>rss.error</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 1.922775 1.840173 1.833966 1.829884 1.816995 1.825653 1.792535
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=m>4</span><span class=o>:</span><span class=m>10</span><span class=p>,</span> <span class=n>rss.error</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-24-1.png></figure><ul><li>As the model gains more degrees of freedom, it tends to over fit to
the training data better</li></ul><h4 id=f-cross-validation-for-best-spline>f) Cross validation for best spline</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>cv.error</span> <span class=o>&lt;-</span> <span class=nf>rep</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>7</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>4</span><span class=o>:</span><span class=m>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=n>glm.fit</span> <span class=o>&lt;-</span> <span class=nf>glm</span><span class=p>(</span><span class=n>nox</span><span class=o>~</span><span class=nf>bs</span><span class=p>(</span><span class=n>dis</span><span class=p>,</span> <span class=n>df</span><span class=o>=</span><span class=n>i</span><span class=p>),</span> <span class=n>data</span><span class=o>=</span><span class=n>boston</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=n>cv.error[i</span><span class=m>-3</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=nf>cv.glm</span><span class=p>(</span><span class=n>boston</span><span class=p>,</span> <span class=n>glm.fit</span><span class=p>,</span> <span class=n>K</span><span class=o>=</span><span class=m>10</span><span class=p>)</span><span class=o>$</span><span class=n>delta[1]</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.1523), Boundary.knots =
</span></span><span class=line><span class=ln>2</span><span class=cl>## c(1.1296, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned
</span></span><span class=line><span class=ln>3</span><span class=cl>## bases
</span></span><span class=line><span class=ln>4</span><span class=cl>
</span></span><span class=line><span class=ln>5</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.1523), Boundary.knots =
</span></span><span class=line><span class=ln>6</span><span class=cl>## c(1.1296, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned
</span></span><span class=line><span class=ln>7</span><span class=cl>## bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.2157), Boundary.knots =
</span></span><span class=line><span class=ln>2</span><span class=cl>## c(1.137, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.2157), Boundary.knots =
</span></span><span class=line><span class=ln>5</span><span class=cl>## c(1.137, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.35953333333333, : some
</span></span><span class=line><span class=ln>2</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.35953333333333, : some
</span></span><span class=line><span class=ln>5</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.38403333333333, : some
</span></span><span class=line><span class=ln>2</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.38403333333333, : some
</span></span><span class=line><span class=ln>5</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.07945, `50%` = 3.1323, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.07945, `50%` = 3.1323, :
</span></span><span class=line><span class=ln>5</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.1103, `50%` = 3.2797, : some
</span></span><span class=line><span class=ln>2</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.1103, `50%` = 3.2797, : some
</span></span><span class=line><span class=ln>5</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.9682, `40%` = 2.7147, : some
</span></span><span class=line><span class=ln>2</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.9682, `40%` = 2.7147, : some
</span></span><span class=line><span class=ln>5</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.95434, `40%` = 2.59666, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.95434, `40%` = 2.59666, :
</span></span><span class=line><span class=ln>5</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.82203333333333, : some
</span></span><span class=line><span class=ln>2</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.82203333333333, : some
</span></span><span class=line><span class=ln>5</span><span class=cl>## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.8226, `33.33333%` =
</span></span><span class=line><span class=ln>2</span><span class=cl>## 2.3817, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.8226, `33.33333%` =
</span></span><span class=line><span class=ln>5</span><span class=cl>## 2.3817, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`14.28571%` = 1.7936, `28.57143%`
</span></span><span class=line><span class=ln>2</span><span class=cl>## = 2.16972857142857, : some &#39;x&#39; values beyond boundary knots may cause ill-
</span></span><span class=line><span class=ln>3</span><span class=cl>## conditioned bases
</span></span><span class=line><span class=ln>4</span><span class=cl>
</span></span><span class=line><span class=ln>5</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`14.28571%` = 1.7936, `28.57143%`
</span></span><span class=line><span class=ln>6</span><span class=cl>## = 2.16972857142857, : some &#39;x&#39; values beyond boundary knots may cause ill-
</span></span><span class=line><span class=ln>7</span><span class=cl>## conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.754625, `25%` = 2.10215, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.754625, `25%` = 2.10215, :
</span></span><span class=line><span class=ln>5</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.751575, `25%` = 2.08755, :
</span></span><span class=line><span class=ln>2</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.751575, `25%` = 2.08755, :
</span></span><span class=line><span class=ln>5</span><span class=cl>## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>cv.error</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 0.003898810 0.003694675 0.003732665 0.003766202 0.003716389 0.003723126
</span></span><span class=line><span class=ln>2</span><span class=cl>## [7] 0.003727358
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=m>4</span><span class=o>:</span><span class=m>10</span><span class=p>,</span> <span class=n>cv.error</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-25-1.png></figure><ul><li>A fifth degree polynomial is clearly indicated</li></ul><h2 id=question-10---page-300>Question 10 - Page 300</h2><p>This question relates to the <code>College</code> data set.</p><p><strong>(a)</strong> Split the data into a training set and a test set. Using
out-of-state tuition as the response and the other variables as the
predictors, perform forward stepwise selection on the training set in
order to identify a satisfactory model that uses just a subset of the
predictors.</p><p><strong>(b)</strong> Fit a GAM on the training data, using out-of-state tuition as the
response and the features selected in the previous step as the
predictors. Plot the results, and explain your ï¬ndings.</p><p><strong>(c)</strong> Evaluate the model obtained on the test set, and explain the
results obtained.</p><p><strong>(d)</strong> For which variables, if any, is there evidence of a non-linear
relationship with the response?</p><h3 id=answer-3>Answer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>colDat</span><span class=o>&lt;-</span><span class=n>ISLR</span><span class=o>::</span><span class=n>College</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=n>str</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## &#39;data.frame&#39;:    777 obs. of  18 variables:
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  $ Private    : Factor w/ 2 levels &#34;No&#34;,&#34;Yes&#34;: 2 2 2 2 2 2 2 2 2 2 ...
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  $ Apps       : num  1660 2186 1428 417 193 ...
</span></span><span class=line><span class=ln> 4</span><span class=cl>##  $ Accept     : num  1232 1924 1097 349 146 ...
</span></span><span class=line><span class=ln> 5</span><span class=cl>##  $ Enroll     : num  721 512 336 137 55 158 103 489 227 172 ...
</span></span><span class=line><span class=ln> 6</span><span class=cl>##  $ Top10perc  : num  23 16 22 60 16 38 17 37 30 21 ...
</span></span><span class=line><span class=ln> 7</span><span class=cl>##  $ Top25perc  : num  52 29 50 89 44 62 45 68 63 44 ...
</span></span><span class=line><span class=ln> 8</span><span class=cl>##  $ F.Undergrad: num  2885 2683 1036 510 249 ...
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  $ P.Undergrad: num  537 1227 99 63 869 ...
</span></span><span class=line><span class=ln>10</span><span class=cl>##  $ Outstate   : num  7440 12280 11250 12960 7560 ...
</span></span><span class=line><span class=ln>11</span><span class=cl>##  $ Room.Board : num  3300 6450 3750 5450 4120 ...
</span></span><span class=line><span class=ln>12</span><span class=cl>##  $ Books      : num  450 750 400 450 800 500 500 450 300 660 ...
</span></span><span class=line><span class=ln>13</span><span class=cl>##  $ Personal   : num  2200 1500 1165 875 1500 ...
</span></span><span class=line><span class=ln>14</span><span class=cl>##  $ PhD        : num  70 29 53 92 76 67 90 89 79 40 ...
</span></span><span class=line><span class=ln>15</span><span class=cl>##  $ Terminal   : num  78 30 66 97 72 73 93 100 84 41 ...
</span></span><span class=line><span class=ln>16</span><span class=cl>##  $ S.F.Ratio  : num  18.1 12.2 12.9 7.7 11.9 9.4 11.5 13.7 11.3 11.5 ...
</span></span><span class=line><span class=ln>17</span><span class=cl>##  $ perc.alumni: num  12 16 30 37 2 11 26 37 23 15 ...
</span></span><span class=line><span class=ln>18</span><span class=cl>##  $ Expend     : num  7041 10527 8735 19016 10922 ...
</span></span><span class=line><span class=ln>19</span><span class=cl>##  $ Grad.Rate  : num  60 56 54 59 15 55 63 73 80 52 ...
</span></span><span class=line><span class=ln>20</span><span class=cl>## NULL
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##  Private        Apps           Accept          Enroll       Top10perc
</span></span><span class=line><span class=ln> 2</span><span class=cl>##  No :212   Min.   :   81   Min.   :   72   Min.   :  35   Min.   : 1.00
</span></span><span class=line><span class=ln> 3</span><span class=cl>##  Yes:565   1st Qu.:  776   1st Qu.:  604   1st Qu.: 242   1st Qu.:15.00
</span></span><span class=line><span class=ln> 4</span><span class=cl>##            Median : 1558   Median : 1110   Median : 434   Median :23.00
</span></span><span class=line><span class=ln> 5</span><span class=cl>##            Mean   : 3002   Mean   : 2019   Mean   : 780   Mean   :27.56
</span></span><span class=line><span class=ln> 6</span><span class=cl>##            3rd Qu.: 3624   3rd Qu.: 2424   3rd Qu.: 902   3rd Qu.:35.00
</span></span><span class=line><span class=ln> 7</span><span class=cl>##            Max.   :48094   Max.   :26330   Max.   :6392   Max.   :96.00
</span></span><span class=line><span class=ln> 8</span><span class=cl>##    Top25perc      F.Undergrad     P.Undergrad         Outstate
</span></span><span class=line><span class=ln> 9</span><span class=cl>##  Min.   :  9.0   Min.   :  139   Min.   :    1.0   Min.   : 2340
</span></span><span class=line><span class=ln>10</span><span class=cl>##  1st Qu.: 41.0   1st Qu.:  992   1st Qu.:   95.0   1st Qu.: 7320
</span></span><span class=line><span class=ln>11</span><span class=cl>##  Median : 54.0   Median : 1707   Median :  353.0   Median : 9990
</span></span><span class=line><span class=ln>12</span><span class=cl>##  Mean   : 55.8   Mean   : 3700   Mean   :  855.3   Mean   :10441
</span></span><span class=line><span class=ln>13</span><span class=cl>##  3rd Qu.: 69.0   3rd Qu.: 4005   3rd Qu.:  967.0   3rd Qu.:12925
</span></span><span class=line><span class=ln>14</span><span class=cl>##  Max.   :100.0   Max.   :31643   Max.   :21836.0   Max.   :21700
</span></span><span class=line><span class=ln>15</span><span class=cl>##    Room.Board       Books           Personal         PhD
</span></span><span class=line><span class=ln>16</span><span class=cl>##  Min.   :1780   Min.   :  96.0   Min.   : 250   Min.   :  8.00
</span></span><span class=line><span class=ln>17</span><span class=cl>##  1st Qu.:3597   1st Qu.: 470.0   1st Qu.: 850   1st Qu.: 62.00
</span></span><span class=line><span class=ln>18</span><span class=cl>##  Median :4200   Median : 500.0   Median :1200   Median : 75.00
</span></span><span class=line><span class=ln>19</span><span class=cl>##  Mean   :4358   Mean   : 549.4   Mean   :1341   Mean   : 72.66
</span></span><span class=line><span class=ln>20</span><span class=cl>##  3rd Qu.:5050   3rd Qu.: 600.0   3rd Qu.:1700   3rd Qu.: 85.00
</span></span><span class=line><span class=ln>21</span><span class=cl>##  Max.   :8124   Max.   :2340.0   Max.   :6800   Max.   :103.00
</span></span><span class=line><span class=ln>22</span><span class=cl>##     Terminal       S.F.Ratio      perc.alumni        Expend
</span></span><span class=line><span class=ln>23</span><span class=cl>##  Min.   : 24.0   Min.   : 2.50   Min.   : 0.00   Min.   : 3186
</span></span><span class=line><span class=ln>24</span><span class=cl>##  1st Qu.: 71.0   1st Qu.:11.50   1st Qu.:13.00   1st Qu.: 6751
</span></span><span class=line><span class=ln>25</span><span class=cl>##  Median : 82.0   Median :13.60   Median :21.00   Median : 8377
</span></span><span class=line><span class=ln>26</span><span class=cl>##  Mean   : 79.7   Mean   :14.09   Mean   :22.74   Mean   : 9660
</span></span><span class=line><span class=ln>27</span><span class=cl>##  3rd Qu.: 92.0   3rd Qu.:16.50   3rd Qu.:31.00   3rd Qu.:10830
</span></span><span class=line><span class=ln>28</span><span class=cl>##  Max.   :100.0   Max.   :39.80   Max.   :64.00   Max.   :56233
</span></span><span class=line><span class=ln>29</span><span class=cl>##    Grad.Rate
</span></span><span class=line><span class=ln>30</span><span class=cl>##  Min.   : 10.00
</span></span><span class=line><span class=ln>31</span><span class=cl>##  1st Qu.: 53.00
</span></span><span class=line><span class=ln>32</span><span class=cl>##  Median : 65.00
</span></span><span class=line><span class=ln>33</span><span class=cl>##  Mean   : 65.46
</span></span><span class=line><span class=ln>34</span><span class=cl>##  3rd Qu.: 78.00
</span></span><span class=line><span class=ln>35</span><span class=cl>##  Max.   :118.00
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>unique</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>length</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##     Private        Apps      Accept      Enroll   Top10perc   Top25perc
</span></span><span class=line><span class=ln>2</span><span class=cl>##           2         711         693         581          82          89
</span></span><span class=line><span class=ln>3</span><span class=cl>## F.Undergrad P.Undergrad    Outstate  Room.Board       Books    Personal
</span></span><span class=line><span class=ln>4</span><span class=cl>##         714         566         640         553         122         294
</span></span><span class=line><span class=ln>5</span><span class=cl>##         PhD    Terminal   S.F.Ratio perc.alumni      Expend   Grad.Rate
</span></span><span class=line><span class=ln>6</span><span class=cl>##          78          65         173          61         744          81
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln> 1</span><span class=cl><span class=n>plotLEAP</span><span class=o>=</span><span class=nf>function</span><span class=p>(</span><span class=n>leapObj</span><span class=p>){</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>  <span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=n>bar2</span><span class=o>=</span><span class=nf>which.max</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>adjr2</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=n>bbic</span><span class=o>=</span><span class=nf>which.min</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>bic</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=n>bcp</span><span class=o>=</span><span class=nf>which.min</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>cp</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>rss</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#34;RSS&#34;</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>adjr2</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=nf>TeX</span><span class=p>(</span><span class=s>&#34;Adjusted R^2&#34;</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=nf>points</span><span class=p>(</span><span class=n>bar2</span><span class=p>,</span><span class=n>leapObj</span><span class=o>$</span><span class=n>adjr2[bar2]</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#34;green&#34;</span><span class=p>,</span><span class=n>cex</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>bic</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=nf>TeX</span><span class=p>(</span><span class=s>&#34;BIC&#34;</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>  <span class=nf>points</span><span class=p>(</span><span class=n>bbic</span><span class=p>,</span><span class=n>leapObj</span><span class=o>$</span><span class=n>bic[bbic]</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#34;blue&#34;</span><span class=p>,</span><span class=n>cex</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=nf>plot</span><span class=p>(</span><span class=n>leapObj</span><span class=o>$</span><span class=n>cp</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Number of variables&#34;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=nf>TeX</span><span class=p>(</span><span class=s>&#34;C_p&#34;</span><span class=p>),</span><span class=n>type</span><span class=o>=</span><span class=s>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  <span class=nf>points</span><span class=p>(</span><span class=n>bcp</span><span class=p>,</span><span class=n>leapObj</span><span class=o>$</span><span class=n>cp[bcp]</span><span class=p>,</span><span class=n>col</span><span class=o>=</span><span class=s>&#34;red&#34;</span><span class=p>,</span><span class=n>cex</span><span class=o>=</span><span class=m>2</span><span class=p>,</span><span class=n>pch</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=a-train-test>a) Train test</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_ind</span> <span class=o>=</span> <span class=nf>sample</span><span class=p>(</span><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>,</span><span class=m>100</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_ind</span> <span class=o>=</span> <span class=nf>setdiff</span><span class=p>(</span><span class=nf>seq_len</span><span class=p>(</span><span class=n>colDat</span> <span class=o>%&gt;%</span> <span class=n>nrow</span><span class=p>),</span> <span class=n>train_ind</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=best-subset-selection>Best subset selection</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>train_set</span><span class=o>&lt;-</span><span class=n>colDat[train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test_set</span><span class=o>&lt;-</span><span class=n>colDat[</span><span class=o>-</span><span class=n>train_ind</span><span class=p>,</span><span class=n>]</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>leaps</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>modelFit</span><span class=o>&lt;-</span><span class=nf>regsubsets</span><span class=p>(</span><span class=n>Outstate</span><span class=o>~</span><span class=n>.,data</span><span class=o>=</span><span class=n>colDat</span><span class=p>,</span><span class=n>nvmax</span><span class=o>=</span><span class=m>20</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>modelFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>## Subset selection object
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: regsubsets.formula(Outstate ~ ., data = colDat, nvmax = 20)
</span></span><span class=line><span class=ln> 3</span><span class=cl>## 17 Variables  (and intercept)
</span></span><span class=line><span class=ln> 4</span><span class=cl>##             Forced in Forced out
</span></span><span class=line><span class=ln> 5</span><span class=cl>## PrivateYes      FALSE      FALSE
</span></span><span class=line><span class=ln> 6</span><span class=cl>## Apps            FALSE      FALSE
</span></span><span class=line><span class=ln> 7</span><span class=cl>## Accept          FALSE      FALSE
</span></span><span class=line><span class=ln> 8</span><span class=cl>## Enroll          FALSE      FALSE
</span></span><span class=line><span class=ln> 9</span><span class=cl>## Top10perc       FALSE      FALSE
</span></span><span class=line><span class=ln>10</span><span class=cl>## Top25perc       FALSE      FALSE
</span></span><span class=line><span class=ln>11</span><span class=cl>## F.Undergrad     FALSE      FALSE
</span></span><span class=line><span class=ln>12</span><span class=cl>## P.Undergrad     FALSE      FALSE
</span></span><span class=line><span class=ln>13</span><span class=cl>## Room.Board      FALSE      FALSE
</span></span><span class=line><span class=ln>14</span><span class=cl>## Books           FALSE      FALSE
</span></span><span class=line><span class=ln>15</span><span class=cl>## Personal        FALSE      FALSE
</span></span><span class=line><span class=ln>16</span><span class=cl>## PhD             FALSE      FALSE
</span></span><span class=line><span class=ln>17</span><span class=cl>## Terminal        FALSE      FALSE
</span></span><span class=line><span class=ln>18</span><span class=cl>## S.F.Ratio       FALSE      FALSE
</span></span><span class=line><span class=ln>19</span><span class=cl>## perc.alumni     FALSE      FALSE
</span></span><span class=line><span class=ln>20</span><span class=cl>## Expend          FALSE      FALSE
</span></span><span class=line><span class=ln>21</span><span class=cl>## Grad.Rate       FALSE      FALSE
</span></span><span class=line><span class=ln>22</span><span class=cl>## 1 subsets of each size up to 17
</span></span><span class=line><span class=ln>23</span><span class=cl>## Selection Algorithm: exhaustive
</span></span><span class=line><span class=ln>24</span><span class=cl>##           PrivateYes Apps Accept Enroll Top10perc Top25perc F.Undergrad
</span></span><span class=line><span class=ln>25</span><span class=cl>## 1  ( 1 )  &#34; &#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
</span></span><span class=line><span class=ln>26</span><span class=cl>## 2  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
</span></span><span class=line><span class=ln>27</span><span class=cl>## 3  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
</span></span><span class=line><span class=ln>28</span><span class=cl>## 4  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
</span></span><span class=line><span class=ln>29</span><span class=cl>## 5  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
</span></span><span class=line><span class=ln>30</span><span class=cl>## 6  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
</span></span><span class=line><span class=ln>31</span><span class=cl>## 7  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
</span></span><span class=line><span class=ln>32</span><span class=cl>## 8  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34;*&#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>33</span><span class=cl>## 9  ( 1 )  &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>34</span><span class=cl>## 10  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>35</span><span class=cl>## 11  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>36</span><span class=cl>## 12  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>37</span><span class=cl>## 13  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>38</span><span class=cl>## 14  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>39</span><span class=cl>## 15  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>40</span><span class=cl>## 16  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34;*&#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>41</span><span class=cl>## 17  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34;*&#34;       &#34;*&#34;
</span></span><span class=line><span class=ln>42</span><span class=cl>##           P.Undergrad Room.Board Books Personal PhD Terminal S.F.Ratio
</span></span><span class=line><span class=ln>43</span><span class=cl>## 1  ( 1 )  &#34; &#34;         &#34; &#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
</span></span><span class=line><span class=ln>44</span><span class=cl>## 2  ( 1 )  &#34; &#34;         &#34; &#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
</span></span><span class=line><span class=ln>45</span><span class=cl>## 3  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
</span></span><span class=line><span class=ln>46</span><span class=cl>## 4  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
</span></span><span class=line><span class=ln>47</span><span class=cl>## 5  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34;*&#34; &#34; &#34;      &#34; &#34;
</span></span><span class=line><span class=ln>48</span><span class=cl>## 6  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
</span></span><span class=line><span class=ln>49</span><span class=cl>## 7  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
</span></span><span class=line><span class=ln>50</span><span class=cl>## 8  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
</span></span><span class=line><span class=ln>51</span><span class=cl>## 9  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
</span></span><span class=line><span class=ln>52</span><span class=cl>## 10  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
</span></span><span class=line><span class=ln>53</span><span class=cl>## 11  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
</span></span><span class=line><span class=ln>54</span><span class=cl>## 12  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34;*&#34;
</span></span><span class=line><span class=ln>55</span><span class=cl>## 13  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34;*&#34;
</span></span><span class=line><span class=ln>56</span><span class=cl>## 14  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
</span></span><span class=line><span class=ln>57</span><span class=cl>## 15  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34;*&#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
</span></span><span class=line><span class=ln>58</span><span class=cl>## 16  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34;*&#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
</span></span><span class=line><span class=ln>59</span><span class=cl>## 17  ( 1 ) &#34;*&#34;         &#34;*&#34;        &#34;*&#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
</span></span><span class=line><span class=ln>60</span><span class=cl>##           perc.alumni Expend Grad.Rate
</span></span><span class=line><span class=ln>61</span><span class=cl>## 1  ( 1 )  &#34; &#34;         &#34;*&#34;    &#34; &#34;
</span></span><span class=line><span class=ln>62</span><span class=cl>## 2  ( 1 )  &#34; &#34;         &#34;*&#34;    &#34; &#34;
</span></span><span class=line><span class=ln>63</span><span class=cl>## 3  ( 1 )  &#34; &#34;         &#34;*&#34;    &#34; &#34;
</span></span><span class=line><span class=ln>64</span><span class=cl>## 4  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34; &#34;
</span></span><span class=line><span class=ln>65</span><span class=cl>## 5  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34; &#34;
</span></span><span class=line><span class=ln>66</span><span class=cl>## 6  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>67</span><span class=cl>## 7  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>68</span><span class=cl>## 8  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>69</span><span class=cl>## 9  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>70</span><span class=cl>## 10  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>71</span><span class=cl>## 11  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>72</span><span class=cl>## 12  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>73</span><span class=cl>## 13  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>74</span><span class=cl>## 14  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>75</span><span class=cl>## 15  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>76</span><span class=cl>## 16  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span><span class=line><span class=ln>77</span><span class=cl>## 17  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
</span></span></code></pre></div><p>We might want to take a look at these.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;Cp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;r2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>scale</span><span class=o>=</span><span class=s>&#39;adjr2&#39;</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-32-1.png></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>plotLEAP</span><span class=p>(</span><span class=n>modelFit</span> <span class=o>%&gt;%</span> <span class=n>summary</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-33-1.png></figure><ul><li>So we like 14 variables, namely</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coefficients</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>id</span><span class=o>=</span><span class=m>14</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##   (Intercept)    PrivateYes          Apps        Accept        Enroll
</span></span><span class=line><span class=ln>2</span><span class=cl>## -1.817040e+03  2.256946e+03 -2.999022e-01  8.023519e-01 -5.372545e-01
</span></span><span class=line><span class=ln>3</span><span class=cl>##     Top10perc   F.Undergrad    Room.Board      Personal           PhD
</span></span><span class=line><span class=ln>4</span><span class=cl>##  2.365529e+01 -9.569936e-02  8.741819e-01 -2.478418e-01  1.269506e+01
</span></span><span class=line><span class=ln>5</span><span class=cl>##      Terminal     S.F.Ratio   perc.alumni        Expend     Grad.Rate
</span></span><span class=line><span class=ln>6</span><span class=cl>##  2.297296e+01 -4.700560e+01  4.195006e+01  2.003912e-01  2.383197e+01
</span></span></code></pre></div><ul><li>But five seems like a better bet.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>coefficients</span><span class=p>(</span><span class=n>modelFit</span><span class=p>,</span><span class=n>id</span><span class=o>=</span><span class=m>5</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>##   (Intercept)    PrivateYes    Room.Board           PhD   perc.alumni
</span></span><span class=line><span class=ln>2</span><span class=cl>## -2864.6325619  2936.7416766     1.0677573    40.5334088    61.3147684
</span></span><span class=line><span class=ln>3</span><span class=cl>##        Expend
</span></span><span class=line><span class=ln>4</span><span class=cl>##     0.2253945
</span></span></code></pre></div><h4 id=b-gam>b) GAM</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>gam</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>fit</span> <span class=o>=</span> <span class=nf>gam</span><span class=p>(</span><span class=n>Outstate</span> <span class=o>~</span> <span class=n>Private</span><span class=o>+</span><span class=nf>s</span><span class=p>(</span><span class=n>Apps</span><span class=p>,</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=n>Accept</span><span class=o>+</span><span class=n>Enroll</span><span class=o>+</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>            <span class=n>Top10perc</span><span class=o>+</span><span class=bp>F</span><span class=n>.Undergrad</span><span class=o>+</span><span class=n>Room.Board</span><span class=o>+</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>            <span class=n>Personal</span><span class=o>+</span><span class=n>PhD</span><span class=o>+</span><span class=n>Terminal</span><span class=o>+</span><span class=n>S.F.Ratio</span><span class=o>+</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>            <span class=n>perc.alumni</span><span class=o>+</span><span class=n>Expend</span><span class=o>+</span><span class=n>Grad.Rate</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>        <span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>colDat</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
</span></span><span class=line><span class=ln>2</span><span class=cl>## ignored
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>fit2</span> <span class=o>=</span> <span class=nf>gam</span><span class=p>(</span><span class=n>Outstate</span> <span class=o>~</span> <span class=n>Private</span><span class=o>+</span><span class=nf>s</span><span class=p>(</span><span class=n>Room.Board</span><span class=p>,</span><span class=m>2</span><span class=p>)</span><span class=o>+</span><span class=nf>s</span><span class=p>(</span><span class=n>PhD</span><span class=p>,</span><span class=m>3</span><span class=p>)</span><span class=o>+</span><span class=nf>s</span><span class=p>(</span><span class=n>perc.alumni</span><span class=p>)</span><span class=o>+</span><span class=n>Expend</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>        <span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>colDat</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
</span></span><span class=line><span class=ln>2</span><span class=cl>## ignored
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>fit</span><span class=p>,</span><span class=n>se</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span>
</span></span></code></pre></div><p><img src=/islr/sol5/unnamed-chunk-39-1.png alt>
<img src=/islr/sol5/unnamed-chunk-39-2.png alt>
<img src=/islr/sol5/unnamed-chunk-39-3.png alt>
<img src=/islr/sol5/unnamed-chunk-39-4.png alt></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>par</span><span class=p>(</span><span class=n>mfrow</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>2</span><span class=p>,</span><span class=m>2</span><span class=p>))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>fit2</span><span class=p>,</span><span class=n>se</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span>
</span></span></code></pre></div><figure><img src=/islr/sol5/unnamed-chunk-40-2.png></figure><h4 id=c-evaluate>c) Evaluate</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pred</span> <span class=o>&lt;-</span> <span class=nf>predict</span><span class=p>(</span><span class=n>fit</span><span class=p>,</span> <span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>mse.error</span> <span class=o>&lt;-</span> <span class=nf>mean</span><span class=p>((</span><span class=n>test_set</span><span class=o>$</span><span class=n>Outstate</span> <span class=o>-</span> <span class=n>pred</span><span class=p>)</span><span class=n>^2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>mse.error</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 3691891
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>gam.tss</span> <span class=o>=</span> <span class=nf>mean</span><span class=p>((</span><span class=n>test_set</span><span class=o>$</span><span class=n>Outstate</span> <span class=o>-</span> <span class=nf>mean</span><span class=p>(</span><span class=n>test_set</span><span class=o>$</span><span class=n>Outstate</span><span class=p>))</span><span class=n>^2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test.rss</span> <span class=o>=</span> <span class=m>1</span> <span class=o>-</span> <span class=n>mse.error</span><span class=o>/</span><span class=n>gam.tss</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>test.rss</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 0.7731239
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>pred2</span> <span class=o>&lt;-</span> <span class=nf>predict</span><span class=p>(</span><span class=n>fit2</span><span class=p>,</span> <span class=n>test_set</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>mse.error2</span> <span class=o>&lt;-</span> <span class=nf>mean</span><span class=p>((</span><span class=n>test_set</span><span class=o>$</span><span class=n>Outstate</span> <span class=o>-</span> <span class=n>pred2</span><span class=p>)</span><span class=n>^2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>mse.error2</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 4121902
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=n>gam.tss2</span> <span class=o>=</span> <span class=nf>mean</span><span class=p>((</span><span class=n>test_set</span><span class=o>$</span><span class=n>Outstate</span> <span class=o>-</span> <span class=nf>mean</span><span class=p>(</span><span class=n>test_set</span><span class=o>$</span><span class=n>Outstate</span><span class=p>))</span><span class=n>^2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>test.rss2</span> <span class=o>=</span> <span class=m>1</span> <span class=o>-</span> <span class=n>mse.error2</span><span class=o>/</span><span class=n>gam.tss2</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=n>test.rss2</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>## [1] 0.7466987
</span></span></code></pre></div><p>This is pretty good model, all told.</p><h4 id=d-summary>d) Summary</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>summary</span><span class=p>(</span><span class=n>fit</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: gam(formula = Outstate ~ Private + s(Apps, 3) + Accept + Enroll +
</span></span><span class=line><span class=ln> 3</span><span class=cl>##     Top10perc + F.Undergrad + Room.Board + Personal + PhD + Terminal +
</span></span><span class=line><span class=ln> 4</span><span class=cl>##     S.F.Ratio + perc.alumni + Expend + Grad.Rate, data = colDat)
</span></span><span class=line><span class=ln> 5</span><span class=cl>## Deviance Residuals:
</span></span><span class=line><span class=ln> 6</span><span class=cl>##       Min        1Q    Median        3Q       Max
</span></span><span class=line><span class=ln> 7</span><span class=cl>## -6641.083 -1262.806    -5.698  1270.911  9965.901
</span></span><span class=line><span class=ln> 8</span><span class=cl>##
</span></span><span class=line><span class=ln> 9</span><span class=cl>## (Dispersion Parameter for gaussian family taken to be 3749048)
</span></span><span class=line><span class=ln>10</span><span class=cl>##
</span></span><span class=line><span class=ln>11</span><span class=cl>##     Null Deviance: 12559297426 on 776 degrees of freedom
</span></span><span class=line><span class=ln>12</span><span class=cl>## Residual Deviance: 2849276343 on 760 degrees of freedom
</span></span><span class=line><span class=ln>13</span><span class=cl>## AIC: 13985.3
</span></span><span class=line><span class=ln>14</span><span class=cl>##
</span></span><span class=line><span class=ln>15</span><span class=cl>## Number of Local Scoring Iterations: 2
</span></span><span class=line><span class=ln>16</span><span class=cl>##
</span></span><span class=line><span class=ln>17</span><span class=cl>## Anova for Parametric Effects
</span></span><span class=line><span class=ln>18</span><span class=cl>##              Df     Sum Sq    Mean Sq  F value    Pr(&gt;F)
</span></span><span class=line><span class=ln>19</span><span class=cl>## Private       1 4034912907 4034912907 1076.250 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>20</span><span class=cl>## s(Apps, 3)    1 1344548030 1344548030  358.637 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>21</span><span class=cl>## Accept        1   90544274   90544274   24.151 1.091e-06 ***
</span></span><span class=line><span class=ln>22</span><span class=cl>## Enroll        1  144471570  144471570   38.535 8.838e-10 ***
</span></span><span class=line><span class=ln>23</span><span class=cl>## Top10perc     1 1802244831 1802244831  480.721 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>24</span><span class=cl>## F.Undergrad   1   45230645   45230645   12.065 0.0005430 ***
</span></span><span class=line><span class=ln>25</span><span class=cl>## Room.Board    1 1110285773 1110285773  296.151 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>26</span><span class=cl>## Personal      1   47886988   47886988   12.773 0.0003738 ***
</span></span><span class=line><span class=ln>27</span><span class=cl>## PhD           1  220249039  220249039   58.748 5.476e-14 ***
</span></span><span class=line><span class=ln>28</span><span class=cl>## Terminal      1   66366007   66366007   17.702 2.892e-05 ***
</span></span><span class=line><span class=ln>29</span><span class=cl>## S.F.Ratio     1  190811028  190811028   50.896 2.274e-12 ***
</span></span><span class=line><span class=ln>30</span><span class=cl>## perc.alumni   1  225293653  225293653   60.094 2.904e-14 ***
</span></span><span class=line><span class=ln>31</span><span class=cl>## Expend        1  258162295  258162295   68.861 4.805e-16 ***
</span></span><span class=line><span class=ln>32</span><span class=cl>## Grad.Rate     1   57947219   57947219   15.457 9.214e-05 ***
</span></span><span class=line><span class=ln>33</span><span class=cl>## Residuals   760 2849276343    3749048
</span></span><span class=line><span class=ln>34</span><span class=cl>## ---
</span></span><span class=line><span class=ln>35</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>36</span><span class=cl>##
</span></span><span class=line><span class=ln>37</span><span class=cl>## Anova for Nonparametric Effects
</span></span><span class=line><span class=ln>38</span><span class=cl>##             Npar Df Npar F     Pr(F)
</span></span><span class=line><span class=ln>39</span><span class=cl>## (Intercept)
</span></span><span class=line><span class=ln>40</span><span class=cl>## Private
</span></span><span class=line><span class=ln>41</span><span class=cl>## s(Apps, 3)        2  8.571 0.0002085 ***
</span></span><span class=line><span class=ln>42</span><span class=cl>## Accept
</span></span><span class=line><span class=ln>43</span><span class=cl>## Enroll
</span></span><span class=line><span class=ln>44</span><span class=cl>## Top10perc
</span></span><span class=line><span class=ln>45</span><span class=cl>## F.Undergrad
</span></span><span class=line><span class=ln>46</span><span class=cl>## Room.Board
</span></span><span class=line><span class=ln>47</span><span class=cl>## Personal
</span></span><span class=line><span class=ln>48</span><span class=cl>## PhD
</span></span><span class=line><span class=ln>49</span><span class=cl>## Terminal
</span></span><span class=line><span class=ln>50</span><span class=cl>## S.F.Ratio
</span></span><span class=line><span class=ln>51</span><span class=cl>## perc.alumni
</span></span><span class=line><span class=ln>52</span><span class=cl>## Expend
</span></span><span class=line><span class=ln>53</span><span class=cl>## Grad.Rate
</span></span><span class=line><span class=ln>54</span><span class=cl>## ---
</span></span><span class=line><span class=ln>55</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=ln>1</span><span class=cl><span class=nf>summary</span><span class=p>(</span><span class=n>fit2</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=n>print</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>##
</span></span><span class=line><span class=ln> 2</span><span class=cl>## Call: gam(formula = Outstate ~ Private + s(Room.Board, 2) + s(PhD,
</span></span><span class=line><span class=ln> 3</span><span class=cl>##     3) + s(perc.alumni) + Expend, data = colDat)
</span></span><span class=line><span class=ln> 4</span><span class=cl>## Deviance Residuals:
</span></span><span class=line><span class=ln> 5</span><span class=cl>##       Min        1Q    Median        3Q       Max
</span></span><span class=line><span class=ln> 6</span><span class=cl>## -8676.030 -1345.678    -8.409  1265.524  9590.459
</span></span><span class=line><span class=ln> 7</span><span class=cl>##
</span></span><span class=line><span class=ln> 8</span><span class=cl>## (Dispersion Parameter for gaussian family taken to be 4175193)
</span></span><span class=line><span class=ln> 9</span><span class=cl>##
</span></span><span class=line><span class=ln>10</span><span class=cl>##     Null Deviance: 12559297426 on 776 degrees of freedom
</span></span><span class=line><span class=ln>11</span><span class=cl>## Residual Deviance: 3194023899 on 765.0002 degrees of freedom
</span></span><span class=line><span class=ln>12</span><span class=cl>## AIC: 14064.05
</span></span><span class=line><span class=ln>13</span><span class=cl>##
</span></span><span class=line><span class=ln>14</span><span class=cl>## Number of Local Scoring Iterations: 2
</span></span><span class=line><span class=ln>15</span><span class=cl>##
</span></span><span class=line><span class=ln>16</span><span class=cl>## Anova for Parametric Effects
</span></span><span class=line><span class=ln>17</span><span class=cl>##                   Df     Sum Sq    Mean Sq F value    Pr(&gt;F)
</span></span><span class=line><span class=ln>18</span><span class=cl>## Private            1 3751107814 3751107814  898.43 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>19</span><span class=cl>## s(Room.Board, 2)   1 2913770756 2913770756  697.88 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>20</span><span class=cl>## s(PhD, 3)          1 1149711330 1149711330  275.37 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>21</span><span class=cl>## s(perc.alumni)     1  556759894  556759894  133.35 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>22</span><span class=cl>## Expend             1  554812125  554812125  132.88 &lt; 2.2e-16 ***
</span></span><span class=line><span class=ln>23</span><span class=cl>## Residuals        765 3194023899    4175193
</span></span><span class=line><span class=ln>24</span><span class=cl>## ---
</span></span><span class=line><span class=ln>25</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span><span class=line><span class=ln>26</span><span class=cl>##
</span></span><span class=line><span class=ln>27</span><span class=cl>## Anova for Nonparametric Effects
</span></span><span class=line><span class=ln>28</span><span class=cl>##                  Npar Df Npar F     Pr(F)
</span></span><span class=line><span class=ln>29</span><span class=cl>## (Intercept)
</span></span><span class=line><span class=ln>30</span><span class=cl>## Private
</span></span><span class=line><span class=ln>31</span><span class=cl>## s(Room.Board, 2)       1 4.9853 0.0258517 *
</span></span><span class=line><span class=ln>32</span><span class=cl>## s(PhD, 3)              2 9.1614 0.0001171 ***
</span></span><span class=line><span class=ln>33</span><span class=cl>## s(perc.alumni)         3 0.8726 0.4548496
</span></span><span class=line><span class=ln>34</span><span class=cl>## Expend
</span></span><span class=line><span class=ln>35</span><span class=cl>## ---
</span></span><span class=line><span class=ln>36</span><span class=cl>## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</span></span></code></pre></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>James, G., Witten, D., Hastie, T., & Tibshirani, R. (2013). An
Introduction to Statistical Learning: with Applications in R.
Berlin, Germany: Springer Science & Business Media.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/solutions>solutions</a></span><span class=tag><a href=/tags/r>R</a></span><span class=tag><a href=/tags/islr>ISLR</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>5913 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Posted: <time class=dt-published>2020-02-19 09:47 +0000</time></p><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch7%2f" target=_blank rel=noopener aria-label=Facebook><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15.84 9.5H13.5V8.48c0-.53.35-.65.6-.65h1.4v-2.3h-2.35c-2.3.0-2.65 1.7-2.65 2.8V9.5h-2v2h2v7h3v-7h2.1l.24-2z"/></svg></div>Facebook</div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=%22%20%20%22ISLR%20%3a%3a%20Moving%20Beyond%20Linearity%22%0a%20%20%22%20seems%20like%20an%20interesting%20read%20from%20%40rg0swami&amp;url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch7%2f" target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3.0 1 .4 1.7 1.2 2.2-.5.0-1 0-1.2-.3.0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8.0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="12" cy="12" r="11.5"/></svg></div>Twitter</div></a><a class=resp-sharing-button__link href="mailto:?subject=%22%20%20%22ISLR%20%3a%3a%20Moving%20Beyond%20Linearity%22%0a%20%20%22%20seems%20interesting...&amp;body=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch7%2f" target=_self rel=noopener aria-label=E-Mail><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 16c0 .8-.7 1.5-1.5 1.5H6c-.8.0-1.5-.7-1.5-1.5V8c0-.8.7-1.5 1.5-1.5h12c.8.0 1.5.7 1.5 1.5v8zm-2-7.5L12 13 6.5 8.5m11 6-4-2.5m-7 2.5 4-2.5"/><circle cx="12" cy="12" r="11.5"/></svg></div>E-Mail</div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch7%2f&amp;title=%22%20%20%22ISLR%20%3a%3a%20Moving%20Beyond%20Linearity%22%0a%20%20%22%20seems%20interesting...&amp;summary=%22%20%20%22ISLR%20%3a%3a%20Moving%20Beyond%20Linearity%22%0a%20%20%22%20seems%20interesting...&amp;source=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch7%2f" target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><path d="M15 12.5c-.28.0-.5.22-.5.5v3.5h-3s.03-6.48.0-7h3v.83s.46-.75 1.7-.75c1.56.0 2.3 1.12 2.3 3.3v3.62h-3V13c0-.28-.23-.5-.5-.5zm-7.5-3h2v7h-2z"/><circle cx="8.5" cy="6.5" r="1"/></svg></div>LinkedIn</div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2frgoswami.me%2fposts%2fislr-ch7%2f&amp;resubmit=true&amp;title=%22%20%20%22ISLR%20%3a%3a%20Moving%20Beyond%20Linearity%22%0a%20%20%22%20seems%20interesting..." target=_blank rel=noopener aria-label=Reddit><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="11.5"/><ellipse cx="12" cy="14.37" rx="6.2" ry="4.24"/><path d="M14.3 16.25c-.62.36-1.42.57-2.3.57s-1.7-.2-2.32-.58"/><circle cx="14.61" cy="13.39" r=".98"/><circle cx="9.39" cy="13.39" r=".98"/><path d="M16.4 11.38c.26-.55.82-.92 1.47-.92.9.0 1.63.73 1.63 1.63.0.8-.6 1.47-1.38 1.6"/><circle cx="17.22" cy="7.52" r="1.63"/><path d="M7.6 11.38c-.26-.54-.82-.92-1.47-.92-.9.0-1.63.73-1.63 1.63.0.8.6 1.47 1.38 1.6M12 10.12s-.08-4.82 3.6-2.6"/></svg></div>Reddit</div></a><a class=resp-sharing-button__link href="whatsapp://send?text=%22%20%20%22ISLR%20%3a%3a%20Moving%20Beyond%20Linearity%22%0a%20%20%22%20seems%20interesting...%20https%3a%2f%2frgoswami.me%2fposts%2fislr-ch7%2f" target=_blank rel=noopener aria-label=WhatsApp><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle xmlns="http://www.w3.org/2000/svg" cx="12" cy="12" r="11.5"/><path stroke-width="1" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3.0-7.8 3.5-7.8 7.8.0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4.9 3.7.9 4.3.0 7.8-3.5 7.8-7.8.1-2-.7-3.9-2.2-5.4zm-5.5 11.9c-1.2.0-2.3-.3-3.3-.9l-.2-.1-2.4.6.7-2.4-.2-.2c-.6-1-1-2.2-1-3.4.0-3.6 2.9-6.5 6.5-6.5 1.7.0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.4-6.6 6.4zm3.5-4.8c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1s-.5.6-.6.8c-.1.1-.2.1-.4.0s-.8-.3-1.6-1c-.6-.5-1-1.2-1.1-1.3-.1-.2.0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.0-.2.0-.3s-.4-1.1-.6-1.4c-.2-.4-.3-.3-.4-.3h-.4s-.3.0-.5.2-.7.7-.7 1.6c0 1 .7 1.9.8 2s1.4 2.1 3.3 2.9c.5.2.8.3 1.1.4.5.1.9.1 1.2.1.4-.1 1.1-.5 1.3-.9.2-.5.2-.8.1-.9.0-.2-.2-.3-.4-.4z"/></svg></div>WhatsApp</div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://rgoswami.me/posts/bojack-horseman/><span class=button__icon>â†</span>
<span class=button__text>Bojack Horseman</span></a></span>
<span class="button next"><a href=https://rgoswami.me/posts/islr-ch6/><span class=button__text>"ISLR :: Linear Model Selection and Regularization"</span>
<span class=button__icon>â†’</span></a></span></div></div><div id=comments class=thin><div class=pagination__title><span class=pagination__title-h>Comments</span><hr></div><script src=https://utteranc.es/client.js repo=haozeke/haozeke.github.io issue-term=pathname theme=photon-dark label="Utterance ðŸ’¬" crossorigin=anonymous async></script></div></main><footer class=footer><p>&copy; 2023
<span><a href=https://rgoswami.me/>Rohit Goswami (HaoZeke)</a></span>
<a href=/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a><br><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br><script src=https://liberapay.com/rohit/widgets/button.js></script><noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript></p></footer></div><script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script>
<script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-109503488-16","auto"),ga("send","pageview")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","3z2xvwqu4u")</script><script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script><script async src=https://static.getclicky.com/js></script>
<script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script>
<script src=/js/codefold.min.f0790269b87613b3bcff64022840fe1991eee3ea384e874c78a24022c9936bd888a3c14a05a10955881eebb1558e4fcf37576dac120cd0bf4ebaf7aca27b35b1.js></script>
<script src=/js/copyClipboard.min.1c92539aea398296101add0e80508ad94cb59fb37f946f06ec9ca1c7558a961b8de0c5595a921aed70aa91eb94d24db35e5a01243bc625f8b1814b17928f478b.js></script></body></html>