<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[Rohit Goswami]"><meta name=description content="nix aside1, I recently shifted to using asdf to manage different language versions.
1git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.8.1 The main reason to prefer asdf over competing language specific options like rvm or pyenv or nvm and company is simply uniformity of the interface. This can be coupled with zinit snippet OMZ::plugins/asdf for loading the completions. Note that the installation steps can take a while especially if openssl is being installed."><meta name=keywords content="personal,shell,lang"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rgoswami.me/snippets/prog-lang-man/><meta name=generator content="Wooframework"><title>Programming Language Management :: Rohit Goswami â€” Reflections</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.054e30538b054b321af6575a7659f551cec63e1cef6bbd674acccadf856d3aff.css><meta itemprop=name content="Programming Language Management"><meta itemprop=description content="nix aside1, I recently shifted to using asdf to manage different language versions.
1git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.8.1 The main reason to prefer asdf over competing language specific options like rvm or pyenv or nvm and company is simply uniformity of the interface. This can be coupled with zinit snippet OMZ::plugins/asdf for loading the completions. Note that the installation steps can take a while especially if openssl is being installed."><meta itemprop=datePublished content="2021-09-19T17:39:00+00:00"><meta itemprop=dateModified content="2021-09-19T17:39:00+00:00"><meta itemprop=wordCount content="428"><meta itemprop=image content="https://rgoswami.me/images/RG.png"><meta itemprop=keywords content="shell,lang,"><meta property="og:title" content="Programming Language Management"><meta property="og:description" content="nix aside1, I recently shifted to using asdf to manage different language versions.
1git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.8.1 The main reason to prefer asdf over competing language specific options like rvm or pyenv or nvm and company is simply uniformity of the interface. This can be coupled with zinit snippet OMZ::plugins/asdf for loading the completions. Note that the installation steps can take a while especially if openssl is being installed."><meta property="og:type" content="article"><meta property="og:url" content="https://rgoswami.me/snippets/prog-lang-man/"><meta property="og:image" content="https://rgoswami.me/images/RG.png"><meta property="article:section" content="snippets"><meta property="article:published_time" content="2021-09-19T17:39:00+00:00"><meta property="article:modified_time" content="2021-09-19T17:39:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rgoswami.me/images/RG.png"><meta name=twitter:title content="Programming Language Management"><meta name=twitter:description content="nix aside1, I recently shifted to using asdf to manage different language versions.
1git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.8.1 The main reason to prefer asdf over competing language specific options like rvm or pyenv or nvm and company is simply uniformity of the interface. This can be coupled with zinit snippet OMZ::plugins/asdf for loading the completions. Note that the installation steps can take a while especially if openssl is being installed."><meta property="article:section" content="code"><meta property="article:published_time" content="2021-09-19 17:39:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><div class=header__inner><div class=header__left><div class=logo><a href=/ style=text-decoration:none><img src=/images/home.png alt></a></div></div><div class=header__mid><button class=button><div class=button__text><a href=https://rgoswami.me//search>Search</a></div></button></div><div class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>Blog</a></li><li><a href=/series>Series</a></li></ul><ul class=menu__inner><li><a href=/categories>Categories</a></li><li><a href=/snippets>Snippets</a></li><li><a href=/tags>Tags</a></li></ul></nav><button id=toggleMenu><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></div></button>
<button class=theme-toggle id=toggleTheme><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></button></div></div></header><script src=/js/mathjax-config.js></script>
<script id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-chtml.js></script><main class=post><div class=post-info></p></div><article><h1 class=post-title><a href=https://rgoswami.me/snippets/prog-lang-man/>Programming Language Management</a></h1><div class=post-content><p><code>nix</code> aside<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>, I recently shifted to using <a href=https://asdf-vm.com/guide/getting-started.html#_3-install-asdf>asdf</a> to manage different language versions.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.8.1
</span></span></code></pre></div><p>The main reason to prefer <code>asdf</code> over competing language specific options like <code>rvm</code> or <code>pyenv</code> or <code>nvm</code> and company is simply uniformity of the interface. This can be coupled with <code>zinit snippet OMZ::plugins/asdf</code> for loading the completions. Note that the installation steps can take a while especially if <code>openssl</code> is being installed.</p><h2 id=configuration>Configuration</h2><p>Actually one weird aspect of <code>asdf</code> is that it pollutes <code>$HOME</code> by default
instead of respectfully storing its configuration in <code>$HOME/.config/asdf</code> like
every other program. To change this; exporting <code>ASDF_CONFIG_FILE</code> works.
Essentially a <code>zsh</code> configuration with <code>zinit</code> would look like this<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=k>if</span> <span class=o>[[</span> ! -d ~/.asdf <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    mkdir ~/.asdf
</span></span><span class=line><span class=ln>3</span><span class=cl>    git clone https://github.com/asdf-vm/asdf.git ~/.asdf
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nb>export</span> <span class=nv>ASDF_CONFIG_FILE</span><span class=o>=</span><span class=s2>&#34;~/.config/asdf/asdfrc&#34;</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>zinit snippet OMZ::plugins/asdf
</span></span></code></pre></div><p><code>asdf</code> has an option; <code>legacy_version_file = yes</code> which is meant to ensure that
existing solutions (e.g. <code>.nvmrc</code> or <code>.node-version</code>) are compatible. There is
also <code>$HOME/.tool-versions</code> for trickle-down language versions; that is
language-version pairs defined in such files are activated for the directory and
lower sub-directories. The rest of a reasonable configuration (<a href=https://asdf-vm.com/manage/configuration.html>described here</a>)
might look like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=nv>legacy_version_file</span> <span class=o>=</span> yes
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nv>always_keep_download</span> <span class=o>=</span> no
</span></span></code></pre></div><h2 id=ruby>Ruby</h2><p>This <a href=https://github.com/asdf-vm/asdf-ruby>plugin</a> leverages <a href=https://github.com/rbenv/ruby-build#custom-build-configuration>ruby-build</a> and so can take a pick up an extended set of
environment variables; it supports <code>.ruby-version</code> files as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>asdf plugin add ruby
</span></span><span class=line><span class=ln>2</span><span class=cl>asdf list all ruby
</span></span><span class=line><span class=ln>3</span><span class=cl>asdf install ruby 3.0.2
</span></span><span class=line><span class=ln>4</span><span class=cl>asdf global ruby 3.0.2 <span class=c1># Convenience</span>
</span></span></code></pre></div><h2 id=nodejs>NodeJS</h2><p>This <a href=https://github.com/asdf-vm/asdf-nodejs>plugin</a> respects <code>.nvmrc</code> and <code>.node-version</code> files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>asdf plugin add nodejs
</span></span><span class=line><span class=ln>2</span><span class=cl>asdf global nodejs latest
</span></span><span class=line><span class=ln>3</span><span class=cl>asdf install nodejs latest
</span></span></code></pre></div><h2 id=python>Python</h2><p>Builds with <a href=https://github.com/yyuu/pyenv/tree/master/plugins/python-build>python-build</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>asdf plugin add python
</span></span><span class=line><span class=ln>2</span><span class=cl>asdf install python 3.9.7
</span></span><span class=line><span class=ln>3</span><span class=cl>asdf global python 3.9.7
</span></span></code></pre></div><h2 id=direnv>Direnv</h2><p>I&rsquo;m a huge fan of <code>direnv</code>; and a <a href=https://github.com/asdf-community/asdf-direnv>fantastic little plugin</a> (with neat <code>hyperfine</code> benchmarks) for <code>asdf</code> removes a layer of shim indirection while playing nicely with <code>direnv</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>asdf plugin-add direnv
</span></span><span class=line><span class=ln>2</span><span class=cl>asdf install direnv latest
</span></span><span class=line><span class=ln>3</span><span class=cl>asdf global direnv latest
</span></span></code></pre></div><p>This comes with an associated set of shell profile instructions:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=c1># File: ~/.zshrc</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=c1># Hook direnv into your shell.</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nb>eval</span> <span class=s2>&#34;</span><span class=k>$(</span>asdf <span class=nb>exec</span> direnv hook zsh<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1># A shortcut for asdf managed direnv.</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>direnv<span class=o>()</span> <span class=o>{</span> asdf <span class=nb>exec</span> direnv <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span><span class=p>;</span> <span class=o>}</span>
</span></span></code></pre></div><p>Along with a commiserate <code>$HOME/.config/direnv/direnvrc</code> requirement:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=nb>source</span> <span class=s2>&#34;</span><span class=k>$(</span>asdf direnv hook asdf<span class=k>)</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>Now every new <code>.envrc</code> can start with <code>use asdf</code> which will now speed up evaluations.</p><h2 id=conclusions>Conclusions</h2><p>This method appears to be more robust than remembering the various idiosyncrasies and logic of a host of other tools.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>This was during the <a href=https://github.com/Ericson2314/nix-rfcs/blob/plan-dynamism/rfcs/0000-plan-dynanism.md>build plan dynamism RFCs</a> which themselves were symptomatic of the <code>{yarn,composer,node,*}2nix</code> issues&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>This structure can be seen in <a href=https://github.com/HaoZeke/Dotfiles>my own Dotfiles</a> as well&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/shell>shell</a></span><span class=tag><a href=/tags/lang>lang</a></span></p></div><div id=comments class=thin><div class=pagination__title><span class=pagination__title-h>Comments</span><hr></div><script src=https://utteranc.es/client.js repo=haozeke/haozeke.github.io issue-term=pathname theme=photon-dark label="Utterance ðŸ’¬" crossorigin=anonymous async></script></div></main><footer class=footer><p>&copy; 2023
<span><a href=https://rgoswami.me/>Rohit Goswami (HaoZeke)</a></span>
<a href=/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a><br><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.
Powered by <a href=http://gohugo.io><u>Hugo</u></a> and <a href=https://github.com/HaoZeke/hugo-theme-hello-friend-ng-hz><u>this theme</u></a>.</br>Hosted with <u><a href=https://www.netlify.com/>Netlify</a></u>.</br><script src=https://liberapay.com/rohit/widgets/button.js></script><noscript><a href=https://liberapay.com/rohit/donate><img alt="Donate using Liberapay" src=https://liberapay.com/assets/widgets/donate.svg></a></noscript></p></footer></div><script src=/bundle.min.5fae9992ea406007408dc33b0b3a8376d61e2f1d6ac50ba1dad7580ac50afb5199bcef3bbc3677e77553a9980bf882cf71edc2f755687dd7725f12ece4304ac2.js></script>
<script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-109503488-16","auto"),ga("send","pageview")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","3z2xvwqu4u")</script><script data-goatcounter=https://rgoswami.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push("101265002")</script><script async src=https://static.getclicky.com/js></script>
<script src=https://cdn.jsdelivr.net/npm/readmore-js@3.0.0-beta-1/dist/readmore.min.js></script>
<script src=/js/codefold.min.f0790269b87613b3bcff64022840fe1991eee3ea384e874c78a24022c9936bd888a3c14a05a10955881eebb1558e4fcf37576dac120cd0bf4ebaf7aca27b35b1.js></script>
<script src=/js/copyClipboard.min.1c92539aea398296101add0e80508ad94cb59fb37f946f06ec9ca1c7558a961b8de0c5595a921aed70aa91eb94d24db35e5a01243bc625f8b1814b17928f478b.js></script></body></html>